[{"name": "dirserv_should_launch_reachability_test", "calls": ["get_options", "authdir_mode_handles_descs", "routers_have_same_or_addrs"]}, {"name": "rend_service_descriptor_free", "calls": ["smartlist_free", "rend_intro_point_free", "crypto_pk_free"]}, {"name": "parse_method_error", "calls": ["log_fn_"]}, {"name": "router_dirport_found_reachable", "calls": ["get_options", "router_get_my_routerinfo", "tor_dup_ip", "reschedule_descriptor_update_check", "decide_to_advertise_dirport", "mark_my_descriptor_dirty", "control_event_server_status", "check_whether_orport_reachable", "log_fn_"]}, {"name": "string_is_valid_ipv6_address", "calls": ["tor_inet_pton"]}, {"name": "SSL_SESSION_get_master_key", "calls": ["tor_assertion_failed_"]}, {"name": "tor_strtok_r_impl", "calls": ["strtok_helper", "tor_assertion_failed_"]}, {"name": "aes_crypt", "calls": ["tor_assertion_failed_"]}, {"name": "pick_entry_guards", "calls": ["num_live_entry_guards", "add_an_entry_guard", "entry_guards_changed", "decide_num_guards", "tor_assertion_failed_"]}, {"name": "fascist_firewall_allows_node", "calls": ["fascist_firewall_allows_address_or", "tor_addr_from_ipv4n", "fascist_firewall_allows_or"]}, {"name": "connection_dirserv_add_networkstatus_bytes_to_outbuf", "calls": ["lookup_cached_dir_by_fp", "smartlist_free", "smartlist_pop_last", "tor_zlib_new", "connection_get_outbuf_len", "connection_dirserv_finish_spooling", "connection_dirserv_add_dir_bytes_to_outbuf"]}, {"name": "check_private_dir", "calls": ["clean_name_for_stat", "tor_strdup_", "tor_getpwuid", "tor_getpwnam", "sandbox_intern_string", "log_fn_", "tor_assertion_failed_"]}, {"name": "strmap_impl_HT_FIND", "calls": ["strmap_impl_HT_FIND_P_", "strmap_entry_hash"]}, {"name": "getinfo_helper_liveness", "calls": ["get_cached_network_liveness", "tor_strdup_"]}, {"name": "circuit_extend", "calls": ["get_options", "tor_digest_is_zero", "fmt_addrport", "channel_connect_for_circuit", "tor_addr_is_null", "TO_OR_CIRCUIT", "relay_header_unpack", "server_mode", "extend_info_new", "tor_addr_is_internal_", "extend_cell_parse", "circuit_mark_for_close_", "tor_memdup_", "circuit_deliver_create_cell", "log_fn_", "tor_assertion_failed_", "channel_get_for_extend", "tor_memeq", "circuit_set_state"]}, {"name": "find_str_at_start_of_line", "calls": []}, {"name": "connection_dirserv_finish_spooling", "calls": ["connection_write_to_buf_zlib", "tor_zlib_free"]}, {"name": "control_event_networkstatus_changed_single", "calls": ["control_event_networkstatus_changed", "smartlist_add", "smartlist_free", "smartlist_new"]}, {"name": "note_request", "calls": []}, {"name": "reset_all_main_loop_timers", "calls": ["periodic_event_reschedule"]}, {"name": "policy_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "evaluate_ctr_for_aes", "calls": []}, {"name": "cell_ewma_enabled", "calls": []}, {"name": "dirserv_count_measured_bws", "calls": ["dirserv_has_measured_bw", "tor_assertion_failed_"]}, {"name": "channel_tls_get_transport_name_method", "calls": ["channel_tls_from_base", "tor_strdup_", "tor_assertion_failed_"]}, {"name": "control_event_tb_empty", "calls": ["get_options", "send_control_event"]}, {"name": "scale_array_elements_to_u64", "calls": ["tor_llround"]}, {"name": "onion_skin_TAP_client_handshake", "calls": ["get_options", "tor_assertion_failed_", "crypto_dh_compute_secret", "memwipe", "tor_malloc_", "crypto_dh_get_bytes", "tor_memeq"]}, {"name": "chan_circid_map_HT_CLEAR", "calls": ["chan_circid_map_HT_INIT", "tor_free_"]}, {"name": "addressmap_ent_remove", "calls": ["addressmap_ent_free", "addressmap_virtaddress_remove"]}, {"name": "circuit_set_rend_token", "calls": ["get_options", "hex_str", "tor_assertion_failed_", "digestmap_new", "tor_malloc_", "circuit_clear_rend_token", "digestmap_get", "digestmap_set", "circuit_mark_for_close_", "log_fn_"]}, {"name": "circuit_build_times_network_close", "calls": ["format_local_iso_time", "control_event_network_liveness_update", "log_fn_"]}, {"name": "entry_guard_register_connect_status", "calls": ["log_entry_guards", "num_live_entry_guards", "smartlist_del_keeporder", "base16_encode", "control_event_guard", "tor_assertion_failed_", "entry_guards_changed", "entry_is_live", "format_iso_time", "router_set_status", "log_fn_", "tor_memeq", "entry_guard_free"]}, {"name": "networkstatus_get_reasonably_live_consensus", "calls": ["networkstatus_get_latest_consensus_by_flavor"]}, {"name": "write_bytes_to_file_impl", "calls": ["write_chunks_to_file_impl", "smartlist_add", "smartlist_free", "smartlist_new"]}, {"name": "connection_ap_mark_as_non_pending_circuit", "calls": ["smartlist_remove"]}, {"name": "clientmap_HT_INSERT", "calls": ["clientmap_entry_hash", "clientmap_HT_GROW"]}, {"name": "clean_backtrace", "calls": []}, {"name": "or_handshake_state_record_cell", "calls": ["get_cell_network_size", "memwipe", "crypto_digest256_new", "cell_pack", "crypto_digest_add_bytes", "log_fn_"]}, {"name": "tor_tls_get_my_client_auth_key", "calls": []}, {"name": "pathbias_count_use_failed", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "circuit_state_to_string", "entry_guards_changed", "circuit_purpose_to_string", "log_fn_"]}, {"name": "ext_orport_free_all", "calls": []}, {"name": "send_control_done", "calls": ["connection_write_str_to_buf"]}, {"name": "ewma_pick_active_circuit", "calls": ["tor_assertion_failed_", "cell_ewma_to_circuit", "TO_EWMA_POL_DATA"]}, {"name": "dnsserv_reject_request", "calls": []}, {"name": "routerstatus_get_description", "calls": ["format_node_description"]}, {"name": "cached_getaddrinfo_items_eq", "calls": []}, {"name": "base32_decode", "calls": ["tor_malloc_zero_", "tor_assertion_failed_", "log_fn_"]}, {"name": "rimap_get", "calls": ["digestmap_get"]}, {"name": "_cmp_double", "calls": []}, {"name": "authdir_policy_permits_address", "calls": ["get_options", "addr_is_in_cc_list", "addr_policy_permits_address"]}, {"name": "TOR_ISALPHA", "calls": []}, {"name": "channel_clear_identity_digest", "calls": ["tor_digest_is_zero", "channel_is_in_state", "channel_remove_from_digest_map", "tor_assertion_failed_", "log_fn_"]}, {"name": "connection_edge_reached_eof", "calls": ["EDGE_TO_ENTRY_CONN", "connection_get_inbuf_len", "connection_state_is_open", "connection_mark_for_close_", "connection_edge_end", "log_fn_"]}, {"name": "connection_is_on_closeable_list", "calls": ["smartlist_contains"]}, {"name": "create_cell_format_relayed", "calls": ["create_cell_format_impl"]}, {"name": "connection_new", "calls": ["control_connection_new", "entry_connection_new", "dir_connection_new", "tor_malloc_zero_", "listener_connection_new", "edge_connection_new", "or_connection_new", "connection_init"]}, {"name": "get_interface_address6_list", "calls": ["smartlist_free", "tor_addr_is_multicast", "tor_addr_is_loopback", "smartlist_add", "tor_addr_is_internal_", "get_interface_addresses_raw", "get_interface_address6_via_udp_socket_hack", "smartlist_del", "smartlist_new", "tor_dup_addr"]}, {"name": "tor_addr_port_split", "calls": ["tor_addr_parse", "addr_port_lookup", "tor_assertion_failed_", "tor_strdup_"]}, {"name": "addressmap_ent_free", "calls": []}, {"name": "clear_circ_bw_fields", "calls": ["TO_ORIGIN_CIRCUIT", "circuit_get_global_list"]}, {"name": "channel_tls_num_cells_writeable_method", "calls": ["channel_tls_from_base", "get_cell_network_size", "connection_get_outbuf_len", "tor_assertion_failed_"]}, {"name": "note_that_we_completed_a_circuit", "calls": []}, {"name": "or_handshake_state_record_var_cell", "calls": ["crypto_digest_add_bytes", "crypto_digest256_new", "var_cell_pack_header", "memwipe"]}, {"name": "rend_client_rendcirc_has_opened", "calls": ["tor_assertion_failed_", "rend_client_send_establish_rendezvous", "log_fn_"]}, {"name": "channel_send_destroy", "calls": ["channel_is_in_state", "tor_assertion_failed_", "channel_state_to_string", "channel_note_destroy_pending", "circuitmux_append_destroy_cell", "log_fn_"]}, {"name": "connection_dir_about_to_close", "calls": ["rend_client_refetch_v2_renddesc", "connection_dir_request_failed"]}, {"name": "router_get_my_id_digest", "calls": []}, {"name": "connection_ap_process_transparent", "calls": ["connection_mark_unattached_ap_", "tor_assertion_failed_", "connection_ap_get_original_destination", "connection_ap_rewrite_and_attach_if_allowed", "control_event_stream_status", "log_fn_"]}, {"name": "check_extend_cell", "calls": ["tor_digest_is_zero", "check_create_cell", "tor_addr_family"]}, {"name": "download_status_reset", "calls": ["find_dl_schedule", "get_options"]}, {"name": "cell_ewma_get_tick", "calls": ["approx_time"]}, {"name": "install_sigsys_debugging", "calls": ["log_fn_"]}, {"name": "bitarray_free", "calls": []}, {"name": "rend_service_port_config_new", "calls": ["tor_malloc_zero_"]}, {"name": "connection_or_send_authenticate_cell", "calls": ["var_cell_free", "crypto_pk_keysize", "tor_assertion_failed_", "connection_or_compute_authenticate_cell_body", "tor_tls_get_my_client_auth_key", "set_uint16", "var_cell_new", "connection_or_write_var_cell_to_buf", "log_fn_"]}, {"name": "smartlist_swap", "calls": []}, {"name": "connection_or_remove_from_identity_map", "calls": ["tor_digest_is_zero", "tor_assertion_failed_", "digestmap_get", "digestmap_remove", "digestmap_set", "log_fn_"]}, {"name": "dirserv_remove_old_statuses", "calls": ["smartlist_del", "lookup_cached_dir_by_fp"]}, {"name": "crypto_early_init", "calls": ["curve25519_init", "crypto_seed_rng", "crypto_init_siphash_key", "crypto_force_rand_ssleay", "ed25519_init", "setup_openssl_threading", "log_fn_"]}, {"name": "command_process_destroy_cell", "calls": ["circuit_get_by_circid_channel", "circuit_set_n_circid_chan", "TO_OR_CIRCUIT", "circuit_set_p_circid_chan", "circuit_mark_for_close_", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "tor_weak_random", "calls": []}, {"name": "config_line_append", "calls": ["tor_malloc_zero_", "tor_strdup_"]}, {"name": "getinfo_helper_config", "calls": ["get_options", "smartlist_free", "esc_for_log", "smartlist_add_asprintf", "smartlist_join_strings", "smartlist_new"]}, {"name": "fetch_from_buf_socks_client", "calls": ["buf_pullup", "tor_assertion_failed_", "parse_socks_client", "buf_clear", "buf_remove_from_front"]}, {"name": "read_escaped_data", "calls": ["tor_malloc_"]}, {"name": "tor_addr_from_ipv6_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "get_managed_proxy_by_argv_and_type", "calls": ["managed_proxy_has_argv"]}, {"name": "control_event_descriptors_changed", "calls": ["smartlist_free", "router_get_verbose_nickname", "smartlist_add", "tor_malloc_", "send_control_event_string", "smartlist_join_strings", "tor_asprintf", "smartlist_new"]}, {"name": "strcasecmpend", "calls": []}, {"name": "directory_handle_command_get", "calls": ["connection_dirserv_flushed_some", "crypto_digest256", "dirvote_get_pending_detached_signatures", "geoip_note_client_seen", "tor_zlib_new", "directory_dump_request_log", "networkstatus_getinfo_by_purpose", "smartlist_free", "dirserv_have_any_serverdesc", "rend_valid_descriptor_id", "geoip_note_ns_response", "escaped", "get_my_v3_authority_cert", "rend_cache_lookup_v2_desc_as_dir", "connection_write_to_buf_zlib", "smartlist_del", "geoip_start_dirreq", "parse_http_time", "authority_cert_get_by_sk_digest", "dirserv_estimate_data_size", "global_write_bucket_low", "authority_cert_get_by_digests", "strlcpy", "note_request", "dirserv_estimate_microdesc_size", "dirserv_remove_old_statuses", "parse_http_url", "get_options", "safe_str", "authority_cert_get_all", "connection_write_to_buf", "dir_split_resource_into_fingerprint_pairs", "choose_compression_level", "dir_split_resource_into_fingerprints", "tor_addr_from_ipv4n", "get_dirportfrontpage", "http_get_header", "dirserv_have_any_microdesc", "strcmpstart", "dirvote_get_pending_consensus", "tor_inet_aton", "authority_cert_get_newest_by_id", "tor_strdup_", "smartlist_add", "tor_assertion_failed_", "networkstatus_parse_flavor_name", "dirserv_get_routerdesc_fingerprints", "tor_malloc_zero_", "client_likes_consensus", "tor_memeq", "networkstatus_get_latest_consensus_by_flavor", "dirvote_get_vote", "tor_timegm", "write_http_response_header_impl", "connection_dir_is_encrypted", "write_http_status_line", "tor_strndup_", "write_http_response_header", "smartlist_new", "log_fn_"]}, {"name": "router_dir_info_changed", "calls": ["rend_hsdir_routers_changed"]}, {"name": "rep_hist_get_uptime", "calls": ["get_or_history"]}, {"name": "find_cipher_by_id", "calls": ["tor_assertion_failed_", "set_uint16"]}, {"name": "list_pending_descriptor_downloads", "calls": ["list_pending_downloads"]}, {"name": "circuit_build_times_update_state", "calls": ["get_options", "circuit_build_times_create_histogram", "or_state_mark_dirty", "tor_strdup_", "tor_malloc_zero_", "config_free_lines", "get_or_state", "tor_asprintf"]}, {"name": "networkstatus_set_current_consensus", "calls": ["get_options", "dirserv_set_cached_consensus_networkstatus", "networkstatus_vote_free", "networkstatus_get_latest_consensus", "networkstatus_copy_old_consensus_info", "get_connection_array", "networkstatus_get_flavor_name", "connection_or_update_token_buckets", "format_time_interval", "networkstatus_parse_vote_from_string", "get_circuit_build_times_mutable", "authority_certs_fetch_missing", "nodelist_set_consensus", "download_status_reset", "we_use_microdescriptors_for_circuits", "control_event_general_status", "control_event_client_status", "tor_strdup_", "directory_caches_dir_info", "routerstatus_list_update_named_server_map", "cell_ewma_enabled", "options_get_datadir_fname2_suffix", "networkstatus_parse_flavor_name", "write_str_to_file", "notify_control_networkstatus_changed", "dir_server_mode", "tor_snprintf", "circuit_build_times_new_consensus_params", "router_dir_info_changed", "dirserv_get_consensus", "tor_memeq", "dirvote_recalculate_timing", "update_consensus_networkstatus_fetch_time", "networkstatus_check_consensus_signature", "format_iso_time", "download_status_increment_failure", "channel_set_cmux_policy_everywhere", "usable_consensus_flavor", "log_fn_", "cell_ewma_set_scale_factor"]}, {"name": "compare_vote_rs", "calls": ["tor_assertion_failed_"]}, {"name": "process_environment_free", "calls": []}, {"name": "rimap_free", "calls": []}, {"name": "get_ed_impl", "calls": ["pick_ed25519_impl"]}, {"name": "nodelist_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "CHUNK_WRITE_PTR", "calls": []}, {"name": "periodic_timer_free", "calls": ["tor_event_free"]}, {"name": "connection_dir_finished_connecting", "calls": ["tor_assertion_failed_", "connection_dir_close_consensus_conn_if_extra", "log_fn_"]}, {"name": "address_is_in_virtual_range", "calls": ["strcasecmpend", "tor_addr_parse", "tor_assertion_failed_", "tor_addr_family", "tor_addr_compare_masked"]}, {"name": "getinfo_helper_accounting", "calls": ["get_accounting_bytes", "get_options", "tor_strdup_", "format_iso_time", "tor_malloc_", "accounting_is_enabled", "tor_asprintf"]}, {"name": "circuitmux_clear_num_cells", "calls": []}, {"name": "rep_hist_note_exit_stream_opened", "calls": ["log_fn_"]}, {"name": "connection_or_connect_failed", "calls": ["get_options", "authdir_mode_tests_reachability", "control_event_or_conn_status", "control_event_bootstrap_problem"]}, {"name": "tor_lookup_hostname", "calls": ["tor_addr_to_ipv4h", "tor_addr_lookup", "tor_addr_family"]}, {"name": "circuit_establish_circuit", "calls": ["onion_populate_cpath", "onion_pick_cpath_exit", "circuit_handle_first_hop", "origin_circuit_init", "circuit_mark_for_close_", "control_event_circuit_status"]}, {"name": "channel_get_for_extend", "calls": ["channel_is_bad_for_new_circs", "channel_is_better", "channel_is_in_state", "tor_assertion_failed_", "channel_find_by_remote_digest", "approx_time", "channel_next_with_digest", "tor_memeq", "channel_is_client"]}, {"name": "compare_vote_routerstatus_entries", "calls": []}, {"name": "get_accounting_bytes", "calls": ["get_options"]}, {"name": "rep_hist_format_conn_stats", "calls": ["tor_assertion_failed_", "tor_asprintf", "format_iso_time"]}, {"name": "cpu_init", "calls": ["get_options", "replyqueue_get_socket", "crypto_seed_weak_rng", "replyqueue_new", "threadpool_new", "get_num_cpus", "tor_libevent_get_base"]}, {"name": "find_start_of_next_router_or_extrainfo", "calls": ["strcmpstart", "tor_assertion_failed_", "eat_whitespace_eos"]}, {"name": "rend_service_parse_intro_for_v2", "calls": ["crypto_pk_asn1_decode", "get_uint32", "crypto_pk_keysize", "base16_encode", "get_uint16", "extend_info_free", "tor_malloc_zero_", "tor_addr_from_ipv4n", "tor_asprintf"]}, {"name": "rep_hist_get_bandwidth_lines", "calls": ["tor_snprintf", "tor_assertion_failed_", "format_iso_time", "tor_malloc_zero_", "rep_hist_fill_bandwidth_history", "strlcat"]}, {"name": "buf_get_default_chunk_size", "calls": []}, {"name": "set_server_identity_key", "calls": ["crypto_pk_free", "crypto_pk_get_digest"]}, {"name": "dirserv_set_cached_consensus_networkstatus", "calls": ["strmap_new", "strmap_set", "cached_dir_decref", "new_cached_dir", "tor_strdup_"]}, {"name": "policy_dump_to_string", "calls": ["policy_write_item", "smartlist_free", "smartlist_add", "tor_addr_family", "tor_malloc_", "smartlist_join_strings", "smartlist_new", "log_fn_"]}, {"name": "log_prefix_", "calls": ["tor_gettimeofday", "tor_localtime_r", "tor_snprintf", "sev_to_string"]}, {"name": "get_my_v3_legacy_cert", "calls": []}, {"name": "onion_skin_TAP_create", "calls": ["crypto_pk_keysize", "tor_assertion_failed_", "note_crypto_pk_op", "memwipe", "crypto_dh_get_bytes", "crypto_dh_free", "crypto_pk_public_hybrid_encrypt", "crypto_dh_get_public", "crypto_dh_new"]}, {"name": "digestmap_impl_HT_REP_IS_BAD_", "calls": ["digestmap_entry_hash"]}, {"name": "rep_hist_record_mtbf_data", "calls": ["get_options", "rep_hist_note_router_unreachable", "finish_writing_to_file", "base16_encode", "digestmap_iter_next", "digestmap_iter_get", "start_writing_to_stdio_file", "abort_writing_to_file", "digestmap_iter_done", "format_iso_time", "router_get_by_id_digest", "options_get_datadir_fname2_suffix", "digestmap_iter_init", "log_fn_"]}, {"name": "connection_ap_rewrite_and_attach_if_allowed", "calls": ["get_options", "connection_ap_handshake_rewrite_and_attach", "connection_ap_mark_as_non_pending_circuit", "log_fn_"]}, {"name": "find_whitespace_eos", "calls": []}, {"name": "ifaddrs_to_smartlist", "calls": ["tor_memdup_", "smartlist_add", "smartlist_new", "tor_addr_from_sockaddr"]}, {"name": "rend_service_authorization_strmap_item_free", "calls": ["rend_service_authorization_free"]}, {"name": "router_reload_consensus_networkstatus", "calls": ["get_options", "update_microdescs_from_networkstatus", "we_use_microdescriptors_for_circuits", "networkstatus_get_flavor_name", "tor_snprintf", "read_file_to_str", "strmap_new", "networkstatus_set_current_consensus", "routers_update_all_from_networkstatus", "options_get_datadir_fname2_suffix", "update_certificate_downloads", "log_fn_"]}, {"name": "buffer_stats_compare_entries_", "calls": []}, {"name": "digestmap_get", "calls": ["digestmap_assign_tmp_key", "digestmap_impl_HT_FIND", "tor_assertion_failed_"]}, {"name": "recv_ni", "calls": []}, {"name": "should_delay_dir_fetches", "calls": ["pt_proxies_configuration_pending", "any_bridge_descriptors_known", "log_fn_"]}, {"name": "rend_service_update_descriptor", "calls": ["rend_service_descriptor_free", "extend_info_dup", "smartlist_add", "find_intro_circuit", "tor_malloc_zero_", "crypto_pk_dup_key", "smartlist_new"]}, {"name": "connection_bucket_read_limit", "calls": ["TO_OR_CONN", "connection_is_rate_limited", "connection_bucket_round_robin", "connection_counts_as_relayed_traffic", "get_cell_network_size"]}, {"name": "crypto_digest_assign", "calls": ["crypto_digest_alloc_bytes", "tor_assertion_failed_"]}, {"name": "channel_listener_timestamp_active", "calls": ["tor_assertion_failed_"]}, {"name": "init_v3_authority_keys", "calls": ["get_options", "load_authority_keyset"]}, {"name": "hibernate_end", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "dirvote_act", "calls": ["dirvote_recalculate_timing", "get_my_v3_authority_cert", "hex_str", "dirvote_clear_votes", "dirvote_publish_consensus", "dirvote_compute_consensuses", "dirvote_fetch_missing_signatures", "authdir_mode_v3", "list_v3_auth_ids", "dirvote_fetch_missing_votes", "dirvote_perform_vote", "log_fn_"]}, {"name": "aes_new_cipher", "calls": []}, {"name": "dump_desc", "calls": ["get_options", "tor_snprintf", "tor_assertion_failed_", "write_str_to_file", "tor_malloc_zero_", "options_get_datadir_fname2_suffix", "log_fn_"]}, {"name": "dirreq_map_put_", "calls": ["tor_assertion_failed_", "dirreqmap_HT_REPLACE", "log_fn_"]}, {"name": "rend_encode_v2_intro_points", "calls": ["tor_dup_addr", "base32_encode", "tor_snprintf", "tor_malloc_zero_", "crypto_pk_write_public_key_to_string", "log_fn_"]}, {"name": "replaycache_new", "calls": ["tor_malloc_", "digest256map_new", "log_fn_"]}, {"name": "get_uint64", "calls": []}, {"name": "node_get_purpose", "calls": []}, {"name": "dirserver_choose_by_weight", "calls": ["scale_array_elements_to_u64", "tor_calloc_", "choose_array_element_by_weight"]}, {"name": "microdesc_eq_", "calls": ["tor_memeq"]}, {"name": "strcmpend", "calls": []}, {"name": "fp_pair_map_iter_get", "calls": ["tor_assertion_failed_"]}, {"name": "nodelist_find_nodes_with_microdesc", "calls": ["smartlist_add", "smartlist_new"]}, {"name": "connected_cell_format_payload", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_to_ipv4n", "set_uint32", "set_uint8", "dns_clip_ttl", "tor_addr_to_in6"]}, {"name": "strcasecmpstart", "calls": []}, {"name": "channel_close_for_error", "calls": ["channel_is_in_state", "channel_change_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "rep_hist_note_extend_failed", "calls": ["get_link_history"]}, {"name": "cpuworker_onion_handshake_threadfn", "calls": ["tor_assertion_failed_", "tor_gettimeofday", "memwipe", "onion_skin_server_handshake", "log_fn_"]}, {"name": "logs_free_all", "calls": ["smartlist_free", "tor_mutex_acquire", "log_free", "tor_mutex_release", "close_log", "pending_log_message_free"]}, {"name": "trusted_dirs_reload_certs", "calls": ["get_options", "trusted_dirs_load_certs_from_string", "options_get_datadir_fname2_suffix", "read_file_to_str"]}, {"name": "connection_ap_detach_retriable", "calls": ["get_options", "circuit_detach_stream", "connection_ap_mark_as_non_pending_circuit", "connection_ap_mark_as_pending_circuit_", "generic_buffer_set_to_copy", "pathbias_mark_use_rollback", "control_event_stream_status", "log_fn_"]}, {"name": "tor_tls_cert_matches_key", "calls": []}, {"name": "bitarray_is_set", "calls": []}, {"name": "digest256map_entries_eq", "calls": ["tor_memeq"]}, {"name": "clean_up_backtrace_handler", "calls": ["remove_bt_handler"]}, {"name": "connection_counts_as_relayed_traffic", "calls": ["TO_OR_CONN", "connection_or_client_used"]}, {"name": "dns_reset_correctness_checks", "calls": ["smartlist_clear"]}, {"name": "config_dup", "calls": ["tor_assertion_failed_", "config_new", "config_get_assigned_option", "config_free_lines", "config_assign", "log_fn_"]}, {"name": "router_get_hashes_impl", "calls": ["log_fn_", "router_get_hash_impl_helper", "crypto_digest_all"]}, {"name": "dump_pk_ops", "calls": ["tor_log"]}, {"name": "get_max_sockets", "calls": []}, {"name": "control_event_newconsensus", "calls": ["control_event_is_interesting", "control_event_networkstatus_changed_helper"]}, {"name": "worker_thread_has_work", "calls": []}, {"name": "launch_test_addresses", "calls": ["get_options", "launch_one_resolve", "tor_assertion_failed_", "escaped_safe_str", "log_fn_"]}, {"name": "format_cell_stats", "calls": ["smartlist_free", "smartlist_join_strings", "TO_OR_CIRCUIT", "smartlist_add_asprintf", "append_cell_stats_by_command", "TO_ORIGIN_CIRCUIT", "smartlist_new"]}, {"name": "rend_client_send_establish_rendezvous", "calls": ["crypto_rand", "pathbias_count_use_attempt", "tor_assertion_failed_", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "channel_tls_get_remote_addr_method", "calls": ["channel_tls_from_base", "tor_addr_copy", "tor_assertion_failed_", "tor_addr_make_unspec"]}, {"name": "rep_hist_buffer_stats_term", "calls": ["rep_hist_reset_buffer_stats"]}, {"name": "smartlist_add_asprintf", "calls": ["smartlist_add_vasprintf"]}, {"name": "validate_recommended_package_line", "calls": ["tor_assertion_failed_"]}, {"name": "tor_addr_from_ipv4n", "calls": ["tor_assertion_failed_"]}, {"name": "state_transport_line_is_valid", "calls": ["smartlist_free", "smartlist_split_string", "tor_addr_port_lookup", "smartlist_new", "log_fn_"]}, {"name": "rend_cache_failure_purge", "calls": ["strmap_new", "log_fn_"]}, {"name": "digest256map_impl_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "rsamap_HT_INSERT", "calls": ["keypin_ent_hash_rsa", "rsamap_HT_GROW"]}, {"name": "get_controller_cookie_file_name", "calls": ["get_options", "tor_strdup_", "options_get_datadir_fname2_suffix"]}, {"name": "get_last_hid_serv_requests", "calls": ["strmap_new"]}, {"name": "chan_cell_queue_len", "calls": []}, {"name": "sb_open", "calls": ["log_fn_"]}, {"name": "crypto_dh_dup", "calls": ["tor_assertion_failed_", "tor_malloc_zero_"]}, {"name": "connection_ext_or_auth_neg_auth_type", "calls": ["connection_fetch_from_buf", "connection_get_inbuf_len", "log_fn_"]}, {"name": "llvm.memset.p0i8.i64", "calls": []}, {"name": "replaycache_scrub_if_needed", "calls": ["replaycache_scrub_if_needed_internal"]}, {"name": "circuitmux_move_active_circ_to_tail", "calls": ["tor_assertion_failed_", "circuitmux_next_active_circ_p", "TO_OR_CIRCUIT", "circuitmux_prev_active_circ_p"]}, {"name": "string_is_valid_hostname", "calls": ["smartlist_free", "smartlist_split_string", "smartlist_new"]}, {"name": "is_legal_nickname", "calls": ["tor_assertion_failed_"]}, {"name": "smartlist_contains_string_case", "calls": []}, {"name": "signal_callback", "calls": ["process_signal"]}, {"name": "get_seconds_valid", "calls": []}, {"name": "set_log_time_granularity", "calls": []}, {"name": "or_state_free", "calls": ["config_free"]}, {"name": "num_bridges_usable", "calls": ["get_options", "tor_assertion_failed_", "choose_random_entry_impl"]}, {"name": "check_fw_helper_app_callback", "calls": ["smartlist_free", "get_list_of_ports_to_forward", "server_mode", "net_is_disabled", "tor_check_port_forwarding"]}, {"name": "directory_all_unreachable_cb", "calls": ["safe_str_client", "TO_ENTRY_CONN", "connection_get_by_type_state", "control_event_general_error", "connection_mark_unattached_ap_", "log_fn_"]}, {"name": "base32_encode", "calls": ["tor_assertion_failed_"]}, {"name": "pt_proxies_configuration_pending", "calls": []}, {"name": "keypin_ent_hash_ed", "calls": []}, {"name": "digest256map_iter_get", "calls": ["tor_assertion_failed_"]}, {"name": "node_get_prim_addr_ipv4h", "calls": []}, {"name": "marked_circuit_free_stream_bytes", "calls": ["TO_ORIGIN_CIRCUIT", "marked_circuit_streams_free_bytes", "TO_OR_CIRCUIT"]}, {"name": "routerset_add_unknown_ccs", "calls": ["routerset_new", "smartlist_add", "routerset_refresh_countries", "geoip_get_country", "smartlist_contains_string_case", "tor_strdup_"]}, {"name": "curve25519_rand_seckey_bytes", "calls": ["crypto_rand", "crypto_strongest_rand"]}, {"name": "token_clear", "calls": ["crypto_pk_free"]}, {"name": "logfile_wants_message", "calls": []}, {"name": "channel_mark_remote", "calls": ["tor_assertion_failed_"]}, {"name": "networkstatus_copy_old_consensus_info", "calls": ["tor_memcmp", "tor_memeq"]}, {"name": "node_get_by_hex_id", "calls": ["node_get_nickname", "networkstatus_get_router_digest_by_nickname", "hex_digest_nickname_decode", "node_get_by_id", "tor_memeq"]}, {"name": "cached_dir_decref", "calls": ["clear_cached_dir"]}, {"name": "mark_bridge_list", "calls": ["smartlist_new"]}, {"name": "rep_hist_conn_stats_init", "calls": []}, {"name": "connection_get_another_active_or_conn", "calls": ["get_connection_array"]}, {"name": "addr_policy_permits_address", "calls": ["addr_policy_permits_tor_addr", "tor_addr_from_ipv4n"]}, {"name": "connection_state_is_open", "calls": ["tor_assertion_failed_"]}, {"name": "double_digest_map_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "dirserv_add_own_fingerprint", "calls": ["authdir_config_new", "crypto_pk_get_fingerprint", "add_fingerprint_to_dir", "log_fn_"]}, {"name": "tor_libevent_get_base", "calls": []}, {"name": "circuit_build_times_needs_circuits", "calls": ["circuit_build_times_enough_to_compute"]}, {"name": "circuitmux_num_circuits", "calls": ["tor_assertion_failed_"]}, {"name": "load_bridge_stats", "calls": ["get_options", "validate_bridge_stats", "options_get_datadir_fname2_suffix", "read_file_to_str"]}, {"name": "tor_log_err_sigsafe", "calls": ["format_dec_number_sigsafe", "tor_log_err_sigsafe_write"]}, {"name": "launch_direct_bridge_descriptor_fetch", "calls": ["get_options", "routerset_contains_bridge", "download_status_mark_impossible", "directory_initiate_command", "safe_str_client", "fmt_addr_impl", "connection_get_by_type_addr_port_purpose", "log_fn_"]}, {"name": "le_versions_compatibility", "calls": []}, {"name": "tor_x509_cert_get_id_digests", "calls": []}, {"name": "ed25519_pubkey_write_to_file", "calls": ["crypto_write_tagged_contents_to_file"]}, {"name": "chan_circid_map_HT_FIND", "calls": ["chan_circid_entry_hash_", "chan_circid_map_HT_FIND_P_"]}, {"name": "reset_descriptor_failures_callback", "calls": ["router_reset_descriptor_download_failures"]}, {"name": "median_int", "calls": ["find_nth_int"]}, {"name": "circuit_get_by_edge_conn", "calls": ["tor_assertion_failed_"]}, {"name": "connection_ap_handshake_socks_got_resolved_cell", "calls": ["connection_ap_handshake_socks_resolved_addr", "remap_event_helper", "tor_assertion_failed_", "connection_ap_handshake_socks_resolved", "tor_addr_family"]}, {"name": "list_getinfo_options", "calls": ["smartlist_free", "smartlist_sort_strings", "smartlist_add_asprintf", "smartlist_join_strings", "smartlist_new"]}, {"name": "clear_status_flags_on_sybil", "calls": []}, {"name": "initialise_libseccomp_sandbox", "calls": ["install_syscall_filter", "register_cfg", "install_sigsys_debugging"]}, {"name": "get_link_history", "calls": ["tor_digest_is_zero", "tor_malloc_zero_", "digestmap_get", "get_or_history", "digestmap_set"]}, {"name": "move_buf_to_buf", "calls": ["tor_assertion_failed_", "fetch_from_buf", "write_to_buf"]}, {"name": "circuitmux_count_queued_destroy_cells", "calls": ["circuit_id_in_use_on_channel", "packed_cell_get_circid", "log_fn_"]}, {"name": "dirserv_get_credible_bandwidth_kb", "calls": ["get_options", "router_get_advertised_bandwidth_capped", "dirserv_query_measured_bw_cache_kb", "tor_assertion_failed_"]}, {"name": "network_init", "calls": []}, {"name": "update_node_guard_status", "calls": ["node_get_mutable_by_id", "nodelist_get_list"]}, {"name": "dirserv_clear_measured_bw_cache", "calls": []}, {"name": "microdescs_add_to_cache", "calls": ["get_options", "networkstatus_get_latest_consensus_by_flavor", "microdesc_free_", "download_status_mark_impossible", "router_get_mutable_consensus_status_by_descriptor_digest", "digest256map_new", "smartlist_free", "digest256map_get", "microdescs_parse_from_string", "microdescs_add_list_to_cache", "tor_memeq", "smartlist_del", "smartlist_new", "digest256map_set", "log_fn_"]}, {"name": "node_get_declared_uptime", "calls": []}, {"name": "channel_set_remote_end", "calls": ["tor_digest_is_zero", "channel_is_in_state", "hex_str", "tor_strdup_", "channel_remove_from_digest_map", "tor_assertion_failed_", "channel_add_to_digest_map", "log_fn_"]}, {"name": "router_get_consensus_status_by_nickname", "calls": ["node_get_by_nickname"]}, {"name": "should_log_function_name", "calls": []}, {"name": "tor_accept_socket", "calls": ["tor_accept_socket_with_extensions"]}, {"name": "extend_info_dup", "calls": ["crypto_pk_dup_key", "tor_assertion_failed_", "tor_malloc_"]}, {"name": "channel_tls_matches_extend_info_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_", "tor_addr_compare", "log_fn_"]}, {"name": "tor_digest256_is_zero", "calls": ["tor_mem_is_zero"]}, {"name": "evdns_get_orig_address", "calls": []}, {"name": "circuit_consider_stop_edge_reading", "calls": ["TO_ORIGIN_CIRCUIT", "log_fn_", "TO_OR_CIRCUIT", "connection_stop_reading"]}, {"name": "smartlist_string_pos", "calls": []}, {"name": "tor_addr_from_in6", "calls": ["tor_addr_from_ipv6_bytes"]}, {"name": "initialize_periodic_events", "calls": ["periodic_event_setup", "tor_assertion_failed_", "find_periodic_event", "tor_libevent_get_base"]}, {"name": "pathbias_get_close_success_count", "calls": ["pathbias_count_circs_in_states"]}, {"name": "created_cell_format", "calls": ["tor_assertion_failed_", "set_uint16", "check_created_cell"]}, {"name": "channel_idmap_HT_INSERT", "calls": ["channel_idmap_HT_GROW", "channel_idmap_hash"]}, {"name": "socks_request_set_socks5_error", "calls": []}, {"name": "rend_service_begin_parse_intro", "calls": ["rend_service_free_intro", "tor_asprintf", "tor_malloc_zero_", "tor_malloc_"]}, {"name": "clientmap_entries_eq", "calls": ["strcmp_opt", "tor_addr_compare"]}, {"name": "nodelist_map_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "logv", "calls": ["logfile_wants_message", "pending_log_message_new", "format_msg", "tor_mutex_acquire", "smartlist_add", "tor_mutex_release"]}, {"name": "tor_digest_is_zero", "calls": ["tor_memeq"]}, {"name": "compare_signed_descriptors_by_age_", "calls": []}, {"name": "connection_or_tls_renegotiated_cb", "calls": ["connection_or_block_renegotiation", "connection_tls_finish_handshake", "connection_or_close_for_error"]}, {"name": "llvm.va_start", "calls": []}, {"name": "crypto_write_tagged_contents_to_file", "calls": ["smartlist_add", "write_chunks_to_file", "tor_snprintf", "smartlist_free", "smartlist_new"]}, {"name": "mark_logs_temp", "calls": ["tor_mutex_release", "tor_mutex_acquire"]}, {"name": "usable_consensus_flavor", "calls": ["get_options", "we_use_microdescriptors_for_circuits"]}, {"name": "authdir_mode_tests_reachability", "calls": ["authdir_mode_handles_descs"]}, {"name": "router_write_fingerprint", "calls": ["get_options", "get_server_identity_key", "write_str_to_file", "read_file_to_str", "crypto_pk_get_fingerprint", "options_get_datadir_fname2_suffix", "tor_asprintf", "crypto_pk_get_hashed_fingerprint", "log_fn_"]}, {"name": "tor_disable_debugger_attach", "calls": ["log_fn_"]}, {"name": "bridge_add_from_config", "calls": ["tor_digest_is_zero", "bridge_resolve_conflicts", "hex_str", "tor_addr_copy", "smartlist_add", "tor_assertion_failed_", "tor_malloc_zero_", "fmt_addrport", "smartlist_new", "log_fn_"]}, {"name": "read_bandwidth_usage", "calls": ["get_options", "options_get_datadir_fname2_suffix", "format_iso_time", "get_or_state", "log_fn_"]}, {"name": "reset_accounting", "calls": ["update_expected_bandwidth", "start_of_accounting_period_after", "start_of_accounting_period_containing", "log_fn_"]}, {"name": "circuits_compare_by_oldest_queued_item_", "calls": []}, {"name": "fetch_from_buf", "calls": ["tor_assertion_failed_", "peek_from_buf", "buf_remove_from_front"]}, {"name": "get_next_token", "calls": ["tor_memstr", "eat_whitespace_eos", "tor_snprintf", "memarea_alloc_zero", "memarea_alloc", "get_token_arguments", "crypto_pk_new", "token_check_object", "find_whitespace_eos", "crypto_pk_read_private_key_from_string", "crypto_pk_read_public_key_from_string", "strcmpstart", "eat_whitespace_eos_no_nl", "tor_assertion_failed_", "memarea_strndup", "strcmp_len", "memarea_strdup", "base64_decode", "token_clear"]}, {"name": "transport_free", "calls": []}, {"name": "memarea_new", "calls": ["alloc_chunk", "tor_malloc_"]}, {"name": "crash_handler", "calls": ["tor_log_get_sigsafe_err_fds", "clean_backtrace", "format_dec_number_sigsafe", "tor_log_err_sigsafe"]}, {"name": "proxy_configuration_finished", "calls": []}, {"name": "connection_ap_handshake_socks_reply", "calls": ["tor_assertion_failed_", "tor_addr_family", "pathbias_mark_use_success", "connection_write_to_buf", "stream_end_reason_to_socks5_response", "TO_ORIGIN_CIRCUIT", "control_event_stream_status", "log_fn_"]}, {"name": "authority_cert_dl_looks_uncertain", "calls": ["download_status_get_n_failures", "digestmap_get"]}, {"name": "round_uint64_to_next_multiple_of", "calls": ["tor_assertion_failed_"]}, {"name": "addr_policy_append_reject_addr_list", "calls": ["tor_assertion_failed_", "addr_policy_append_reject_addr"]}, {"name": "tor_memdup_", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "control_event_circ_bandwidth_used", "calls": ["TO_ORIGIN_CIRCUIT", "send_control_event", "circuit_get_global_list"]}, {"name": "connection_or_finished_connecting", "calls": ["connection_tls_start_handshake", "tor_assertion_failed_", "connection_or_change_state", "connection_start_reading", "control_event_bootstrap", "log_fn_", "connection_proxy_connect", "connection_or_close_for_error"]}, {"name": "crypto_openssl_get_version_str", "calls": ["parse_openssl_version_str"]}, {"name": "control_event_buildtimeout_set", "calls": ["control_event_is_interesting", "send_control_event"]}, {"name": "errno_to_stream_end_reason", "calls": ["log_fn_"]}, {"name": "clear_dir_servers", "calls": ["dir_server_free", "smartlist_clear", "router_dir_info_changed", "smartlist_new"]}, {"name": "fp_pair_map_get_by_digests", "calls": ["tor_assertion_failed_", "fp_pair_map_get"]}, {"name": "connection_bucket_refill", "calls": ["TO_OR_CONN", "connection_start_writing", "tor_asprintf", "connection_counts_as_relayed_traffic", "tor_gettimeofday_cached", "get_connection_array", "get_options", "enable_control_logging", "log_fn_", "connection_bucket_should_increase", "bucket_millis_empty", "connection_start_reading", "tor_assertion_failed_", "control_event_tb_empty", "connection_bucket_refill_helper", "disable_control_logging"]}, {"name": "keypin_check_and_add", "calls": ["keypin_check_and_add_impl"]}, {"name": "router_descriptor_is_older_than", "calls": ["approx_time"]}, {"name": "circuit_init_cpath_crypto", "calls": ["crypto_cipher_new", "tor_assertion_failed_", "crypto_digest_new", "crypto_digest_add_bytes", "log_fn_"]}, {"name": "add_syslog_log", "calls": ["tor_mutex_acquire", "tor_strdup_", "tor_snprintf", "tor_mutex_release", "tor_memdup_", "tor_malloc_zero_", "get_min_log_level"]}, {"name": "tor_gmtime_r", "calls": ["correct_tm"]}, {"name": "expand_filename", "calls": ["tor_asprintf", "tor_strdup_", "tor_assertion_failed_", "tor_strndup_", "get_user_homedir", "strcmpend", "log_fn_"]}, {"name": "tor_init", "calls": ["get_options", "tor_snprintf", "log_set_application_name", "addressmap_init", "options_init_from_torrc", "rep_hist_init", "crypto_early_init", "get_version", "config_free_lines", "crypto_openssl_get_version_str", "add_temp_log", "network_init", "crypto_global_init", "get_uname", "init_connection_lists", "tor_init_libevent_rng", "tor_libevent_get_version_str", "rend_cache_init", "stream_choice_seed_weak_rng", "config_parse_commandline", "tor_zlib_get_version_str", "log_fn_"]}, {"name": "connection_flush", "calls": ["connection_handle_write"]}, {"name": "control_setconf_helper", "calls": ["smartlist_free", "TOR_ISSPACE", "tor_strdup_", "smartlist_add", "send_control_done", "config_get_lines", "tor_strndup_", "config_free_lines", "connection_write_str_to_buf", "smartlist_join_strings", "connection_printf_to_buf", "extract_escaped_string", "tor_asprintf", "smartlist_new", "options_trial_assign", "log_fn_"]}, {"name": "connection_mark_for_close_internal_", "calls": ["add_connection_to_closeable_list", "tor_assertion_failed_", "assert_connection_ok", "log_fn_"]}, {"name": "circuit_receive_relay_cell", "calls": ["get_options", "circuit_receive_relay_cell", "append_cell_to_circuit_queue", "TO_OR_CIRCUIT", "pathbias_check_probe_response", "relay_lookup_conn", "relay_crypt", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "tor_assertion_failed_", "connection_edge_process_relay_cell", "log_fn_"]}, {"name": "format_msg", "calls": ["strlcpy", "tor_vsnprintf", "domain_to_string", "tor_snprintf", "should_log_function_name", "log_prefix_"]}, {"name": "circuit_list_path", "calls": ["circuit_list_path_impl"]}, {"name": "get_circuit_build_times", "calls": []}, {"name": "dir_server_add", "calls": ["smartlist_add", "router_dir_info_changed", "smartlist_new"]}, {"name": "channel_dumpstats", "calls": ["channel_dump_statistics", "tor_log"]}, {"name": "circuit_get_rendezvous", "calls": ["circuit_get_by_rend_token_and_purpose"]}, {"name": "router_pick_dirserver_generic", "calls": ["mark_all_dirservers_up", "tor_assertion_failed_", "router_pick_trusteddirserver_impl", "log_fn_"]}, {"name": "ed25519_seckey_write_to_file", "calls": ["crypto_write_tagged_contents_to_file"]}, {"name": "control_ports_write_to_file", "calls": ["get_options", "smartlist_free", "get_connection_array", "smartlist_add_asprintf", "write_str_to_file", "smartlist_join_strings", "smartlist_new", "log_fn_"]}, {"name": "workqueue_entry_free", "calls": []}, {"name": "log_fn_", "calls": ["logv"]}, {"name": "dircollator_collate_by_rsa", "calls": ["digestmap_iter_get", "smartlist_add", "digestmap_iter_init", "digestmap_iter_done", "digestmap_iter_next"]}, {"name": "geoip_bridge_stats_write", "calls": ["check_or_create_data_subdir", "geoip_format_bridge_stats", "format_bridge_stats_controller", "control_event_clients_seen", "write_to_data_subdir", "geoip_remove_old_clients"]}, {"name": "register_cfg", "calls": []}, {"name": "compute_consensus_method", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_sort", "smartlist_clear", "smartlist_add_all", "smartlist_new", "get_frequent_members", "tor_parse_long"]}, {"name": "accounting_parse_options", "calls": ["smartlist_free", "smartlist_split_string", "tor_assertion_failed_", "smartlist_new", "tor_parse_long", "log_fn_"]}, {"name": "ext_or_cmd_new", "calls": ["tor_malloc_"]}, {"name": "connection_finished_connecting", "calls": ["TO_OR_CONN", "get_options", "connection_edge_finished_connecting", "connection_dir_finished_connecting", "TO_DIR_CONN", "tor_assertion_failed_", "server_mode", "TO_EDGE_CONN", "log_fn_", "client_check_address_changed", "connection_or_finished_connecting"]}, {"name": "networkstatus_parse_vote_from_string", "calls": ["get_options", "smartlist_free", "networkstatus_vote_free", "find_by_keyword_", "authority_cert_is_blacklisted", "dump_desc", "document_signature_free", "memarea_drop_all", "find_start_of_next_routerstatus", "check_signature_token", "authority_cert_parse_from_string", "tor_strdup_", "voter_get_sig_by_algorithm", "digest256map_new", "tor_strndup_", "digest256map_get", "tor_memeq", "networkstatus_parse_flavor_name", "strcmpstart", "tor_digest_is_zero", "tor_inet_aton", "parse_iso_time", "hex_str", "smartlist_add", "networkstatus_get_voter_by_id", "tor_assertion_failed_", "tor_memdup_", "tor_malloc_zero_", "routerstatus_parse_entry_from_string", "router_get_networkstatus_v3_hashes", "digest256map_set", "escaped", "find_opt_by_keyword", "find_all_by_keyword", "memarea_new", "tokenize_string", "tor_parse_long", "tor_mem_is_zero", "crypto_digest_algorithm_parse_name", "base16_decode", "smartlist_new", "token_clear", "log_fn_"]}, {"name": "crypto_dh_compute_secret", "calls": ["crypto_expand_key_material_TAP", "crypto_log_errors", "tor_assertion_failed_", "memwipe", "tor_malloc_", "crypto_dh_get_bytes", "tor_check_dh_key", "log_fn_"]}, {"name": "node_get_description", "calls": ["format_node_description"]}, {"name": "smartlist_uniq_strings", "calls": []}, {"name": "secret_to_key_new", "calls": ["secret_to_key_make_specifier", "secret_to_key_key_len", "secret_to_key_compute_key"]}, {"name": "get_unique_stream_id_by_circ", "calls": ["log_fn_"]}, {"name": "addressmap_init", "calls": ["strmap_new"]}, {"name": "strmap_assign_key", "calls": ["tor_strdup_"]}, {"name": "rend_service_authorization_free", "calls": []}, {"name": "circuit_rep_hist_note_result", "calls": ["get_options", "router_get_my_routerinfo", "rep_hist_note_extend_failed", "server_mode", "rep_hist_note_extend_succeeded", "node_get_by_id"]}, {"name": "generic_buffer_set_to_copy", "calls": ["buf_copy", "buf_free"]}, {"name": "populate_live_entry_guards", "calls": ["get_options", "smartlist_free", "smartlist_contains", "nodelist_add_node_and_family", "smartlist_add", "entry_is_live", "decide_num_guards", "tor_assertion_failed_", "smartlist_new"]}, {"name": "double_digest_map_HT_FIND", "calls": ["double_digest_map_HT_FIND_P_", "ddmap_entry_hash"]}, {"name": "policy_summary_add_item", "calls": ["policy_summary_accept", "policy_summary_reject", "tor_assertion_failed_", "tor_addr_parse_mask_ports", "tor_addr_compare"]}, {"name": "geoip_dirreq_stats_term", "calls": ["geoip_reset_dirreq_stats"]}, {"name": "getaddrinfo_cache_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "connection_edge_process_relay_cell_not_open", "calls": ["get_options", "conn_state_to_string", "remap_event_helper", "tor_addr_family", "buf_free", "control_event_bootstrap", "TO_ORIGIN_CIRCUIT", "connection_edge_process_resolved_cell", "connection_ap_handshake_socks_reply", "TO_DIR_CONN", "connection_edge_package_raw_inbuf", "connection_mark_for_close_", "fmt_addr_impl", "client_dns_set_addressmap", "connection_ap_mark_as_non_pending_circuit", "tor_assertion_failed_", "connected_cell_parse", "tor_addr_is_internal_", "connection_edge_end", "connection_mark_unattached_ap_", "count_loading_descriptors_progress", "EDGE_TO_ENTRY_CONN", "consensus_is_waiting_for_certs", "connection_ap_process_end_not_open", "circuit_log_path", "tor_addr_is_null", "log_fn_"]}, {"name": "update_state_threadfn", "calls": ["server_onion_keys_free"]}, {"name": "secret_to_key_get_type", "calls": ["secret_to_key_key_len", "secret_to_key_spec_len"]}, {"name": "connection_is_reading", "calls": ["tor_assertion_failed_"]}, {"name": "sb_socketpair", "calls": []}, {"name": "geoip_ipv6_compare_entries_", "calls": []}, {"name": "crypto_cipher_new_with_iv", "calls": ["crypto_rand", "aes_new_cipher", "tor_malloc_zero_"]}, {"name": "read_to_chunk", "calls": ["CHUNK_WRITE_PTR", "tor_assertion_failed_", "CHUNK_REMAINING_CAPACITY", "log_fn_"]}, {"name": "fmt_addr_impl", "calls": ["tor_addr_to_str"]}, {"name": "keypin_load_journal", "calls": ["tor_mmap_file", "tor_munmap_file", "keypin_load_journal_impl"]}, {"name": "tor_tls_finish_handshake", "calls": ["check_no_tls_errors_", "tor_tls_client_is_using_v2_ciphers", "tls_log_errors", "log_fn_"]}, {"name": "get_num_cpus", "calls": ["compute_num_cpus"]}, {"name": "peek_from_buf", "calls": ["tor_assertion_failed_"]}, {"name": "digestset_new", "calls": ["bitarray_init_zero", "tor_log2", "tor_malloc_"]}, {"name": "compare_cell_ewma_counts", "calls": []}, {"name": "median_double", "calls": ["find_nth_double"]}, {"name": "connection_ext_or_auth_handle_client_hash", "calls": ["TO_OR_CONN", "connection_fetch_from_buf", "connection_ext_or_auth_send_result", "connection_get_inbuf_len", "tor_memeq", "log_fn_"]}, {"name": "get_first_advertised_port_by_type_af", "calls": ["tor_addr_family"]}, {"name": "router_get_advertised_or_port", "calls": ["router_get_advertised_or_port_by_af"]}, {"name": "pathbias_count_use_success", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "hex_str", "pathbias_state_to_string", "circuit_state_to_string", "entry_guards_changed", "circuit_purpose_to_string", "log_fn_"]}, {"name": "dirserv_have_any_microdesc", "calls": ["get_microdesc_cache", "microdesc_cache_lookup_by_digest256"]}, {"name": "cache_failure_intro_lookup", "calls": ["strmap_get_lc", "digestmap_get", "tor_assertion_failed_"]}, {"name": "count_real_listeners", "calls": []}, {"name": "node_get_by_id", "calls": ["node_get_mutable_by_id"]}, {"name": "circuitmux_is_circuit_active", "calls": ["circuitmux_find_map_entry", "tor_assertion_failed_"]}, {"name": "cert_list_free_", "calls": ["cert_list_free"]}, {"name": "tor_read_all_from_process_stdout", "calls": ["tor_read_all_handle"]}, {"name": "tor_tls_get_forced_write_size", "calls": []}, {"name": "set_max_file_descriptors", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "tv_mdiff", "calls": ["log_fn_"]}, {"name": "authdir_policy_badexit_address", "calls": ["get_options", "addr_is_in_cc_list", "addr_policy_permits_address"]}, {"name": "smartlist_get_most_frequent_string", "calls": []}, {"name": "start_daemon", "calls": ["set_main_thread", "log_fn_"]}, {"name": "crypto_hmac_sha256", "calls": ["tor_assertion_failed_"]}, {"name": "onion_pending_add", "calls": ["rate_limit_log", "have_room_for_onionskin", "tor_malloc_zero_", "onion_queue_entry_remove", "circuit_mark_for_close_", "approx_time", "log_fn_"]}, {"name": "pathbias_scale_use_rates", "calls": ["get_options", "pathbias_get_scale_ratio", "hex_str", "pathbias_get_scale_use_threshold", "entry_guards_changed", "pathbias_count_circs_in_states", "log_fn_"]}, {"name": "tor_addr_to_str", "calls": ["tor_snprintf", "tor_assertion_failed_", "tor_addr_family", "tor_inet_ntop"]}, {"name": "entry_guards_free_all", "calls": ["clear_bridge_list", "circuit_build_times_free_timeouts", "smartlist_free", "get_circuit_build_times_mutable", "entry_guard_free"]}, {"name": "getargs_helper", "calls": ["connection_printf_to_buf", "smartlist_free", "smartlist_split_string", "smartlist_new"]}, {"name": "tor_x509_cert_get_cert_digests", "calls": []}, {"name": "get_my_v3_authority_cert", "calls": []}, {"name": "parse_addr_policy", "calls": ["smartlist_clear", "smartlist_split_string", "policy_expand_unspec", "smartlist_add", "smartlist_free", "addr_policy_list_free", "smartlist_add_all", "router_parse_addr_policy_item_from_string", "policy_expand_private", "smartlist_new", "log_fn_"]}, {"name": "build_state_get_exit_nickname", "calls": []}, {"name": "tor_tls_client_is_using_v2_ciphers", "calls": ["tor_tls_classify_client_ciphers", "log_fn_"]}, {"name": "addressmap_clear_configured", "calls": ["addressmap_get_mappings"]}, {"name": "handle_control_takeownership", "calls": ["send_control_done", "log_fn_"]}, {"name": "addressmap_match_superdomains", "calls": ["strmap_get_lc"]}, {"name": "get_uint16", "calls": []}, {"name": "tor_main", "calls": ["get_options", "do_dump_config", "do_list_fingerprint", "get_version", "load_ed_keys", "do_hash_password", "tor_cleanup", "tor_init", "configure_backtrace_handler", "update_approx_time", "sandbox_init_filter", "init_logging", "do_main_loop", "sandbox_init", "tor_threads_init", "log_fn_"]}, {"name": "config_is_same", "calls": ["config_get_assigned_option", "tor_assertion_failed_", "config_free_lines", "config_lines_eq"]}, {"name": "tor_getpwuid", "calls": []}, {"name": "version_from_platform", "calls": ["tor_strndup_", "strcmpstart", "find_whitespace"]}, {"name": "addressmap_rewrite", "calls": ["addressmap_match_superdomains", "strlcpy", "tor_strdup_", "tor_addr_parse", "strmap_get", "strlcat", "strcmpend", "escaped_safe_str_client", "log_fn_"]}, {"name": "consensus_max_download_tries", "calls": ["networkstatus_consensus_can_use_extra_fallbacks"]}, {"name": "connection_unlink", "calls": ["TO_OR_CONN", "tor_digest_is_zero", "connection_about_to_close_connection", "connection_or_remove_from_identity_map", "assert_connection_edge_not_dns_pending", "connection_start_reading", "connection_free", "TO_EDGE_CONN", "smartlist_remove", "connection_remove"]}, {"name": "circuit_deliver_create_cell", "calls": ["create_cell_format_relayed", "log_fn_ratelim_", "circuit_set_n_circid_chan", "get_unique_circ_id_by_chan", "append_cell_to_circuit_queue", "channel_is_in_state", "tor_assertion_failed_", "channel_timestamp_client", "tor_gettimeofday", "channel_state_to_string", "create_cell_format", "TO_ORIGIN_CIRCUIT", "log_fn_"]}, {"name": "tor_weak_random_range", "calls": ["tor_assertion_failed_", "tor_weak_random"]}, {"name": "address_ttl_free", "calls": []}, {"name": "channel_listener_register", "calls": ["smartlist_add", "tor_assertion_failed_", "smartlist_new", "channel_listener_state_to_string", "log_fn_"]}, {"name": "rend_parse_v2_service_descriptor", "calls": ["smartlist_free", "rend_service_descriptor_free", "find_by_keyword_", "rend_valid_descriptor_id", "escaped", "check_signature_token", "rend_get_descriptor_id_bytes", "router_get_hash_impl", "tor_memdup_", "smartlist_new", "smartlist_split_string", "tor_assertion_failed_", "note_crypto_pk_op", "tor_malloc_zero_", "tor_memeq", "memarea_drop_all", "find_opt_by_keyword", "base32_decode", "crypto_pk_get_digest", "memarea_new", "tokenize_string", "tor_parse_long", "parse_iso_time_", "token_clear", "log_fn_"]}, {"name": "keypin_add_entry_to_map", "calls": ["edmap_HT_INSERT", "rsamap_HT_INSERT"]}, {"name": "tor_tls_set_renegotiate_callback", "calls": []}, {"name": "circuit_purpose_to_controller_string", "calls": ["tor_snprintf"]}, {"name": "run_scheduled_events", "calls": ["get_options", "connection_expire_held_open", "channel_listener_run_cleanup", "rend_consider_services_upload", "connection_dir_close_extra_consensus_conns", "channel_run_cleanup", "router_have_minimum_dir_info", "circuit_expire_old_circs_as_needed", "fetch_bridge_descriptors", "rend_consider_descriptor_republication", "or_state_save", "dirvote_act", "run_connection_housekeeping", "circuit_build_needed_circs", "net_is_disabled", "consider_hibernation", "accounting_run_housekeeping", "signewnym_impl", "have_completed_a_circuit", "connection_or_set_bad_connections", "circuit_close_all_marked", "connection_ap_expire_beginning", "pt_configure_remaining_proxies", "pt_proxies_configuration_pending", "close_closeable_connections", "accounting_is_enabled", "authdir_mode_v3", "circuit_expire_building", "log_fn_"]}, {"name": "write_short_policy", "calls": ["smartlist_free", "tor_strdup_", "smartlist_add", "smartlist_add_asprintf", "smartlist_join_strings", "smartlist_new"]}, {"name": "fascist_firewall_allows_address_dir", "calls": ["addr_policy_permits_tor_addr"]}, {"name": "dir_server_new", "calls": ["strlcpy", "tor_dup_addr", "tor_addr_copy", "tor_strdup_", "tor_addr_make_unspec", "tor_assertion_failed_", "tor_addr_family", "tor_addr_to_ipv4h", "tor_asprintf", "tor_malloc_zero_", "log_fn_"]}, {"name": "lookup_last_hid_serv_request", "calls": ["base32_encode", "strmap_set", "tor_snprintf", "strmap_get_lc", "tor_malloc_zero_", "get_last_hid_serv_requests"]}, {"name": "dir_split_resource_into_fingerprint_pairs", "calls": ["smartlist_free", "smartlist_split_string", "smartlist_add", "smartlist_sort", "smartlist_add_all", "escaped", "tor_memdup_", "base16_decode", "smartlist_new", "log_fn_"]}, {"name": "channel_timestamp_created", "calls": ["tor_assertion_failed_"]}, {"name": "get_signewnym_epoch", "calls": []}, {"name": "get_torrc_fname", "calls": ["get_default_conf_file"]}, {"name": "addr_policy_append_reject_addr_filter", "calls": ["tor_assertion_failed_", "tor_addr_is_v4", "tor_addr_is_public_for_reject", "addr_policy_append_reject_addr"]}, {"name": "crypto_pk_get_fingerprint", "calls": ["crypto_add_spaces_to_fp", "base16_encode", "crypto_pk_get_digest"]}, {"name": "rend_cache_entry_allocation", "calls": []}, {"name": "pick_curve25519_basepoint_impl", "calls": ["curve25519_basepoint_spot_check", "log_fn_"]}, {"name": "measured_bw_line_parse", "calls": ["TOR_ISSPACE", "strlcpy", "tor_strdup_", "escaped", "base16_decode", "strcmpstart", "tor_parse_long", "log_fn_"]}, {"name": "rimap_remove", "calls": ["digestmap_remove"]}, {"name": "ensure_bandwidth_cap", "calls": ["tor_asprintf"]}, {"name": "hex_str", "calls": ["base16_encode"]}, {"name": "authority_cert_get_newest_by_id", "calls": ["digestmap_get"]}, {"name": "download_status_mark_impossible", "calls": []}, {"name": "fp_pair_map_assert_ok", "calls": ["tor_assertion_failed_", "fp_pair_map_impl_HT_REP_IS_BAD_"]}, {"name": "rate_limit_is_ready", "calls": []}, {"name": "esc_router_info", "calls": ["tor_asprintf", "esc_for_log"]}, {"name": "log_from_pipe", "calls": ["log_portfw_spawn_error_message", "tor_assertion_failed_", "get_string_from_pipe", "strcmpstart", "log_fn_"]}, {"name": "fetch_ext_or_command_from_buf", "calls": ["peek_from_buf", "get_uint16", "ext_or_cmd_new", "fetch_from_buf", "buf_remove_from_front"]}, {"name": "link_apconn_to_circ", "calls": ["node_describe", "safe_str_client", "rend_client_note_connection_attempt_ended", "cpath_is_on_circuit", "connection_edge_update_circuit_isolation", "connection_edge_is_rendezvous_stream", "tor_assertion_failed_", "optimistic_data_enabled", "node_get_by_id", "log_fn_"]}, {"name": "rep_hist_note_used_internal", "calls": []}, {"name": "address_is_invalid_mapaddress_target", "calls": ["address_is_invalid_destination", "strcmpstart"]}, {"name": "sandbox_init", "calls": ["initialise_libseccomp_sandbox"]}, {"name": "policy_is_reject_star", "calls": ["tor_addr_family"]}, {"name": "server_onion_keys_new", "calls": ["construct_ntor_key_map", "router_get_my_id_digest", "tor_malloc_zero_", "dup_onion_keys", "curve25519_keypair_generate"]}, {"name": "managed_proxy_create", "calls": ["smartlist_add", "assert_unconfigured_count_ok", "tor_malloc_zero_", "get_pt_proxy_uri", "add_transport_to_proxy", "smartlist_new"]}, {"name": "base64_encode_size", "calls": ["tor_assertion_failed_"]}, {"name": "tor_dup_ip", "calls": ["tor_inet_ntop", "tor_strdup_"]}, {"name": "parse_bridge_line", "calls": ["smartlist_clear", "smartlist_split_string", "bridge_line_free", "smartlist_del_keeporder", "string_is_key_value", "smartlist_add", "tor_assertion_failed_", "smartlist_free", "validate_transport_socks_arguments", "tor_addr_port_parse", "tor_malloc_zero_", "smartlist_add_all", "smartlist_join_strings", "base16_decode", "string_is_C_identifier", "smartlist_new", "log_fn_"]}, {"name": "tor_realloc_", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "tor_get_lines_from_handle", "calls": ["smartlist_add", "smartlist_new", "get_string_from_pipe", "tor_strdup_"]}, {"name": "make_tap_onion_key_crosscert", "calls": ["tor_memdup_", "crypto_pk_private_sign", "crypto_pk_get_digest"]}, {"name": "strmap_entries_eq", "calls": []}, {"name": "write_to_data_subdir", "calls": ["get_options", "write_str_to_file", "options_get_datadir_fname2_suffix", "log_fn_"]}, {"name": "have_lockfile", "calls": []}, {"name": "tor_addr_copy", "calls": ["tor_assertion_failed_"]}, {"name": "packed_cell_free_unchecked", "calls": []}, {"name": "compare_digest_to_vote_routerstatus_entry", "calls": ["tor_memcmp"]}, {"name": "munge_extrainfo_into_routerinfo", "calls": ["tor_memstr", "tor_assertion_failed_", "tor_strndup_", "tor_malloc_", "signed_descriptor_get_body"]}, {"name": "channel_idmap_HT_REP_IS_BAD_", "calls": ["channel_idmap_hash"]}, {"name": "find_periodic_event", "calls": []}, {"name": "rep_hist_reset_exit_stats", "calls": []}, {"name": "connection_close_immediate", "calls": ["connection_unregister_events", "conn_state_to_string", "conn_type_to_string", "tor_close_socket", "assert_connection_ok", "buf_clear", "log_fn_"]}, {"name": "get_circ_id_size", "calls": []}, {"name": "connection_ap_make_link", "calls": ["entry_connection_new", "base16_encode", "connection_ap_mark_as_pending_circuit_", "tor_strdup_", "tor_addr_make_unspec", "tor_assertion_failed_", "tor_addr_family", "connection_add_impl", "connection_free", "safe_str_client", "strlcpy", "tor_malloc_", "control_event_stream_status", "connection_link_connections", "log_fn_"]}, {"name": "buf_clear", "calls": ["chunk_free_unchecked"]}, {"name": "cache_map_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "smartlist_intersect", "calls": ["smartlist_contains"]}, {"name": "tor_escape_str_for_pt_args", "calls": ["tor_strdup_", "tor_assertion_failed_", "tor_malloc_"]}, {"name": "generate_certificate", "calls": ["get_fingerprint", "format_iso_time", "get_digest", "key_to_string", "tor_localtime_r", "tor_snprintf", "base64_encode", "strlcat", "log_fn_"]}, {"name": "tor_gzip_uncompress", "calls": ["is_compression_bomb", "tor_assertion_failed_", "method_bits", "tor_realloc_", "tor_malloc_", "tor_malloc_zero_", "is_gzip_supported", "log_fn_"]}, {"name": "circuit_pick_extend_handshake", "calls": ["circuit_pick_create_handshake", "node_has_curve25519_onion_key"]}, {"name": "pick_rendezvous_node", "calls": ["get_options", "router_choose_random_node"]}, {"name": "getaddrinfo_cache_HT_FIND_P_", "calls": ["cached_getaddrinfo_items_eq"]}, {"name": "connection_init_or_handshake_state", "calls": ["tor_malloc_zero_", "log_fn_"]}, {"name": "safe_str_client", "calls": ["get_options", "tor_assertion_failed_"]}, {"name": "check_descriptor_ipaddress_changed", "calls": ["get_options", "tor_addr_from_ipv4n", "resolve_my_address", "ip_address_changed", "tor_asprintf", "log_addr_has_changed", "log_fn_"]}, {"name": "clamp_double_to_int64", "calls": []}, {"name": "nodelist_map_HT_REMOVE", "calls": ["node_id_hash", "nodelist_map_HT_FIND_P_"]}, {"name": "process_environment_make", "calls": ["smartlist_free", "tor_assertion_failed_", "environment_variable_names_equal", "smartlist_sort_strings", "str_num_before", "smartlist_add_all", "tor_malloc_zero_", "tor_calloc_", "smartlist_new", "log_fn_"]}, {"name": "sandbox_disable_getaddrinfo_cache", "calls": []}, {"name": "onion_skin_client_handshake", "calls": ["memwipe", "tor_malloc_", "fast_client_handshake", "onion_skin_TAP_client_handshake", "onion_skin_ntor_client_handshake", "log_fn_"]}, {"name": "rep_hist_desc_stats_term", "calls": []}, {"name": "node_describe_longname_by_id", "calls": ["node_get_verbose_nickname_by_id"]}, {"name": "make_ntor_onion_key_crosscert", "calls": ["memwipe", "ed25519_keypair_from_curve25519_keypair", "tor_cert_create"]}, {"name": "pt_get_socks_args_for_proxy_addrport", "calls": ["get_socks_args_by_bridge_addrport", "pt_stringify_socks_args"]}, {"name": "rsamap_HT_REMOVE", "calls": ["rsamap_HT_FIND_P_", "keypin_ent_hash_rsa"]}, {"name": "dir_fetch_type", "calls": ["log_fn_"]}, {"name": "crypto_pk_read_private_key_from_string", "calls": ["crypto_log_errors", "tor_assertion_failed_"]}, {"name": "crypto_cipher_encrypt", "calls": ["aes_crypt", "tor_assertion_failed_"]}, {"name": "dirvote_add_signatures_to_all_pending_consensuses", "calls": ["dirvote_add_signatures_to_pending_consensus", "tor_assertion_failed_", "get_detached_signatures_from_pending_consensuses", "ns_detached_signatures_free", "networkstatus_parse_detached_signatures"]}, {"name": "extend_info_from_router", "calls": ["router_get_prim_orport", "tor_assertion_failed_", "extend_info_new"]}, {"name": "cpuworker_cancel_circ_handshake", "calls": ["memwipe", "workqueue_entry_cancel", "tor_assertion_failed_"]}, {"name": "tor_vsscanf", "calls": ["digit_to_num", "scan_signed", "TOR_ISDIGIT", "scan_unsigned", "scan_string", "scan_double"]}, {"name": "rend_service_relaunch_rendezvous", "calls": ["rend_data_dup", "circuit_launch_by_extend_info", "safe_str", "tor_assertion_failed_", "extend_info_describe", "log_fn_"]}, {"name": "routerstatus_format_entry", "calls": ["smartlist_free", "fmt_addrport", "router_get_by_id_digest", "digest_to_base64", "smartlist_add_asprintf", "smartlist_join_strings", "fmt_addr32", "tor_strdup_", "tor_assertion_failed_", "smartlist_add", "policy_summarize", "digest256_to_base64", "router_get_advertised_bandwidth_capped", "tor_memeq", "base16_encode", "tor_addr_is_null", "format_iso_time", "tor_mem_is_zero", "smartlist_new", "log_fn_"]}, {"name": "ed25519_pubkey_read_from_file", "calls": ["crypto_read_tagged_contents_from_file"]}, {"name": "rimap_new", "calls": ["digestmap_new"]}, {"name": "rotate_onion_key_callback", "calls": ["rotate_onion_key", "server_mode", "router_upload_dir_desc_to_dirservers", "get_onion_key_set_at", "cpuworkers_rotate_keyinfo", "safe_timer_diff", "advertised_server_mode", "router_rebuild_descriptor", "log_fn_"]}, {"name": "TOR_ISALNUM", "calls": []}, {"name": "routerset_to_string", "calls": ["tor_strdup_", "smartlist_join_strings"]}, {"name": "record_bridge_stats_callback", "calls": ["should_record_bridge_info", "safe_timer_diff", "geoip_bridge_stats_write", "geoip_bridge_stats_init"]}, {"name": "tor_threadlocal_init", "calls": []}, {"name": "digest256map_impl_HT_NEXT_RMV", "calls": []}, {"name": "tls_error_to_orconn_end_reason", "calls": []}, {"name": "chanid_circid_muxinfo_map_HT_FIND", "calls": ["chanid_circid_entry_hash", "chanid_circid_muxinfo_map_HT_FIND_P_"]}, {"name": "pathbias_mark_use_rollback", "calls": ["log_fn_"]}, {"name": "tor_addr_lookup", "calls": ["sandbox_freeaddrinfo", "tor_assertion_failed_", "tor_addr_from_in6", "tor_addr_from_ipv4n", "sandbox_getaddrinfo", "tor_inet_pton"]}, {"name": "get_options", "calls": ["get_options_mutable"]}, {"name": "peek_buf_has_control0_command", "calls": ["get_uint16", "peek_from_buf"]}, {"name": "circuitmux_prev_active_circ_p", "calls": ["tor_assertion_failed_", "TO_OR_CIRCUIT"]}, {"name": "channel_count_recved", "calls": ["tor_assertion_failed_"]}, {"name": "crypto_xof_new", "calls": ["tor_malloc_"]}, {"name": "microdesc_cache_reload", "calls": ["smartlist_free", "tor_mmap_file", "microdesc_cache_rebuild", "read_file_to_str", "microdescs_add_to_cache", "microdesc_cache_clear", "log_fn_"]}, {"name": "networkstatus_compute_consensus", "calls": ["get_options", "compute_consensus_method", "smartlist_free", "networkstatus_vote_free", "smartlist_join_strings", "dirvote_compute_params", "networkstatus_get_flavor_name", "smartlist_sort", "compute_routerstatus_consensus", "networkstatus_parse_vote_from_string", "escaped", "smartlist_string_pos", "sort_version_list", "networkstatus_compute_bw_weights_v10", "smartlist_split_string", "strmap_set_lc", "dircollator_collate", "router_get_dirobj_signature", "get_voter", "strlcpy", "tor_parse_ulong", "strmap_get_lc", "tor_strdup_", "smartlist_sort_strings", "smartlist_add_asprintf", "median_int", "crypto_digest_smartlist", "median_uint32", "tor_addr_copy", "tor_calloc_", "strcmpstart", "tor_asprintf", "fmt_addr32", "update_total_bandwidth_weights", "tor_digest_is_zero", "smartlist_add_all", "dircollator_get_votes_for_router", "dircollator_n_routers", "tor_digest256_is_zero", "smartlist_add", "tor_assertion_failed_", "compute_consensus_package_lines", "crypto_digest_algorithm_get_name", "strmap_new", "digest256_to_base64", "median_time", "dircollator_add_vote", "routerstatus_format_entry", "smartlist_uniq_strings", "smartlist_clear", "compute_consensus_versions_list", "base16_encode", "dircollator_free", "consensus_method_is_supported", "tor_malloc_zero_", "format_iso_time", "networkstatus_verify_bw_weights", "crypto_pk_get_fingerprint", "smartlist_get_most_frequent_string", "dircollator_new", "smartlist_new", "tor_parse_long", "log_fn_"]}, {"name": "rend_cache_clean", "calls": ["strmap_iter_get", "tor_assertion_failed_", "strmap_iter_init", "strmap_iter_done", "rend_cache_entry_free", "strmap_iter_next_rmv", "strmap_iter_next"]}, {"name": "scheduler_get_queue_heuristic", "calls": ["scheduler_update_queue_heuristic", "approx_time"]}, {"name": "geoip_get_bridge_stats_controller", "calls": ["format_bridge_stats_controller"]}, {"name": "parse_reachable_addresses", "calls": ["get_options", "addr_policy_list_free", "parse_addr_policy", "log_fn_"]}, {"name": "get_interface_address", "calls": ["tor_addr_to_ipv4h", "get_interface_address6"]}, {"name": "remove_all_entry_guards", "calls": ["log_entry_guards", "base16_encode", "control_event_guard", "entry_guards_changed", "smartlist_del", "log_fn_", "entry_guard_free"]}, {"name": "networkstatus_dump_bridge_status_to_file", "calls": ["get_options", "router_get_routerlist", "networkstatus_getinfo_by_purpose", "dirserv_get_flag_thresholds_line", "write_str_to_file", "dirserv_compute_bridge_flag_thresholds", "format_iso_time", "tor_asprintf"]}, {"name": "answer_is_wildcarded", "calls": ["smartlist_contains_string"]}, {"name": "dns_resolve_impl", "calls": ["get_options", "cache_map_HT_FIND", "tor_addr_family", "launch_resolve", "assert_connection_ok", "strlcpy", "tor_addr_parse_PTR_name", "cache_map_HT_INSERT", "set_expiry", "router_my_exit_policy_is_reject_star", "escaped_safe_str", "tor_strlower", "purge_expired_resolves", "tor_log", "address_is_invalid_destination", "tor_assertion_failed_", "tor_addr_is_internal_", "tor_malloc_zero_", "set_exitconn_info_from_resolve", "tor_addr_parse", "tor_addr_copy", "log_fn_"]}, {"name": "nodelist_assert_ok", "calls": ["microdesc_cache_lookup_by_digest256", "networkstatus_get_latest_consensus", "tor_assertion_failed_", "router_get_routerlist", "digestmap_new", "digestmap_get", "digestmap_set", "node_get_by_id"]}, {"name": "tor_mathlog", "calls": []}, {"name": "dirvote_compute_consensuses", "calls": ["get_options", "smartlist_free", "networkstatus_vote_free", "get_my_v3_authority_signing_key", "networkstatus_get_flavor_name", "get_n_authorities", "get_my_v3_legacy_signing_key", "networkstatus_parse_vote_from_string", "networkstatus_check_consensus_signature", "get_my_v3_authority_cert", "dirvote_clear_pending_consensuses", "dirvote_add_signatures_to_all_pending_consensuses", "smartlist_contains_string", "get_my_v3_legacy_cert", "options_get_datadir_fname2_suffix", "get_detached_signatures_from_pending_consensuses", "directory_post_to_dirservers", "write_chunks_to_file", "smartlist_add", "tor_assertion_failed_", "tor_malloc_", "smartlist_clear", "networkstatus_compute_consensus", "crypto_pk_get_digest", "smartlist_new", "log_fn_"]}, {"name": "routerset_union", "calls": ["tor_assertion_failed_", "routerset_to_string", "routerset_parse"]}, {"name": "tor_cert_parse", "calls": ["tor_memdup_", "tor_malloc_zero_", "tor_cert_free"]}, {"name": "rend_cache_store_v2_desc_as_client", "calls": ["rend_service_descriptor_free", "tor_snprintf", "base32_decode", "strmap_set_lc", "escaped_safe_str_client", "rend_cache_entry_allocation", "rend_parse_v2_service_descriptor", "strlcpy", "safe_str", "rend_get_service_id", "rend_cache_decrement_allocation", "rend_parse_introduction_points", "tor_assertion_failed_", "tor_malloc_zero_", "rend_cache_failure_remove", "safe_str_client", "tor_memeq", "validate_intro_point_failure", "smartlist_new", "strmap_get_lc", "rend_decrypt_introduction_points", "tor_mem_is_zero", "rend_cache_increment_allocation", "log_fn_"]}, {"name": "count_established_intro_points", "calls": []}, {"name": "sdmap_remove", "calls": ["digestmap_remove"]}, {"name": "channel_note_destroy_not_pending", "calls": ["circuit_get_by_circid_channel_even_if_marked", "TO_OR_CIRCUIT", "channel_mark_circid_usable"]}, {"name": "dir_server_free", "calls": []}, {"name": "networkstatus_consensus_can_use_extra_fallbacks", "calls": ["tor_assertion_failed_", "router_get_fallback_dir_servers", "router_get_trusted_dir_servers", "directory_fetches_from_authorities"]}, {"name": "tls_get_write_overhead_ratio", "calls": []}, {"name": "get_onion_key", "calls": ["tor_assertion_failed_"]}, {"name": "digestmap_entry_free", "calls": []}, {"name": "conn_read_callback", "calls": ["conn_type_to_string", "connection_handle_read", "assert_connection_ok", "close_closeable_connections", "connection_mark_for_close_", "TO_EDGE_CONN", "connection_edge_end_errno", "log_fn_"]}, {"name": "check_consensus_waiting_for_certs", "calls": ["get_options", "dir_server_mode", "tor_assertion_failed_", "download_status_increment_failure"]}, {"name": "tor_addr_hash", "calls": ["tor_addr_family"]}, {"name": "tor_gettimeofday", "calls": ["log_fn_"]}, {"name": "circuit_dump_conn_details", "calls": ["circuit_state_to_string", "TO_ORIGIN_CIRCUIT", "circuit_log_path", "tor_log"]}, {"name": "rend_client_reextend_intro_circuit", "calls": ["safe_str_client", "rend_client_get_random_intro", "extend_info_free", "circuit_extend_to_new_exit", "extend_info_describe", "circuit_mark_for_close_", "log_fn_"]}, {"name": "read_to_chunk_tls", "calls": ["tor_assertion_failed_", "CHUNK_WRITE_PTR", "CHUNK_REMAINING_CAPACITY"]}, {"name": "accounting_run_housekeeping", "calls": ["time_to_record_bandwidth_usage", "configure_accounting", "get_or_state", "accounting_record_bandwidth_usage", "log_fn_"]}, {"name": "scheduler_run", "calls": ["smartlist_free", "channel_flush_some_cells", "smartlist_add", "tor_assertion_failed_", "smartlist_pqueue_pop", "smartlist_new", "scheduler_get_queue_heuristic", "channel_more_to_flush", "channel_get_global_queue_estimate", "log_fn_"]}, {"name": "digestmap_impl_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "cell_command_to_string", "calls": []}, {"name": "connection_edge_process_relay_cell", "calls": ["get_options", "circuit_clear_cell_queue", "connection_exit_begin_conn", "circuit_set_n_circid_chan", "channel_send_destroy", "circuit_send_next_onion_skin", "relay_header_unpack", "circuit_finish_handshake", "connection_state_is_open", "TO_ORIGIN_CIRCUIT", "log_fn_ratelim_", "circuit_mark_for_close_", "circuit_resume_edge_reading", "TO_OR_CONN", "rate_limit_log", "connection_edge_process_relay_cell_not_open", "extend_info_free", "connection_edge_package_raw_inbuf", "circuit_queue_streams_are_blocked", "connection_write_to_buf", "log_fn_", "extended_cell_parse", "connection_mark_for_close_", "approx_time", "stream_end_reason_to_string", "tor_assertion_failed_", "circuit_consider_sending_sendme", "circuit_truncated", "connection_start_reading", "connection_edge_end", "circuit_extend", "connection_exit_begin_resolve", "rend_process_relay_cell", "connection_mark_for_close_internal_", "relay_send_command_from_edge_", "EDGE_TO_ENTRY_CONN", "TO_OR_CIRCUIT", "connection_edge_consider_sending_sendme", "networkstatus_get_param", "connection_or_close_for_error", "circuit_set_state"]}, {"name": "scheduler_touch_channel", "calls": ["smartlist_pqueue_remove", "tor_assertion_failed_"]}, {"name": "node_is_me", "calls": ["router_digest_is_me"]}, {"name": "circuit_log_ancient_one_hop_circuits", "calls": ["get_options", "smartlist_free", "CONST_TO_ORIGIN_CIRCUIT", "conn_state_to_string", "conn_type_to_string", "tor_strdup_", "format_local_iso_time", "smartlist_add", "circuit_state_to_string", "circuit_get_global_list", "circuit_purpose_to_string", "tor_asprintf", "smartlist_new", "log_fn_"]}, {"name": "channel_connect_for_circuit", "calls": ["channel_connect", "command_setup_channel"]}, {"name": "chan_circid_entries_eq_", "calls": []}, {"name": "format_iso_time_nospace_usec", "calls": ["tor_snprintf", "format_iso_time_nospace", "tor_assertion_failed_"]}, {"name": "start_of_accounting_period_containing", "calls": ["edge_of_accounting_period_containing"]}, {"name": "dns_resolve", "calls": ["send_resolved_hostname_cell", "dns_cancel_pending_resolve", "dns_resolve_impl", "TO_OR_CIRCUIT", "send_resolved_cell", "connection_free", "tor_assertion_failed_"]}, {"name": "rend_cache_init", "calls": ["strmap_new", "digestmap_new"]}, {"name": "policy_map_HT_CLEAR", "calls": ["tor_free_", "policy_map_HT_INIT"]}, {"name": "get_proxy_type", "calls": ["get_options"]}, {"name": "SSL_get_server_random", "calls": ["tor_assertion_failed_"]}, {"name": "connection_outbuf_too_full", "calls": []}, {"name": "list_server_status_v1", "calls": ["get_options", "smartlist_free", "router_get_verbose_nickname", "smartlist_add", "tor_assertion_failed_", "dirserv_set_router_is_running", "smartlist_join_strings", "tor_strdup_", "list_single_server_status", "node_get_by_id", "smartlist_new", "authdir_mode_publishes_statuses"]}, {"name": "unescape_string", "calls": ["TOR_ISXDIGIT", "hex_decode_digit", "tor_malloc_"]}, {"name": "circuit_try_attaching_streams", "calls": ["circuit_try_clearing_isolation_state", "connection_ap_attach_pending"]}, {"name": "addressmap_clear_invalid_automaps", "calls": ["strmap_iter_get", "addressmap_ent_remove", "addressmap_address_should_automap", "strmap_iter_init", "address_is_in_virtual_range", "strmap_iter_next_rmv", "strmap_iter_next", "strmap_iter_done"]}, {"name": "fp_pair_map_impl_HT_INIT", "calls": []}, {"name": "directory_handle_command", "calls": ["get_options", "directory_handle_command_get", "safe_str", "tor_assertion_failed_", "escaped", "directory_handle_command_post", "http_set_address_origin", "log_fn_", "connection_fetch_from_buf_http"]}, {"name": "dirserv_have_any_serverdesc", "calls": ["get_signed_descriptor_by_fp", "extrainfo_get_by_descriptor_digest", "router_get_by_descriptor_digest"]}, {"name": "policy_summary_item_split", "calls": ["tor_malloc_zero_", "tor_assertion_failed_"]}, {"name": "node_exit_policy_rejects_all", "calls": ["short_policy_is_reject_star"]}, {"name": "addr_policy_list_free", "calls": ["smartlist_free", "addr_policy_free"]}, {"name": "or_state_save", "calls": ["entry_guards_update_state", "get_options", "options_get_datadir_fname2_suffix", "circuit_build_times_update_state", "format_local_iso_time", "get_circuit_build_times", "get_version", "rep_hist_update_state", "write_str_to_file", "accounting_is_enabled", "accounting_run_housekeeping", "server_mode", "tor_asprintf", "tor_assertion_failed_", "log_fn_"]}, {"name": "networkstatus_compute_bw_weights_v10", "calls": ["networkstatus_check_weights", "tor_assertion_failed_", "smartlist_add_asprintf", "log_fn_"]}, {"name": "initiate_descriptor_downloads", "calls": ["smartlist_free", "base16_encode", "smartlist_add", "directory_get_from_dirserver", "directory_initiate_command_routerstatus", "digest256_to_base64", "smartlist_join_strings", "tor_asprintf", "tor_malloc_", "smartlist_new"]}, {"name": "send_control_event_impl", "calls": ["tor_vasprintf", "queue_control_event_string", "log_fn_"]}, {"name": "pathbias_measure_use_rate", "calls": ["get_circuit_build_close_time_ms", "get_options", "pathbias_get_notice_use_rate", "hex_str", "pathbias_get_dropguards", "pathbias_get_extreme_use_rate", "entry_guards_changed", "pathbias_get_min_use", "pathbias_get_close_success_count", "pathbias_get_use_success_count", "approx_time", "tor_lround", "log_fn_"]}, {"name": "channel_tls_listener_close_method", "calls": ["channel_listener_change_state", "smartlist_free", "tor_assertion_failed_"]}, {"name": "microdesc_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "scan_string", "calls": ["TOR_ISSPACE"]}, {"name": "fetch_bridge_descriptors", "calls": ["get_options", "tor_digest_is_zero", "dir_server_mode", "safe_str_client", "fmt_addrport", "base16_encode", "download_status_mark_impossible", "pt_proxies_configuration_pending", "get_n_authorities", "download_status_increment_failure", "launch_direct_bridge_descriptor_fetch", "fascist_firewall_allows_address_or", "directory_get_from_dirserver", "fmt_addr_impl", "routerset_contains_bridge", "download_status_is_ready", "log_fn_"]}, {"name": "rend_client_fetch_v2_desc", "calls": ["tor_digest_is_zero", "tor_assertion_failed_", "fetch_v2_desc_by_descid", "fetch_v2_desc_by_addr"]}, {"name": "pop_first_cell_ewma", "calls": ["tor_assertion_failed_", "smartlist_pqueue_pop"]}, {"name": "tor_mutex_acquire", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "rep_hist_remove_predicted_ports", "calls": ["bitarray_set", "smartlist_del", "bitarray_is_set", "bitarray_init_zero", "bitarray_free"]}, {"name": "get_version", "calls": ["tor_strdup_", "get_short_version", "tor_asprintf"]}, {"name": "nodelist_purge", "calls": ["nodelist_map_HT_START", "nodelist_map_HT_NEXT_RMV", "nodelist_assert_ok", "node_is_usable", "nodelist_drop_node", "nodelist_map_HT_NEXT", "node_free"]}, {"name": "addressmap_register_virtual_address", "calls": ["safe_str_client", "strmap_set", "tor_assertion_failed_", "tor_malloc_zero_", "addressmap_get_virtual_address", "strmap_get", "addressmap_register", "log_fn_"]}, {"name": "eimap_free", "calls": []}, {"name": "dns_clip_ttl", "calls": []}, {"name": "replyqueue_process_cb", "calls": []}, {"name": "purge_expired_resolves", "calls": ["circuit_detach_stream", "cache_map_HT_REMOVE", "cache_map_HT_FIND", "tor_assertion_failed_", "circuit_get_by_edge_conn", "connection_free", "escaped_safe_str", "connection_edge_end", "smartlist_pqueue_pop", "log_fn_"]}, {"name": "connection_handle_write", "calls": ["tor_gettimeofday_cache_clear", "connection_handle_write_impl"]}, {"name": "buf_matches_at_pos", "calls": ["buf_pos_inc"]}, {"name": "channel_tls_process_netinfo_cell", "calls": ["get_options", "get_uint32", "connection_or_send_netinfo", "connection_or_set_canonical", "router_get_by_id_digest", "router_digest_is_trusted_dir_type", "channel_tls_to_base", "safe_str_client", "clock_skew_warning", "tor_addr_from_ipv4n", "fmt_addr_impl", "tor_addr_from_ipv6_bytes", "decode_address_from_payload", "tor_digest_is_zero", "hex_str", "tor_assertion_failed_", "connection_or_set_state_open", "channel_set_circid_type", "tor_addr_compare", "connection_or_init_conn_from_address", "tor_addr_is_null", "assert_connection_ok", "connection_or_close_for_error", "log_fn_"]}, {"name": "periodic_event_destroy", "calls": ["tor_event_free"]}, {"name": "connection_or_check_valid_tls_handshake", "calls": ["channel_tls_to_base", "get_options", "crypto_pk_free", "tor_tls_peer_has_cert", "tor_assertion_failed_", "server_mode", "crypto_pk_get_digest", "check_no_tls_errors_", "channel_set_circid_type", "safe_str_client", "connection_or_client_learned_peer_id", "tor_tls_verify", "log_fn_"]}, {"name": "geoip_bridge_stats_init", "calls": []}, {"name": "expire_old_ciruits_serverside_callback", "calls": ["circuit_expire_old_circuits_serverside"]}, {"name": "is_or_protocol_version_known", "calls": []}, {"name": "crypto_new_pk_from_rsa_", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "sdmap_get", "calls": ["digestmap_get"]}, {"name": "routerset_free", "calls": ["smartlist_free", "addr_policy_free", "bitarray_free"]}, {"name": "tor_tls_get_buffer_sizes", "calls": []}, {"name": "aes_crypt_inplace", "calls": ["tor_assertion_failed_"]}, {"name": "alloc_getcwd", "calls": ["tor_malloc_", "tor_realloc_"]}, {"name": "scheduler_free_all", "calls": ["smartlist_free", "log_fn_", "tor_event_free"]}, {"name": "options_act", "calls": ["crypto_digest256", "sweep_bridge_list", "rep_hist_exit_stats_term", "networkstatus_get_latest_consensus", "directory_fetches_dir_info_later", "should_record_bridge_info", "sandbox_is_active", "parse_virtual_addr_network", "policies_parse_from_options", "inform_testing_reachability", "cpu_init", "cell_ewma_enabled", "routerset_equal", "or_state_loaded", "rep_hist_desc_stats_term", "configure_accounting", "rep_hist_hs_stats_term", "mark_bridge_list", "try_locking", "have_completed_a_circuit", "dirvote_recalculate_timing", "accounting_is_enabled", "pt_configure_remaining_proxies", "geoip_dirreq_stats_term", "get_connection_array", "router_initialize_tls_context", "tor_disable_debugger_attach", "bridge_add_from_config", "cell_ewma_set_scale_factor", "config_maybe_load_geoip_files_", "rep_hist_load_mtbf_data", "write_pidfile", "consider_adding_dir_servers", "geoip_entry_stats_term", "router_dir_info_changed", "circuit_mark_all_unused_circs", "options_transition_requires_fresh_tls_context", "geoip_dirreq_stats_init", "rep_hist_exit_stats_init", "init_control_cookie_authentication", "update_consensus_networkstatus_fetch_time", "channel_set_cmux_policy_everywhere", "geoip_entry_stats_init", "control_ports_write_to_file", "log_fn_", "rep_hist_conn_stats_init", "addressmap_clear_invalid_automaps", "accounting_parse_options", "monitor_owning_controller_process", "config_lines_eq", "read_file_to_str", "mark_my_descriptor_dirty", "directory_fetches_dir_info_early", "rep_hist_hs_stats_init", "scheduler_set_watermarks", "circuit_mark_all_dirty_circs_as_unusable", "entry_nodes_should_be_added", "config_register_addressmaps", "geoip_bridge_stats_init", "cpuworkers_rotate_keyinfo", "options_transition_affects_descriptor", "tor_malloc_", "net_is_disabled", "any_predicted_circuits", "options_transition_affects_workers", "rep_hist_conn_stats_term", "addressmap_clear_excluded_trackexithosts", "sweep_transport_list", "opt_streq", "public_server_mode", "rend_config_services", "rend_service_load_all_keys", "mark_transport_list", "pt_prepare_proxy_list_for_config_read", "parse_outbound_addresses", "connection_or_update_token_buckets", "init_ext_or_cookie_authentication", "rend_parse_service_authorization", "get_options_mutable", "sweep_proxy_list", "rep_hist_buffer_stats_term", "geoip_is_loaded", "geoip_bridge_stats_term", "smartlist_strings_eq", "init_keys", "server_mode", "authdir_mode_v3", "ip_address_changed", "alloc_http_authenticator", "finish_daemon", "parse_transport_line", "rep_hist_desc_stats_init", "pt_proxies_configuration_pending", "dns_reset", "parse_bridge_line", "routerset_add_unknown_ccs", "have_lockfile", "rep_hist_buffer_stats_init", "or_state_load"]}, {"name": "dirserv_single_reachability_test", "calls": ["get_options", "command_setup_channel", "tor_addr_is_null", "tor_assertion_failed_", "tor_addr_to_str", "node_get_mutable_by_id", "tor_addr_from_ipv4n", "log_fn_", "fmt_addr32", "channel_tls_connect"]}, {"name": "rep_hist_note_router_unreachable", "calls": ["hex_str", "format_local_iso_time", "tor_assertion_failed_", "get_or_history", "log_fn_"]}, {"name": "switch_logs_debug", "calls": ["get_min_log_level", "tor_mutex_release", "tor_mutex_acquire"]}, {"name": "crypto_strongest_rand_raw", "calls": ["crypto_strongest_rand_syscall", "tor_assertion_failed_", "memwipe", "tor_mem_is_zero", "crypto_strongest_rand_fallback", "log_fn_"]}, {"name": "router_get_routerlist", "calls": ["tor_malloc_zero_", "sdmap_new", "rimap_new", "eimap_new", "smartlist_new"]}, {"name": "pathbias_count_use_attempt", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "hex_str", "pathbias_state_to_string", "circuit_state_to_string", "entry_guards_changed", "pathbias_scale_use_rates", "circuit_purpose_to_string", "pathbias_measure_use_rate", "log_fn_"]}, {"name": "connection_is_writing", "calls": ["tor_assertion_failed_"]}, {"name": "rend_service_load_keys", "calls": ["get_options", "rend_service_load_auth_keys", "strlcpy", "tor_snprintf", "rend_service_derive_key_digests", "write_str_to_file", "init_key_from_file", "memwipe", "check_private_dir", "strlcat", "log_fn_"]}, {"name": "circuit_has_opened", "calls": ["connection_ap_attach_pending", "rend_service_intro_has_opened", "rend_service_rendezvous_has_opened", "rend_client_rendcirc_has_opened", "circuit_testing_opened", "rend_client_introcirc_has_opened", "circuit_try_attaching_streams", "control_event_circuit_status"]}, {"name": "log_free", "calls": []}, {"name": "routerstatus_free", "calls": []}, {"name": "entry_guards_parse_state", "calls": ["get_options", "smartlist_free", "digestmap_new", "escaped", "tor_version_as_new_as", "pathbias_get_extreme_rate", "digestmap_set", "remove_obsolete_entry_guards", "smartlist_split_string", "strlcpy", "tor_strdup_", "pathbias_get_dropguards", "digestmap_get", "crypto_rand_time_range", "parse_iso_time", "hex_str", "smartlist_add", "update_node_guard_status", "tor_malloc_zero_", "is_legal_nickname", "entry_guard_free", "pathbias_get_extreme_use_rate", "pathbias_get_close_success_count", "tor_sscanf", "parse_iso_time_", "pathbias_get_use_success_count", "base16_decode", "smartlist_new", "log_fn_"]}, {"name": "circuit_enough_testing_circs", "calls": ["circuit_get_global_list"]}, {"name": "dirvote_fetch_missing_signatures", "calls": ["networkstatus_check_consensus_signature", "directory_get_from_all_authorities"]}, {"name": "path_is_relative", "calls": []}, {"name": "pt_prepare_proxy_list_for_config_read", "calls": ["smartlist_clear", "tor_assertion_failed_", "managed_proxy_destroy", "assert_unconfigured_count_ok", "smartlist_del"]}, {"name": "get_interface_address6", "calls": ["free_interface_address6_list", "tor_addr_copy", "tor_assertion_failed_", "tor_addr_is_internal_", "get_interface_address6_list"]}, {"name": "connection_dirserv_flushed_some", "calls": ["connection_dirserv_add_microdescs_to_outbuf", "tor_assertion_failed_", "connection_get_outbuf_len", "connection_dirserv_add_dir_bytes_to_outbuf", "connection_dirserv_add_networkstatus_bytes_to_outbuf", "connection_dirserv_add_servers_to_outbuf"]}, {"name": "parse_proxy_error", "calls": ["log_fn_"]}, {"name": "get_signed_descriptor_by_fp", "calls": ["router_get_my_routerinfo", "router_digest_is_me", "router_get_by_id_digest", "extrainfo_get_by_descriptor_digest", "router_get_my_extrainfo"]}, {"name": "chan_circid_map_HT_REMOVE", "calls": ["chan_circid_entry_hash_", "chan_circid_map_HT_FIND_P_"]}, {"name": "channel_is_better", "calls": ["tor_assertion_failed_", "channel_when_created", "channel_num_circuits"]}, {"name": "tor_snprintf", "calls": ["tor_vsnprintf"]}, {"name": "pathbias_get_min_use", "calls": ["networkstatus_get_param"]}, {"name": "connection_dir_is_encrypted", "calls": []}, {"name": "pathbias_get_extreme_rate", "calls": ["networkstatus_get_param"]}, {"name": "circuit_get_unhandled_ports", "calls": ["circuit_remove_handled_ports", "rep_hist_get_predicted_ports"]}, {"name": "routerlist_reset_warnings", "calls": ["networkstatus_reset_warnings", "smartlist_clear", "smartlist_new"]}, {"name": "find_intro_point", "calls": ["tor_assertion_failed_", "crypto_pk_eq_keys", "tor_memeq"]}, {"name": "crypto_pk_dup_key", "calls": ["tor_assertion_failed_"]}, {"name": "sweep_proxy_list", "calls": ["smartlist_del", "managed_proxy_destroy", "assert_unconfigured_count_ok"]}, {"name": "tor_addr_make_null", "calls": []}, {"name": "connection_or_notify_error", "calls": ["channel_tls_to_base", "tor_assertion_failed_", "channel_is_in_state", "channel_close_for_error", "connection_or_connect_failed"]}, {"name": "microdesc_map_HT_FIND_P_", "calls": ["microdesc_eq_"]}, {"name": "circuitmux_mark_destroyed_circids_usable", "calls": ["packed_cell_is_destroy", "channel_mark_circid_usable", "log_fn_"]}, {"name": "init_dh_param", "calls": ["tor_assertion_failed_", "crypto_set_tls_dh_prime"]}, {"name": "init_keys_common", "calls": ["get_options", "tor_mutex_new", "crypto_global_init", "log_fn_"]}, {"name": "decode_hashed_passwords", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_add", "strcmpstart", "base64_decode", "tor_memdup_", "base16_decode", "smartlist_new"]}, {"name": "rend_hsaddress_str_or_unknown", "calls": []}, {"name": "control_event_logmsg", "calls": ["in_main_thread", "tor_strdup_", "control_event_general_status", "esc_for_log", "send_control_event", "log_severity_to_event", "queued_events_flush_all"]}, {"name": "circuit_set_circid_chan_helper", "calls": ["chan_circid_map_HT_REMOVE", "tor_assertion_failed_", "chan_circid_map_HT_FIND", "TO_OR_CIRCUIT", "chan_circid_map_HT_INSERT", "update_circuit_on_cmux_", "tor_malloc_zero_"]}, {"name": "rend_cmp_service_ids", "calls": []}, {"name": "add_callback_log", "calls": ["tor_mutex_acquire", "tor_strdup_", "tor_mutex_release", "tor_memdup_", "tor_malloc_zero_", "get_min_log_level"]}, {"name": "control_event_address_mapped", "calls": ["format_local_iso_time", "send_control_event", "format_iso_time"]}, {"name": "crypto_pk_private_hybrid_decrypt", "calls": ["crypto_pk_keysize", "crypto_cipher_new", "crypto_cipher_free", "tor_assertion_failed_", "crypto_cipher_decrypt", "memwipe", "tor_malloc_", "crypto_pk_private_decrypt", "log_fn_"]}, {"name": "control_event_circuit_status", "calls": ["circuit_end_reason_to_control_string", "tor_snprintf", "tor_assertion_failed_", "send_control_event", "circuit_describe_status_for_controller", "log_fn_"]}, {"name": "decode_address_from_payload", "calls": ["get_uint32", "tor_addr_make_unspec", "tor_addr_from_ipv4n", "tor_addr_from_ipv6_bytes"]}, {"name": "rep_hist_update_bwhist_state_section", "calls": ["get_options", "smartlist_free", "or_state_mark_dirty", "smartlist_add_asprintf", "server_mode", "smartlist_new"]}, {"name": "options_init", "calls": ["config_init"]}, {"name": "check_for_reachability_bw_callback", "calls": ["router_get_my_routerinfo", "server_mode", "consider_testing_reachability", "we_are_hibernating", "any_predicted_circuits", "reset_bandwidth_test", "have_completed_a_circuit"]}, {"name": "check_dns_honesty_callback", "calls": ["crypto_rand_int_range", "public_server_mode", "router_my_exit_policy_is_reject_star", "net_is_disabled", "dns_launch_correctness_checks", "crypto_rand_int"]}, {"name": "entry_guards_compute_status", "calls": ["log_entry_guards", "hex_str", "digestmap_set", "entry_guards_changed", "digestmap_new", "entry_is_live", "digestmap_get", "tor_assertion_failed_", "entry_guard_set_status", "remove_dead_entry_guards", "remove_obsolete_entry_guards", "num_live_entry_guards", "node_get_by_id", "entry_nodes_should_be_added", "log_fn_"]}, {"name": "control_event_or_authdir_new_descriptor", "calls": ["strlcpy", "write_escaped_data", "tor_snprintf", "tor_malloc_", "send_control_event_string"]}, {"name": "touch_file", "calls": []}, {"name": "firewall_is_fascist_or", "calls": []}, {"name": "rep_hist_note_exit_bytes", "calls": ["log_fn_"]}, {"name": "addr_policy_append_reject_addr_list_filter", "calls": ["tor_assertion_failed_", "addr_policy_append_reject_addr_filter"]}, {"name": "extract_escaped_string", "calls": ["tor_strndup_", "get_escaped_string_length"]}, {"name": "tor_addr_make_af_unix", "calls": []}, {"name": "circuit_cpath_supports_ntor", "calls": ["tor_mem_is_zero"]}, {"name": "channel_idmap_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "crypto_rand_uint64", "calls": ["crypto_rand", "tor_assertion_failed_"]}, {"name": "clear_trackexithost_mappings", "calls": ["strmap_iter_get", "tor_asprintf", "addressmap_ent_remove", "strmap_iter_init", "strmap_iter_done", "tor_strlower", "strcmpend", "strmap_iter_next_rmv", "strmap_iter_next"]}, {"name": "control_event_hs_descriptor_upload", "calls": ["send_control_event", "node_describe_longname_by_id", "log_fn_"]}, {"name": "circuit_build_times_create_histogram", "calls": ["circuit_build_times_max", "tor_calloc_"]}, {"name": "channel_tls_matches_target_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_", "tor_addr_compare", "log_fn_"]}, {"name": "add_wildcarded_test_address", "calls": ["get_options", "tor_strdup_", "tor_log", "smartlist_add", "mark_my_descriptor_dirty", "smartlist_contains_string_case", "control_event_server_status", "smartlist_new"]}, {"name": "rimap_to_digestmap", "calls": []}, {"name": "write_http_response_header", "calls": ["write_http_response_header_impl"]}, {"name": "crypto_pk_private_decrypt", "calls": ["crypto_pk_keysize", "crypto_log_errors", "tor_assertion_failed_", "crypto_get_rsa_padding"]}, {"name": "sb_getsockopt", "calls": []}, {"name": "circuit_set_intro_point_digest", "calls": ["circuit_set_rend_token"]}, {"name": "digestmap_assert_ok", "calls": ["tor_assertion_failed_", "digestmap_impl_HT_REP_IS_BAD_"]}, {"name": "channel_listener_state_can_transition", "calls": []}, {"name": "rsamap_HT_FIND_P_", "calls": ["keypin_ents_eq_rsa"]}, {"name": "body_is_plausible", "calls": ["TOR_ISPRINT", "strcmpstart", "TOR_ISSPACE"]}, {"name": "should_rebuild_md_cache", "calls": []}, {"name": "connection_free_", "calls": ["tor_digest_is_zero", "smartlist_free", "TO_DIR_CONN", "conn_state_to_string", "conn_type_to_string", "TO_LISTENER_CONN", "cached_dir_decref", "socks_request_free", "connection_get_outbuf_len", "buf_free", "TO_OR_CONN", "connection_or_remove_from_ext_or_id_map", "connection_or_remove_from_identity_map", "rend_data_free", "channel_is_in_state", "tor_close_socket", "tor_tls_free", "tor_event_free", "TO_EDGE_CONN", "connection_is_listener", "channel_tls_to_base", "or_handshake_state_free", "tor_assertion_failed_", "connection_get_inbuf_len", "TO_ENTRY_CONN", "TO_CONTROL_CONN", "conn_listener_type_supports_af_unix", "channel_close_for_error", "memwipe", "tor_zlib_free", "log_fn_"]}, {"name": "router_has_orport", "calls": ["tor_addr_compare", "tor_addr_eq_ipv4h"]}, {"name": "router_add_to_routerlist", "calls": ["get_options", "authdir_mode_handles_descs", "safe_str_client", "signed_desc_digest_is_recognized", "directory_caches_dir_info", "routerlist_insert_old", "approx_time", "authdir_wants_to_reject_router", "tor_assertion_failed_", "authdir_mode_bridge", "routerinfo_free", "sdmap_get", "routerinfo_is_a_configured_bridge", "routerlist_replace", "signed_desc_append_to_journal", "tor_memeq", "networkstatus_get_latest_consensus_by_flavor", "router_get_routerlist", "networkstatus_vote_find_mutable_entry", "router_describe", "routerlist_insert", "router_descriptor_is_older_than", "router_get_mutable_by_digest", "log_fn_"]}, {"name": "launch_resolve", "calls": ["get_options", "launch_one_resolve", "tor_addr_parse_PTR_name", "configure_nameservers", "tor_assertion_failed_", "escaped_safe_str", "log_fn_"]}, {"name": "base64_decode", "calls": ["tor_assertion_failed_"]}, {"name": "connection_bucket_write_limit", "calls": ["TO_OR_CONN", "connection_is_rate_limited", "connection_bucket_round_robin", "connection_counts_as_relayed_traffic", "get_cell_network_size"]}, {"name": "evdns_wildcard_check_callback", "calls": ["tor_log", "tor_inet_ntoa", "strmap_size", "wildcard_increment_answer", "tor_inet_ntop"]}, {"name": "nodelist_set_consensus", "calls": ["get_options", "microdesc_cache_lookup_by_digest256", "init_nodelist", "get_microdesc_cache", "tor_assertion_failed_", "node_set_country", "authdir_mode_v3", "nodelist_purge", "node_get_or_create", "server_mode", "tor_addr_is_null", "tor_memeq"]}, {"name": "dimap_search", "calls": ["tor_memeq"]}, {"name": "tor_tls_context_decref", "calls": ["tor_x509_cert_free", "crypto_pk_free", "tor_assertion_failed_"]}, {"name": "hid_serv_acting_as_directory", "calls": ["router_get_my_routerinfo"]}, {"name": "buf_copy", "calls": ["chunk_copy", "buf_new"]}, {"name": "sb_accept4", "calls": []}, {"name": "connection_dir_reached_eof", "calls": ["connection_close_immediate", "log_fn_", "connection_mark_for_close_", "connection_dir_client_reached_eof"]}, {"name": "policies_parse_exit_policy_from_options", "calls": ["smartlist_free", "policies_copy_addr_to_smartlist", "append_exit_policy_string", "policies_parse_exit_policy", "policies_copy_ipv4h_to_smartlist", "policies_copy_outbound_addresses_to_smartlist", "smartlist_new"]}, {"name": "scheduler_release_channel", "calls": ["smartlist_pqueue_remove", "tor_assertion_failed_"]}, {"name": "set_socket_nonblocking", "calls": ["log_fn_"]}, {"name": "smartlist_contains_string", "calls": []}, {"name": "tor_zlib_process", "calls": ["is_compression_bomb", "tor_assertion_failed_", "log_fn_"]}, {"name": "strmap_impl_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "download_status_get_next_attempt_at", "calls": []}, {"name": "connection_dir_get_by_purpose_and_resource", "calls": ["connection_dir_list_by_purpose_and_resource", "smartlist_free"]}, {"name": "begin_cell_parse", "calls": ["get_options", "get_uint32", "relay_header_unpack", "tor_addr_port_split", "log_fn_"]}, {"name": "channel_mark_bad_for_new_circs", "calls": ["tor_assertion_failed_"]}, {"name": "dirserv_has_measured_bw", "calls": ["dirserv_query_measured_bw_cache_kb"]}, {"name": "dirvote_compute_params", "calls": ["smartlist_free", "median_int32", "tor_snprintf", "smartlist_add", "smartlist_sort_strings", "tor_assertion_failed_", "smartlist_add_all", "tor_malloc_", "tor_calloc_", "smartlist_join_strings", "smartlist_new", "tor_parse_long"]}, {"name": "geoip_get_country_by_ipv6", "calls": ["smartlist_bsearch"]}, {"name": "trusted_dirs_remove_old_certs", "calls": ["digestmap_iter_next", "smartlist_del_keeporder", "digestmap_iter_get", "authority_cert_free", "smartlist_sort", "digestmap_iter_done", "trusted_dirs_flush_certs_to_disk", "digestmap_iter_init"]}, {"name": "tor_free_", "calls": []}, {"name": "connection_get_by_type_addr_port_purpose", "calls": ["get_connection_array", "tor_addr_compare"]}, {"name": "rend_encode_v2_descriptors", "calls": ["get_time_period", "get_seconds_valid", "crypto_pk_write_public_key_to_string", "rend_desc_v2_is_parsable", "rend_cache_store_v2_desc_as_service", "base64_encode", "strlcpy", "rend_get_descriptor_id_bytes", "control_event_hs_descriptor_created", "router_append_dirobj_signature", "rend_encoded_v2_service_descriptor_free", "rend_encode_v2_intro_points", "tor_snprintf", "smartlist_add", "tor_assertion_failed_", "tor_malloc_zero_", "crypto_digest", "smartlist_clear", "get_secret_id_part_bytes", "base32_encode", "format_iso_time", "crypto_pk_get_digest", "rend_encrypt_v2_intro_points_basic", "tor_calloc_", "rend_encrypt_v2_intro_points_stealth", "log_fn_"]}, {"name": "server_onion_keys_free", "calls": ["memwipe", "ntor_key_map_free", "crypto_pk_free"]}, {"name": "or_circuit_new", "calls": ["cell_queue_init", "init_circuit_base", "circuit_set_p_circid_chan", "tor_malloc_zero_"]}, {"name": "strcmpstart", "calls": []}, {"name": "authdir_mode_publishes_statuses", "calls": ["authdir_mode_any_nonhidserv", "authdir_mode_bridge"]}, {"name": "geoip_get_country_by_ipv4", "calls": ["smartlist_bsearch"]}, {"name": "find_opt_by_keyword", "calls": []}, {"name": "clean_name_for_stat", "calls": []}, {"name": "router_supports_extrainfo", "calls": ["node_get_by_id"]}, {"name": "routers_have_same_or_addrs", "calls": ["tor_addr_compare"]}, {"name": "circuit_all_predicted_ports_handled", "calls": ["get_options", "smartlist_free", "tor_assertion_failed_", "circuit_get_unhandled_ports", "smartlist_contains_int_as_string"]}, {"name": "strmap_get", "calls": ["strmap_assign_tmp_key", "strmap_impl_HT_FIND", "tor_assertion_failed_"]}, {"name": "control_event_hs_descriptor_created", "calls": ["send_control_event", "log_fn_"]}, {"name": "crypto_cipher_decrypt", "calls": ["aes_crypt", "tor_assertion_failed_"]}, {"name": "channel_tls_num_bytes_queued_method", "calls": ["channel_tls_from_base", "connection_get_outbuf_len", "tor_assertion_failed_"]}, {"name": "rend_cache_failure_clean", "calls": ["strmap_iter_get", "rend_cache_failure_entry_free", "digestmap_iter_next", "rend_cache_failure_intro_entry_free", "digestmap_iter_get", "strmap_iter_init", "digestmap_isempty", "digestmap_iter_done", "digestmap_iter_next_rmv", "strmap_iter_done", "digestmap_iter_init", "strmap_iter_next_rmv", "strmap_iter_next"]}, {"name": "pt_configure_remaining_proxies", "calls": ["smartlist_free", "proxy_configuration_finished", "tor_assertion_failed_", "assert_unconfigured_count_ok", "smartlist_add_all", "proxy_prepare_for_restart", "configure_proxy", "mark_my_descriptor_dirty", "proxy_needs_restart", "smartlist_new", "log_fn_"]}, {"name": "assert_cpath_ok", "calls": ["assert_cpath_layer_ok", "tor_assertion_failed_"]}, {"name": "policies_set_node_exitpolicy_to_reject_all", "calls": []}, {"name": "dns_cache_entry_count", "calls": []}, {"name": "dirvote_add_vote", "calls": ["networkstatus_vote_free", "cached_dir_decref", "networkstatus_parse_vote_from_string", "trusteddirserver_get_by_v3_auth_digest", "authority_cert_get_by_digests", "get_voter", "tor_strndup_", "strcmpstart", "trusted_dirs_load_certs_from_string", "hex_str", "smartlist_add", "tor_assertion_failed_", "tor_malloc_zero_", "update_consensus_router_descriptor_downloads", "new_cached_dir", "format_iso_time", "list_v3_auth_ids", "smartlist_new", "log_fn_"]}, {"name": "networkstatus_consensus_has_excess_connections", "calls": ["connection_dir_count_by_purpose_and_resource", "networkstatus_get_flavor_name", "usable_consensus_flavor"]}, {"name": "find_whitespace", "calls": []}, {"name": "TO_EWMA_POL_DATA", "calls": ["tor_assertion_failed_"]}, {"name": "routerstatus_describe", "calls": ["routerstatus_get_description"]}, {"name": "ed25519_public_to_base64", "calls": ["digest256_to_base64"]}, {"name": "scheduler_update_queue_heuristic", "calls": ["log_fn_"]}, {"name": "ed25519_signature_from_base64", "calls": ["base64_decode"]}, {"name": "get_configured_bridge_by_addr_port_digest", "calls": ["tor_digest_is_zero", "tor_addr_compare", "tor_memeq"]}, {"name": "node_get_verbose_nickname", "calls": ["node_is_named", "node_get_nickname", "strlcpy", "base16_encode"]}, {"name": "dirreqmap_HT_INIT", "calls": []}, {"name": "rimap_set", "calls": ["digestmap_set"]}, {"name": "connection_ap_about_to_close", "calls": ["circuit_detach_stream", "connection_ap_warn_and_unmark_if_pending_circ", "control_event_stream_bandwidth", "smartlist_remove", "connection_edge_about_to_close", "circuit_get_by_edge_conn", "dnsserv_reject_request", "control_event_stream_status", "log_fn_"]}, {"name": "circuit_build_times_set_timeout_worker", "calls": ["circuit_build_times_initial_timeout", "circuit_build_times_close_quantile", "circuit_build_times_calculate_timeout", "circuit_build_times_enough_to_compute", "circuit_build_times_max", "circuit_build_times_quantile_cutoff", "circuit_build_times_update_alpha", "log_fn_"]}, {"name": "connection_edge_update_circuit_isolation", "calls": ["memeq_opt", "tor_addr_compare", "tor_addr_copy", "tor_strdup_", "tor_memdup_", "log_fn_"]}, {"name": "connection_watch_events", "calls": ["connection_start_writing", "connection_stop_reading", "connection_start_reading", "connection_stop_writing"]}, {"name": "eimap_iter_next", "calls": ["digestmap_iter_next"]}, {"name": "getaddrinfo_cache_HT_REP_IS_BAD_", "calls": ["cached_getaddrinfo_item_hash"]}, {"name": "connection_ext_or_handle_cmd_transport", "calls": ["get_options", "tor_memdup_nulterm_", "string_is_C_identifier", "log_fn_"]}, {"name": "rend_data_service_create", "calls": ["tor_assertion_failed_", "tor_malloc_zero_", "strlcpy", "smartlist_new"]}, {"name": "digestmap_impl_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "consider_adding_dir_servers", "calls": ["clear_dir_servers", "tor_assertion_failed_", "config_lines_eq", "router_get_trusted_dir_servers", "add_default_trusted_dir_authorities", "parse_dir_fallback_line", "router_get_fallback_dir_servers", "parse_dir_authority_line", "add_default_fallback_dir_servers"]}, {"name": "crypto_pk_write_key_to_string_impl", "calls": ["tor_assertion_failed_", "crypto_log_errors", "tor_malloc_"]}, {"name": "circuit_free_all", "calls": ["circuit_free", "connection_free", "tor_assertion_failed_", "TO_OR_CIRCUIT", "smartlist_free", "chan_circid_map_HT_START", "circuit_get_global_list", "smartlist_del", "chan_circid_map_HT_CLEAR", "chan_circid_map_HT_NEXT_RMV"]}, {"name": "circuit_id_in_use_on_channel", "calls": ["circuit_get_by_circid_channel_impl"]}, {"name": "node_allows_single_hop_exits", "calls": []}, {"name": "get_possible_sybil_list", "calls": ["get_options", "router_addr_is_trusted_dir", "smartlist_free", "smartlist_sort", "digestmap_new", "smartlist_add_all", "digestmap_set", "smartlist_new"]}, {"name": "spawn_func", "calls": ["tor_malloc_", "tor_threads_init"]}, {"name": "channel_connect", "calls": ["channel_tls_connect"]}, {"name": "connected_cell_parse", "calls": ["get_uint32", "tor_addr_make_unspec", "tor_addr_from_ipv4n", "tor_addr_from_ipv6_bytes"]}, {"name": "release_lockfile", "calls": ["tor_lockfile_unlock"]}, {"name": "accounting_record_bandwidth_usage", "calls": ["get_options", "or_state_mark_dirty"]}, {"name": "router_is_me", "calls": ["router_digest_is_me"]}, {"name": "connection_dirserv_add_dir_bytes_to_outbuf", "calls": ["cached_dir_decref", "tor_assertion_failed_", "connection_dirserv_finish_spooling", "connection_write_to_buf", "connection_get_outbuf_len", "connection_write_to_buf_zlib"]}, {"name": "managed_proxy_destroy", "calls": ["smartlist_free", "smartlist_remove", "free_execve_args", "tor_process_handle_destroy", "transport_free"]}, {"name": "connection_ap_get_begincell_flags", "calls": ["node_get_by_id", "tor_addr_make_null", "compare_tor_addr_to_node_policy", "log_fn_"]}, {"name": "secret_to_key_make_specifier", "calls": ["make_specifier", "secret_to_key_spec_len"]}, {"name": "circuit_build_needed_circs", "calls": ["get_options", "circuit_expire_old_circs_as_needed", "circuit_predict_and_launch_new", "connection_ap_rescan_and_attach_pending", "rend_consider_services_intro_points", "router_have_consensus_path"]}, {"name": "channel_is_local", "calls": ["tor_assertion_failed_"]}, {"name": "rend_cache_lookup_entry", "calls": ["tor_assertion_failed_", "tor_snprintf", "strmap_get_lc", "log_fn_", "rend_valid_service_id"]}, {"name": "microdesc_cache_lookup_by_digest256", "calls": ["get_microdesc_cache", "microdesc_map_HT_FIND"]}, {"name": "dirvote_get_vote", "calls": ["get_voter", "get_my_v3_authority_cert"]}, {"name": "retry_listeners_callback", "calls": ["net_is_disabled", "retry_all_listeners"]}, {"name": "load_downloaded_routers", "calls": ["router_purpose_to_string", "tor_snprintf", "tor_assertion_failed_", "format_iso_time", "escaped", "control_event_bootstrap", "router_load_routers_from_string", "count_loading_descriptors_progress"]}, {"name": "parse_openssl_version_str", "calls": ["tor_strndup_", "strcmpstart", "tor_strdup_"]}, {"name": "connection_ap_process_end_not_open", "calls": ["get_options", "get_uint32", "tor_addr_make_unspec", "tor_addr_family", "policies_set_node_exitpolicy_to_reject_all", "strlcpy", "safe_str", "node_get_mutable_by_id", "tor_addr_from_ipv4n", "stream_end_reason_to_string", "client_dns_incr_failures", "tor_addr_from_ipv6_bytes", "tor_addr_is_null", "client_dns_set_addressmap", "tor_addr_is_internal_", "adjust_exit_policy_from_exitpolicy_failure", "connection_mark_unattached_ap_", "connection_ap_detach_retriable", "client_dns_clear_failures", "control_event_stream_status", "connection_edge_is_rendezvous_stream", "pathbias_mark_use_success", "tor_addr_to_str", "circuit_log_path", "mark_circuit_unusable_for_new_conns", "edge_reason_is_retriable", "log_fn_"]}, {"name": "crypto_pk_get_digest", "calls": ["crypto_digest"]}, {"name": "we_are_hibernating", "calls": []}, {"name": "geoip_get_request_history", "calls": ["smartlist_free", "strlcpy", "smartlist_add", "smartlist_sort", "smartlist_add_asprintf", "tor_malloc_zero_", "smartlist_join_strings", "round_to_next_multiple_of", "smartlist_new"]}, {"name": "process_map_entries_eq_", "calls": []}, {"name": "tor_listdir", "calls": ["tor_strdup_", "smartlist_add", "sandbox_intern_string", "smartlist_new"]}, {"name": "dirvote_get_start_of_next_interval", "calls": ["tor_timegm", "tor_gmtime_r", "log_fn_"]}, {"name": "clientmap_entry_free", "calls": []}, {"name": "correct_time", "calls": []}, {"name": "clear_cached_dir", "calls": []}, {"name": "bridge_line_free", "calls": ["smartlist_free"]}, {"name": "circuit_set_n_circid_chan", "calls": ["approx_time", "channel_mark_circid_unusable", "tor_assertion_failed_", "circuit_set_circid_chan_helper"]}, {"name": "circuit_build_times_close_quantile", "calls": ["get_options", "networkstatus_get_param", "circuit_build_times_quantile_cutoff", "tor_lround", "log_fn_"]}, {"name": "connection_ext_or_transition", "calls": ["tor_assertion_failed_", "control_event_or_conn_status", "connection_tls_start_handshake"]}, {"name": "connection_edge_send_command", "calls": ["relay_send_command_from_edge_", "EDGE_TO_ENTRY_CONN", "tor_assertion_failed_", "connection_mark_for_close_", "log_fn_", "connection_mark_unattached_ap_"]}, {"name": "circuit_predict_and_launch_new", "calls": ["rep_hist_get_predicted_internal", "get_circuit_build_times", "circuit_build_times_disabled", "log_fn_", "circuit_all_predicted_ports_handled", "router_have_consensus_path", "circuit_get_global_list", "num_rend_services", "TO_ORIGIN_CIRCUIT", "circuit_launch", "circuit_build_times_needs_circuits_now"]}, {"name": "get_my_v3_legacy_signing_key", "calls": []}, {"name": "router_guess_address_from_dir_headers", "calls": ["tor_addr_is_null", "tor_addr_to_ipv4h"]}, {"name": "flush_buf", "calls": ["flush_chunk", "tor_assertion_failed_"]}, {"name": "warn_nonlocal_controller_ports", "calls": ["smartlist_del", "port_cfg_free", "tor_addr_is_loopback", "log_fn_"]}, {"name": "getaddrinfo_cache_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "control_event_signal", "calls": ["control_event_is_interesting", "send_control_event", "log_fn_"]}, {"name": "digest256map_entry_hash", "calls": []}, {"name": "router_pick_directory_server_impl", "calls": ["get_options", "router_digest_is_me", "smartlist_free", "networkstatus_get_latest_consensus", "node_is_dir", "fascist_firewall_allows_address_dir", "smartlist_add", "smartlist_choose", "routerset_contains_routerstatus", "fascist_firewall_allows_address_or", "nodelist_get_list", "connection_get_by_type_addr_port_purpose", "node_sl_choose_by_bandwidth", "router_supports_extrainfo", "smartlist_new", "tor_addr_from_ipv4n", "router_digest_is_trusted_dir_type"]}, {"name": "connection_ext_or_process_inbuf", "calls": ["connection_fetch_ext_or_cmd_from_buf", "connection_stop_reading", "connection_ext_or_handle_cmd_useraddr", "connection_get_inbuf_len", "connection_write_ext_or_command", "connection_ext_or_auth_process_inbuf", "ext_or_cmd_free", "connection_ext_or_handle_cmd_transport", "connection_mark_for_close_", "tor_assertion_failed_", "tor_strdup_", "log_fn_"]}, {"name": "bidimap_HT_INIT", "calls": []}, {"name": "pathbias_get_scale_ratio", "calls": ["networkstatus_get_param"]}, {"name": "circuit_expire_old_circs_as_needed", "calls": ["addressmap_clean", "get_options", "proxy_mode", "circuit_reset_failure_count", "circuit_expire_old_circuits_clientside"]}, {"name": "rend_service_rendezvous_has_opened", "calls": ["onion_append_to_cpath", "base16_encode", "base32_encode", "circuit_change_purpose", "pathbias_count_use_attempt", "tor_assertion_failed_", "rend_service_get_by_pk_digest", "memwipe", "crypto_dh_free", "crypto_dh_get_public", "circuit_mark_for_close_", "relay_send_command_from_edge_", "circuit_initial_package_window", "log_fn_"]}, {"name": "nodelist_add_microdesc", "calls": ["init_nodelist", "networkstatus_get_latest_consensus_by_flavor", "node_get_mutable_by_id", "router_get_consensus_status_by_descriptor_digest"]}, {"name": "relay_set_digest", "calls": ["crypto_digest_add_bytes", "relay_header_pack", "crypto_digest_get_digest", "relay_header_unpack"]}, {"name": "bw_array_new", "calls": ["tor_malloc_zero_"]}, {"name": "digestmap_entry_hash", "calls": []}, {"name": "cache_failure_intro_dup", "calls": ["rend_cache_failure_intro_entry_new"]}, {"name": "find_all_by_keyword", "calls": ["smartlist_add", "smartlist_new"]}, {"name": "connection_or_connect", "calls": ["get_options", "fmt_addrport", "tor_addr_family", "connection_connect", "connection_or_finished_connecting", "router_digest_is_me", "connection_watch_events", "control_event_bootstrap_problem", "entry_guard_register_connect_status", "errno_to_orconn_end_reason", "tor_assertion_failed_", "server_mode", "connection_or_change_state", "find_transport_name_by_bridge_addrport", "connection_free", "control_event_or_conn_status", "or_connection_new", "connection_or_init_conn_from_address", "tor_addr_copy", "get_proxy_addrport", "connection_or_connect_failed", "log_fn_"]}, {"name": "connection_dir_get_by_purpose_resource_and_state", "calls": ["smartlist_free", "connection_dir_list_by_purpose_resource_and_state"]}, {"name": "guard_get_guardfraction_bandwidth", "calls": ["tor_lround", "tor_assertion_failed_"]}, {"name": "config_clear", "calls": ["routerset_free", "config_free_lines", "smartlist_free"]}, {"name": "rend_client_purge_state", "calls": ["rend_cache_failure_purge", "rend_cache_purge", "rend_client_cancel_descriptor_fetches", "rend_client_purge_last_hid_serv_requests"]}, {"name": "sandbox_add_addrinfo", "calls": ["sandbox_getaddrinfo", "sandbox_freeaddrinfo"]}, {"name": "channel_free_all", "calls": ["channel_listener_free_list", "channel_free_list", "smartlist_free", "channel_idmap_HT_CLEAR", "log_fn_"]}, {"name": "crypto_digest_smartlist_prefix", "calls": ["crypto_digest_free", "memwipe", "crypto_digest256_new", "crypto_digest_new", "crypto_digest_add_bytes", "crypto_digest512_new", "crypto_digest_get_digest", "log_fn_"]}, {"name": "geoip_format_dirreq_stats", "calls": ["geoip_get_request_history", "geoip_get_client_history", "round_uint32_to_next_multiple_of", "tor_assertion_failed_", "format_iso_time", "geoip_get_dirreq_history", "tor_asprintf"]}, {"name": "node_describe", "calls": ["node_get_description"]}, {"name": "prune_v2_cipher_list", "calls": ["find_cipher_by_id"]}, {"name": "digest256map_impl_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "process_handle_waitpid_cb", "calls": ["clear_waitpid_callback"]}, {"name": "crypto_digest_algorithm_get_name", "calls": []}, {"name": "chan_circid_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "rend_auth_type_to_string", "calls": []}, {"name": "circuit_consider_sending_sendme", "calls": ["relay_send_command_from_edge_", "log_fn_"]}, {"name": "get_random_virtual_addr", "calls": ["crypto_rand", "get_uint32", "tor_assertion_failed_", "tor_addr_family", "tor_addr_compare_masked", "tor_addr_to_ipv4n", "tor_addr_from_ipv4n", "set_uint32", "tor_addr_from_ipv6_bytes", "tor_addr_to_in6"]}, {"name": "compare_routerinfo_by_id_digest_", "calls": []}, {"name": "connection_edge_end", "calls": ["connection_edge_is_rendezvous_stream", "connection_edge_send_command", "tor_addr_family", "tor_addr_to_ipv4n", "circuit_get_by_edge_conn", "set_uint32", "dns_clip_ttl", "tor_addr_to_in6", "log_fn_"]}, {"name": "strmap_impl_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "cached_getaddrinfo_item_hash", "calls": []}, {"name": "geoip_db_digest", "calls": ["tor_assertion_failed_", "hex_str"]}, {"name": "rewrite_node_address_for_bridge", "calls": ["tor_addr_compare", "fmt_addrport", "tor_addr_copy", "fmt_addr32", "tor_addr_is_null", "tor_addr_family", "tor_addr_to_ipv4h", "tor_addr_from_ipv4n", "node_get_pref_orport", "log_fn_"]}, {"name": "or_state_new", "calls": ["tor_malloc_zero_", "config_init"]}, {"name": "tor_llround", "calls": []}, {"name": "entries_retry_all", "calls": ["entry_list_is_constrained", "tor_assertion_failed_", "entries_retry_helper"]}, {"name": "public_server_mode", "calls": ["server_mode"]}, {"name": "router_dump_router_to_string", "calls": ["get_options", "tor_digest_is_zero", "smartlist_free", "crypto_pk_write_public_key_to_string", "escaped", "ed25519_pubkey_eq", "ed25519_public_to_base64", "base64_encode", "router_get_dirobj_signature", "crypto_pk_eq_keys", "router_dump_exit_policy_to_string", "tor_strdup_", "smartlist_add_asprintf", "crypto_digest_smartlist", "decide_to_advertise_dirport", "smartlist_join_strings", "tor_cert_free", "tor_asprintf", "crypto_digest_smartlist_prefix", "make_ntor_onion_key_crosscert", "ed25519_signature_to_base64", "smartlist_add", "tor_assertion_failed_", "note_crypto_pk_op", "digest256_to_base64", "routerinfo_free", "router_parse_entry_from_string", "base16_encode", "tor_digest256_is_zero", "tor_dup_ip", "format_iso_time", "write_short_policy", "tor_addr_to_str", "crypto_pk_get_fingerprint", "make_tap_onion_key_crosscert", "we_are_hibernating", "tor_addr_family", "smartlist_new", "log_fn_"]}, {"name": "directory_command_should_use_begindir", "calls": ["fascist_firewall_allows_address_or", "directory_fetches_from_authorities"]}, {"name": "packed_cell_get_circid", "calls": ["get_uint16", "get_uint32"]}, {"name": "close_log", "calls": []}, {"name": "directory_get_from_hs_dir", "calls": ["strlcpy", "base32_encode", "tor_assertion_failed_", "smartlist_add", "log_fn_", "routerstatus_describe", "pick_hsdir", "control_event_hs_descriptor_requested", "tor_memdup_", "base64_encode", "escaped_safe_str_client", "directory_initiate_command_routerstatus_rend"]}, {"name": "tor_spawn_background", "calls": ["format_helper_exit_status", "set_waitpid_callback", "process_handle_new", "log_fn_"]}, {"name": "circuit_get_next_by_pk_and_purpose", "calls": ["TO_ORIGIN_CIRCUIT", "tor_assertion_failed_", "tor_memeq", "circuit_get_global_list"]}, {"name": "channel_tls_get_remote_descr_method", "calls": ["strlcpy", "tor_dup_addr", "tor_snprintf", "channel_tls_from_base", "tor_assertion_failed_"]}, {"name": "clear_bridge_list", "calls": ["smartlist_clear", "smartlist_new", "bridge_free"]}, {"name": "tor_version_is_obsolete", "calls": ["smartlist_free", "smartlist_split_string", "tor_version_same_series", "tor_assertion_failed_", "tor_version_compare", "strcmpstart", "tor_version_parse", "smartlist_new", "log_fn_"]}, {"name": "handle_control_setcircuitpurpose", "calls": ["smartlist_free", "find_element_starting_with", "circuit_change_purpose", "getargs_helper", "connection_write_str_to_buf", "connection_printf_to_buf", "circuit_purpose_from_string", "get_circ"]}, {"name": "control_event_guard", "calls": ["send_control_event", "tor_snprintf", "node_get_by_id", "node_get_verbose_nickname", "base16_encode"]}, {"name": "connection_connect_sockaddr", "calls": ["get_options", "tor_open_socket_nonblocking", "log_fn_ratelim_", "tor_close_socket", "set_constrained_socket_buffers", "connection_add_impl", "warn_too_many_conns", "make_socket_reuseable", "tor_assertion_failed_", "log_fn_"]}, {"name": "circuitmux_next_active_circ_p", "calls": ["tor_assertion_failed_", "TO_OR_CIRCUIT"]}, {"name": "digest256map_impl_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "rend_valid_descriptor_id", "calls": []}, {"name": "tor_log_mallinfo", "calls": ["tor_log"]}, {"name": "ewma_cmp_cmux", "calls": ["tor_assertion_failed_", "compare_cell_ewma_counts", "TO_EWMA_POL_DATA"]}, {"name": "assert_connection_ok", "calls": ["TO_OR_CONN", "connection_is_writing", "tor_assertion_failed_", "TO_ENTRY_CONN", "assert_buf_ok", "assert_cpath_layer_ok", "TO_EDGE_CONN"]}, {"name": "option_get_assignment", "calls": ["config_get_assigned_option"]}, {"name": "tor_tls_get_peer_cert", "calls": ["tls_log_errors", "tor_x509_cert_new"]}, {"name": "crypto_cipher_get_key", "calls": []}, {"name": "rend_cache_failure_clean_callback", "calls": ["rend_cache_failure_clean"]}, {"name": "crypto_cipher_crypt_inplace", "calls": ["aes_crypt_inplace", "tor_assertion_failed_"]}, {"name": "tor_free_all", "calls": ["teardown_periodic_events", "smartlist_free", "dirserv_free_all", "channel_tls_free_all", "connection_free_all", "escaped", "policies_free_all", "tor_getpwnam", "sandbox_free_getaddrinfo_cache", "dirvote_free_all", "rep_hist_free_all", "config_free_all", "tor_tls_free_all", "control_free_all", "entry_guards_free_all", "channel_free_all", "addressmap_free_all", "scheduler_free_all", "circuit_free_all", "geoip_free_all", "nodelist_free_all", "router_free_all", "esc_router_info", "release_lockfile", "routerlist_free_all", "pt_free_all", "ext_orport_free_all", "rend_service_authorization_free_all", "rend_cache_free_all", "connection_edge_free_all", "routerkeys_free_all", "periodic_timer_free", "logs_free_all", "or_state_free_all", "clear_pending_onions", "microdesc_free_all", "networkstatus_free_all", "memarea_clear_freelist", "dns_free_all", "rend_service_free_all"]}, {"name": "accounting_get_end_time", "calls": []}, {"name": "connection_ext_or_start_auth", "calls": ["connection_write_to_buf", "log_fn_"]}, {"name": "channel_tls_process_auth_challenge_cell", "calls": ["get_options", "connection_or_send_authenticate_cell", "connection_or_send_netinfo", "safe_str", "tor_assertion_failed_", "public_server_mode", "log_fn_", "connection_or_close_for_error"]}, {"name": "find_nth_long", "calls": ["tor_assertion_failed_"]}, {"name": "crypto_digest_smartlist", "calls": ["crypto_digest_smartlist_prefix"]}, {"name": "config_free_lines", "calls": []}, {"name": "strmap_assert_ok", "calls": ["strmap_impl_HT_REP_IS_BAD_", "tor_assertion_failed_"]}, {"name": "directory_handle_command_post", "calls": ["get_options", "dirvote_add_signatures", "write_http_response_header_impl", "dirvote_add_vote", "dirserv_add_multiple_descriptors", "tor_assertion_failed_", "connection_dir_is_encrypted", "authdir_mode_bridge", "strcmpstart", "escaped", "authdir_mode_handles_descs", "authdir_mode_v3", "WRA_WAS_OUTDATED", "write_http_status_line", "rend_cache_store_v2_desc_as_dir", "authdir_mode", "parse_http_url", "log_fn_"]}, {"name": "connection_fetch_from_buf_http", "calls": ["fetch_from_buf_http"]}, {"name": "dns_launch_wildcard_checks", "calls": ["launch_wildcard_check", "log_fn_"]}, {"name": "get_frequent_members", "calls": ["smartlist_add"]}, {"name": "round_int64_to_next_multiple_of", "calls": ["tor_assertion_failed_"]}, {"name": "sb_futex", "calls": []}, {"name": "add_temp_log", "calls": ["tor_mutex_acquire", "add_stream_log_impl", "tor_mutex_release", "tor_malloc_zero_", "set_log_severity_config"]}, {"name": "channel_tls_handle_state_change_on_orconn", "calls": ["channel_tls_to_base", "scheduler_channel_wants_writes", "channel_is_in_state", "tor_assertion_failed_", "channel_change_state", "connection_or_num_cells_writeable"]}, {"name": "connection_exit_connect_dir", "calls": ["connection_mark_for_close_", "dir_connection_new", "tor_addr_copy", "tor_strdup_", "connection_edge_send_command", "TO_OR_CIRCUIT", "tor_addr_family", "connection_close_immediate", "connection_add_impl", "connection_start_reading", "connection_free", "connection_edge_end", "connection_link_connections", "log_fn_"]}, {"name": "packed_cell_free", "calls": ["packed_cell_free_unchecked"]}, {"name": "relay_send_end_cell_from_edge", "calls": ["relay_send_command_from_edge_"]}, {"name": "evaluate_ecgroup_for_tls", "calls": []}, {"name": "entry_guards_set_from_config", "calls": ["entry_guard_get_by_id_digest", "smartlist_free", "entry_guards_changed", "smartlist_contains_digest", "smartlist_add_all", "fascist_firewall_allows_node", "smartlist_del", "routerset_contains_node", "routerset_get_all_nodes", "smartlist_shuffle", "smartlist_add", "tor_assertion_failed_", "update_node_guard_status", "decide_num_guards", "entry_guard_free", "smartlist_clear", "routerset_to_string", "add_an_entry_guard", "smartlist_new", "log_fn_"]}, {"name": "get_stability", "calls": []}, {"name": "server_mode", "calls": []}, {"name": "assert_circuit_mux_okay", "calls": ["tor_assertion_failed_", "circuitmux_assert_okay"]}, {"name": "bidimap_HT_CLEAR", "calls": ["tor_free_", "bidimap_HT_INIT"]}, {"name": "packed_cell_get_command", "calls": []}, {"name": "alloc_http_authenticator", "calls": ["base64_encode_size", "tor_malloc_", "base64_encode"]}, {"name": "rend_service_authorization_free_all", "calls": []}, {"name": "policy_map_HT_FIND", "calls": ["policy_map_HT_FIND_P_", "policy_hash"]}, {"name": "extend_info_new", "calls": ["tor_addr_copy", "crypto_pk_dup_key", "strlcpy", "tor_malloc_zero_"]}, {"name": "networkstatus_parse_detached_signatures", "calls": ["detached_get_signatures", "smartlist_free", "find_by_keyword_", "memarea_drop_all", "ns_detached_signatures_free", "tor_memdup_", "parse_iso_time", "smartlist_add", "tor_assertion_failed_", "strmap_new", "tor_malloc_zero_", "tor_memeq", "escaped", "smartlist_new", "memarea_new", "tokenize_string", "tor_mem_is_zero", "crypto_digest_algorithm_parse_name", "detached_get_digests", "base16_decode", "token_clear", "log_fn_"]}, {"name": "should_refuse_unknown_exits", "calls": ["networkstatus_get_param"]}, {"name": "compute_consensus_versions_list", "calls": ["sort_version_list", "smartlist_free", "smartlist_new", "get_frequent_members", "smartlist_join_strings"]}, {"name": "hibernate_end_time_elapsed", "calls": ["hibernate_go_dormant", "log_fn_", "format_iso_time", "accounting_run_housekeeping", "hibernate_end"]}, {"name": "set_exitconn_info_from_resolve", "calls": ["get_options", "tor_assertion_failed_", "tor_strdup_", "evdns_err_is_transient", "tor_addr_from_in6", "tor_addr_from_ipv4n", "router_compare_to_my_exit_policy"]}, {"name": "entries_known_but_down", "calls": ["entry_list_is_constrained", "tor_assertion_failed_", "entries_retry_helper"]}, {"name": "find_intro_circuit", "calls": ["tor_assertion_failed_", "tor_memeq", "circuit_get_next_by_pk_and_purpose"]}, {"name": "rep_hist_note_negotiated_link_proto", "calls": ["log_fn_"]}, {"name": "fp_pair_map_impl_HT_FIND_P_", "calls": ["fp_pair_map_entries_eq"]}, {"name": "parse_iso_time_", "calls": ["tor_timegm", "log_fn_", "tor_sscanf", "esc_for_log"]}, {"name": "circuitmux_get_policy", "calls": ["tor_assertion_failed_"]}, {"name": "cell_queue_pop", "calls": []}, {"name": "rend_cache_clean_v2_descs_as_dir", "calls": ["safe_str_client", "digestmap_iter_next", "hid_serv_responsible_for_desc_id", "base32_encode", "rend_cache_entry_allocation", "digestmap_iter_done", "digestmap_iter_next_rmv", "digestmap_iter_get", "rend_cache_entry_free", "digestmap_iter_init", "log_fn_"]}, {"name": "channel_listener_when_last_accepted", "calls": ["tor_assertion_failed_"]}, {"name": "chanid_circid_muxinfo_map_HT_NEXT_RMV", "calls": []}, {"name": "or_state_set", "calls": ["rep_hist_load_state", "config_free", "tor_assertion_failed_", "get_circuit_build_times_mutable", "entry_guards_parse_state", "circuit_build_times_parse_state", "log_fn_"]}, {"name": "get_uint32", "calls": []}, {"name": "channel_state_is_valid", "calls": []}, {"name": "orconn_target_get_name", "calls": ["tor_digest_is_zero", "base16_encode", "tor_snprintf", "tor_assertion_failed_", "node_get_by_id", "node_get_verbose_nickname"]}, {"name": "crypto_digest256", "calls": ["tor_assertion_failed_"]}, {"name": "tor_tls_session_secret_cb", "calls": ["tor_tls_classify_client_ciphers"]}, {"name": "dnsserv_launch_request", "calls": ["entry_connection_new", "tor_dup_addr", "connection_ap_mark_as_non_pending_circuit", "tor_addr_copy", "tor_strdup_", "connection_add_impl", "get_signewnym_epoch", "connection_free", "strlcpy", "connection_ap_rewrite_and_attach_if_allowed", "control_event_stream_status", "escaped_safe_str_client", "log_fn_"]}, {"name": "ed25519_seckey_read_from_file", "calls": ["crypto_read_tagged_contents_from_file"]}, {"name": "smartlist_insert", "calls": ["smartlist_add", "tor_assertion_failed_", "smartlist_ensure_capacity"]}, {"name": "tor_gethostname", "calls": []}, {"name": "generate_signing_key", "calls": ["crypto_log_errors", "start_writing_to_stdio_file", "abort_writing_to_file", "generate_key", "finish_writing_to_file", "log_fn_"]}, {"name": "transport_add", "calls": ["transport_resolve_conflicts", "smartlist_add", "tor_assertion_failed_", "smartlist_new"]}, {"name": "rend_consider_services_upload", "calls": ["get_options", "rend_service_update_descriptor", "count_established_intro_points", "upload_service_descriptor", "crypto_rand_int"]}, {"name": "choose_good_entry_server", "calls": ["get_options", "smartlist_free", "router_choose_random_node", "smartlist_add", "nodelist_add_node_and_family", "firewall_is_fascist_or", "nodelist_get_list", "fascist_firewall_allows_node", "build_state_get_exit_node", "choose_random_entry", "node_get_by_id", "smartlist_new", "get_entry_guards"]}, {"name": "router_get_fallback_dirserver_by_digest", "calls": ["tor_memeq"]}, {"name": "dirvote_get_preferred_voting_intervals", "calls": ["get_options", "tor_assertion_failed_"]}, {"name": "policy_map_HT_INSERT", "calls": ["policy_map_HT_GROW", "policy_hash"]}, {"name": "clientmap_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "smartlist_pop_last", "calls": ["tor_assertion_failed_"]}, {"name": "control_event_status", "calls": ["tor_vasprintf", "send_control_event", "tor_snprintf", "log_fn_"]}, {"name": "set_expiry", "calls": ["tor_assertion_failed_", "smartlist_new"]}, {"name": "client_dns_set_reverse_addressmap", "calls": ["client_dns_set_addressmap_impl", "tor_addr_parse", "tor_asprintf"]}, {"name": "connection_handle_write_impl", "calls": ["get_options", "flush_buf_tls", "connection_finished_connecting", "channel_notify_flushed", "connection_handle_read", "connection_close_immediate", "connection_bucket_write_limit", "flush_buf", "connection_wants_to_flush", "TO_OR_CONN", "connection_or_notify_error", "connection_consider_empty_write_buckets", "connection_is_reading", "connection_flushed_some", "buf_datalen", "circuit_get_by_edge_conn", "connection_mark_for_close_", "TO_EDGE_CONN", "approx_time", "connection_is_listener", "channel_tls_to_base", "errno_to_orconn_end_reason", "enable_control_logging", "tor_assertion_failed_", "connection_consider_empty_read_buckets", "TO_ENTRY_CONN", "connection_finished_flushing", "connection_tls_continue_handshake", "connection_state_is_connecting", "TO_ORIGIN_CIRCUIT", "connection_edge_end_errno", "connection_mark_for_close_internal_", "connection_stop_writing", "log_fn_", "connection_buckets_decrement", "tor_tls_get_n_raw_bytes", "disable_control_logging", "connection_or_close_for_error"]}, {"name": "read_to_buf_tls", "calls": ["tor_assertion_failed_", "check_no_tls_errors_", "buf_add_chunk_with_capacity", "read_to_chunk_tls", "CHUNK_REMAINING_CAPACITY"]}, {"name": "update_consensus_networkstatus_fetch_time_impl", "calls": ["get_options", "networkstatus_get_latest_consensus_by_flavor", "format_local_iso_time", "tor_assertion_failed_", "networkstatus_get_flavor_name", "directory_fetches_dir_info_later", "authdir_mode_v3", "we_want_to_fetch_flavor", "directory_fetches_dir_info_early", "crypto_rand_int", "log_fn_"]}, {"name": "chanid_circid_entries_eq", "calls": []}, {"name": "entry_guard_inc_circ_attempt_count", "calls": ["pathbias_measure_close_rate", "hex_str", "entry_guards_changed", "pathbias_scale_close_rates", "log_fn_"]}, {"name": "add_predicted_port", "calls": ["smartlist_add", "tor_malloc_"]}, {"name": "sb_setsockopt", "calls": []}, {"name": "choose_compression_level", "calls": ["have_been_under_memory_pressure"]}, {"name": "or_state_loaded", "calls": []}, {"name": "tor_gettimeofday_cached_monotonic", "calls": ["tor_gettimeofday_cached"]}, {"name": "assert_addr_policy_ok", "calls": ["tor_assertion_failed_"]}, {"name": "rend_cache_lookup_v2_desc_as_service", "calls": ["strmap_get_lc", "tor_assertion_failed_", "rend_valid_service_id"]}, {"name": "conn_write_callback", "calls": ["connection_mark_for_close_", "conn_type_to_string", "enable_control_logging", "tor_assertion_failed_", "connection_close_immediate", "assert_connection_ok", "close_closeable_connections", "connection_handle_write", "TO_EDGE_CONN", "log_fn_", "disable_control_logging"]}, {"name": "any_other_active_or_conns", "calls": ["connection_get_another_active_or_conn", "log_fn_"]}, {"name": "channel_tls_write_packed_cell_method", "calls": ["packed_cell_free", "get_cell_network_size", "channel_tls_from_base", "tor_assertion_failed_", "connection_write_to_buf", "log_fn_"]}, {"name": "errno_to_orconn_end_reason", "calls": ["log_fn_"]}, {"name": "send_ni", "calls": []}, {"name": "set_routerstatus_from_routerinfo", "calls": ["get_options", "dirserv_get_credible_bandwidth_kb", "dirserv_thinks_router_is_hs_dir", "strlcpy", "tor_addr_copy", "rep_hist_get_weighted_time_known", "tor_addr_is_null", "dirserv_set_routerstatus_testing", "dirserv_thinks_router_is_unreliable", "rep_hist_get_weighted_fractional_uptime", "router_digest_is_trusted_dir_type"]}, {"name": "circuits_handle_oom", "calls": ["get_options", "single_conn_free_bytes", "tv_to_msec", "circuit_get_global_list", "get_connection_array", "packed_cell_mem_cost", "smartlist_sort", "conn_get_buffer_age", "marked_circuit_free_cells", "marked_circuit_free_stream_bytes", "n_cells_in_circ_queues", "connection_mark_for_close_", "tor_gettimeofday_cached_monotonic", "circuit_mark_for_close_", "circuit_max_queued_item_age", "log_fn_"]}, {"name": "rend_client_receive_rendezvous", "calls": ["get_options", "onion_append_to_cpath", "circuit_try_attaching_streams", "circuit_change_purpose", "tor_assertion_failed_", "crypto_dh_compute_secret", "memwipe", "circuit_init_cpath_crypto", "tor_memeq", "crypto_dh_free", "circuit_mark_for_close_", "circuit_initial_package_window", "log_fn_"]}, {"name": "connection_get_by_global_id", "calls": ["get_connection_array"]}, {"name": "directory_initiate_command_routerstatus", "calls": ["directory_initiate_command_routerstatus_rend"]}, {"name": "sb_socket", "calls": []}, {"name": "crypto_pk_generate_key_with_bits", "calls": ["crypto_log_errors", "tor_assertion_failed_"]}, {"name": "channel_state_to_string", "calls": []}, {"name": "node_is_unreliable", "calls": []}, {"name": "networkstatus_reset_warnings", "calls": ["get_options", "we_use_microdescriptors_for_circuits", "nodelist_get_list"]}, {"name": "fp_pair_map_size", "calls": ["tor_assertion_failed_"]}, {"name": "create_unix_sockaddr", "calls": ["strlcpy", "tor_strdup_", "escaped", "tor_malloc_zero_", "log_fn_"]}, {"name": "connection_or_set_bad_connections", "calls": ["digestmap_iter_next", "connection_or_group_set_badness", "digestmap_iter_get", "digestmap_iter_done", "digestmap_iter_init", "tor_memeq"]}, {"name": "connection_or_init_conn_from_address", "calls": ["get_options", "tor_addr_compare", "connection_or_set_identity_digest", "connection_or_set_canonical", "base16_encode", "tor_addr_copy", "node_get_nickname", "channel_tls_update_marks", "connection_or_update_token_buckets_helper", "tor_malloc_", "node_get_by_id", "node_get_pref_orport", "tor_strdup_", "tor_dup_addr"]}, {"name": "policy_map_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "policy_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "networkstatus_check_consensus_signature", "calls": ["authority_cert_get_by_digests", "smartlist_free", "hex_str", "networkstatus_check_document_signature", "tor_log", "tor_assertion_failed_", "smartlist_add", "networkstatus_get_voter_by_id", "get_n_authorities", "router_get_trusted_dir_servers", "authority_cert_dl_looks_uncertain", "trusteddirserver_get_by_v3_auth_digest", "smartlist_join_strings", "smartlist_add_asprintf", "smartlist_new", "tor_memeq"]}, {"name": "pt_get_extra_info_descriptor_string", "calls": ["get_options", "smartlist_free", "router_pick_published_address", "tor_assertion_failed_", "smartlist_add_asprintf", "tor_addr_is_null", "tor_addr_from_ipv4n", "smartlist_join_strings", "fmt_addrport", "tor_asprintf", "smartlist_new"]}, {"name": "channel_when_last_client", "calls": ["tor_assertion_failed_"]}, {"name": "read_file_to_str_until_eof", "calls": ["tor_assertion_failed_", "tor_realloc_"]}, {"name": "circuit_note_clock_jumped", "calls": ["get_options", "control_event_client_status", "tor_log", "circuit_mark_all_dirty_circs_as_unusable", "reset_all_main_loop_timers", "control_event_general_status", "server_mode", "circuit_mark_all_unused_circs", "note_that_we_maybe_cant_complete_circuits"]}, {"name": "find_bridge_by_digest", "calls": ["tor_memeq"]}, {"name": "tor_tls_debug_state_callback", "calls": ["log_fn_"]}, {"name": "circuit_is_acceptable", "calls": ["get_options", "tor_digest_is_zero", "tor_addr_compare", "hexdigest_to_digest", "tor_addr_parse", "rend_cmp_service_ids", "tor_assertion_failed_", "compare_tor_addr_to_addr_policy", "connection_ap_can_use_exit", "build_state_get_exit_node", "connection_edge_compatible_with_circuit", "tor_memeq", "log_fn_"]}, {"name": "get_circ", "calls": ["tor_parse_ulong", "circuit_get_by_global_id"]}, {"name": "handle_client_auth_nonce", "calls": ["crypto_rand", "base16_encode", "crypto_hmac_sha256", "memwipe", "tor_malloc_zero_", "log_fn_"]}, {"name": "get_my_v3_authority_signing_key", "calls": []}, {"name": "conn_listener_type_supports_af_unix", "calls": []}, {"name": "connection_ap_handshake_send_begin", "calls": ["set_uint32", "mark_circuit_unusable_for_new_conns", "connection_mark_for_close_", "connection_ap_supports_optimistic_data", "tor_assertion_failed_", "connection_edge_send_command", "connection_get_inbuf_len", "connection_edge_package_raw_inbuf", "buf_datalen", "connection_ap_get_begincell_flags", "get_unique_stream_id_by_circ", "TO_ORIGIN_CIRCUIT", "tor_snprintf", "log_fn_", "control_event_stream_status", "connection_mark_unattached_ap_"]}, {"name": "memarea_alloc", "calls": ["realign_pointer", "alloc_chunk", "tor_assertion_failed_", "get_uint32"]}, {"name": "router_get_by_id_digest", "calls": ["router_get_mutable_by_digest"]}, {"name": "free_cached_resolve_", "calls": []}, {"name": "get_transport_options_for_server_proxy", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_add_asprintf", "smartlist_join_strings", "tor_escape_str_for_pt_args", "get_options_for_server_transport", "smartlist_new"]}, {"name": "circuit_max_queued_item_age", "calls": ["circuit_max_queued_cell_age", "circuit_max_queued_data_age"]}, {"name": "geoip_parse_entry", "calls": ["TOR_ISSPACE", "tor_addr_from_ipv4n", "tor_inet_pton", "geoip_add_entry", "tor_addr_from_in6", "escaped", "tor_sscanf", "init_geoip_countries", "strlcpy", "smartlist_new", "log_fn_"]}, {"name": "strlcat", "calls": []}, {"name": "connection_write_ext_or_command", "calls": ["tor_assertion_failed_", "connection_write_to_buf", "set_uint16"]}, {"name": "dircollator_n_routers", "calls": []}, {"name": "circuit_build_times_test_frequency", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "channel_timestamp_xmit", "calls": ["tor_assertion_failed_"]}, {"name": "start_of_accounting_period_after", "calls": ["edge_of_accounting_period_containing"]}, {"name": "fetch_from_buf_http", "calls": ["tor_memstr", "buf_find_string_offset", "tor_assertion_failed_", "buf_pullup", "tor_malloc_", "fetch_from_buf", "log_fn_"]}, {"name": "fp_pair_map_impl_HT_NEXT_RMV", "calls": []}, {"name": "authority_cert_dl_failed", "calls": ["get_options", "dir_server_mode", "dsmap_get", "base16_encode", "download_status_increment_failure", "digestmap_get", "log_fn_"]}, {"name": "options_get_datadir_fname2_suffix", "calls": ["strlcpy", "tor_snprintf", "tor_assertion_failed_", "tor_malloc_", "strlcat"]}, {"name": "sb_mremap", "calls": []}, {"name": "tor_tls_write", "calls": ["tor_assertion_failed_", "tor_tls_get_error", "log_fn_"]}, {"name": "log_unsafe_socks_warning", "calls": ["get_options", "log_fn_ratelim_", "control_event_client_status"]}, {"name": "tor_addr_to_sockaddr", "calls": ["tor_addr_to_ipv4n", "tor_addr_family", "tor_addr_to_in6"]}, {"name": "rend_check_authorization", "calls": ["base64_encode", "tor_assertion_failed_", "tor_memeq", "log_fn_"]}, {"name": "parse_iso_time", "calls": ["parse_iso_time_"]}, {"name": "periodic_event_set_interval", "calls": ["tor_assertion_failed_"]}, {"name": "assert_identity_keys_ok", "calls": []}, {"name": "pathbias_get_warn_rate", "calls": ["networkstatus_get_param"]}, {"name": "should_apply_guardfraction", "calls": ["get_options", "networkstatus_get_param"]}, {"name": "resolve_my_address", "calls": ["get_interface_address", "tor_inet_aton", "tor_lookup_hostname", "tor_dup_ip", "tor_addr_from_ipv4n", "tor_gethostname", "tor_addr_is_internal_", "tor_addr_to_ipv4h", "ip_address_changed", "fmt_addr_impl", "tor_assertion_failed_", "strlcpy", "control_event_server_status", "log_fn_", "fmt_addr32", "tor_strdup_", "get_interface_address6"]}, {"name": "dircollator_add_vote", "calls": ["tor_assertion_failed_", "dircollator_add_routerstatus"]}, {"name": "double_digest_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "digestmap_entries_eq", "calls": ["tor_memeq"]}, {"name": "update_consensus_bootstrap_attempt_downloads", "calls": ["usable_consensus_flavor", "networkstatus_get_flavor_name", "tor_assertion_failed_", "consensus_max_download_tries", "directory_get_from_dirserver", "download_status_increment_attempt", "download_status_is_ready", "log_fn_"]}, {"name": "TO_CONTROL_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "tor_tls_cert_is_valid", "calls": ["tls_log_errors", "check_no_tls_errors_", "check_cert_lifetime_internal"]}, {"name": "tor_ftruncate", "calls": ["tor_fd_setpos"]}, {"name": "keypin_clear", "calls": ["rsamap_HT_START", "rsamap_HT_NEXT_RMV", "rsamap_HT_CLEAR", "edmap_HT_REMOVE", "edmap_HT_CLEAR", "log_fn_"]}, {"name": "cache_map_HT_FIND_P_", "calls": ["cached_resolves_eq"]}, {"name": "rep_hist_format_exit_stats", "calls": ["smartlist_free", "round_uint32_to_next_multiple_of", "smartlist_add_asprintf", "round_uint64_to_next_multiple_of", "format_iso_time", "smartlist_join_strings", "tor_asprintf", "tor_assertion_failed_", "smartlist_new"]}, {"name": "networkstatus_format_signatures", "calls": ["smartlist_free", "base16_encode", "tor_strdup_", "smartlist_add", "networkstatus_get_flavor_name", "crypto_digest_algorithm_get_name", "smartlist_add_asprintf", "smartlist_join_strings", "base64_encode", "smartlist_new", "strlcat"]}, {"name": "crypto_pk_get_rsa_", "calls": []}, {"name": "dirserv_query_measured_bw_cache_kb", "calls": ["digestmap_get"]}, {"name": "digest256map_assert_ok", "calls": ["tor_assertion_failed_", "digest256map_impl_HT_REP_IS_BAD_"]}, {"name": "strmap_get_lc", "calls": ["tor_strdup_", "strmap_get", "tor_strlower"]}, {"name": "dirserv_would_reject_router", "calls": ["dirserv_get_status_impl"]}, {"name": "client_dns_incr_failures", "calls": ["safe_str_client", "strmap_set", "strmap_get", "tor_malloc_zero_", "log_fn_"]}, {"name": "connection_remove", "calls": ["connection_unregister_events", "conn_type_to_string", "tor_assertion_failed_", "control_event_conn_bandwidth", "smartlist_del", "log_fn_"]}, {"name": "router_dump_exit_policy_to_string", "calls": ["tor_strdup_", "policy_dump_to_string"]}, {"name": "tor_process_get_pid", "calls": []}, {"name": "evdns_log_cb", "calls": ["get_options", "tor_log", "tor_assertion_failed_", "strcmpstart", "escaped", "tor_strndup_", "control_event_server_status", "log_fn_"]}, {"name": "sev_to_string", "calls": []}, {"name": "crypto_digest_get_digest", "calls": ["crypto_digest_algorithm_get_length", "memwipe", "tor_assertion_failed_", "crypto_digest_alloc_bytes", "log_fn_"]}, {"name": "accounting_add_bytes", "calls": []}, {"name": "smartlist_free", "calls": []}, {"name": "rend_data_free", "calls": ["smartlist_free"]}, {"name": "rep_hist_reset_conn_stats", "calls": ["bidi_map_free"]}, {"name": "append_exit_policy_string", "calls": ["parse_addr_policy", "log_fn_"]}, {"name": "construct_ntor_key_map", "calls": ["tor_memdup_", "tor_mem_is_zero", "dimap_add_entry"]}, {"name": "connection_finished_flushing", "calls": ["TO_OR_CONN", "connection_or_finished_flushing", "connection_stop_writing", "TO_DIR_CONN", "tor_assertion_failed_", "connection_ext_or_finished_flushing", "connection_control_finished_flushing", "connection_edge_finished_flushing", "TO_EDGE_CONN", "TO_CONTROL_CONN", "connection_dir_finished_flushing", "log_fn_"]}, {"name": "digestmap_isempty", "calls": []}, {"name": "control_event_hs_descriptor_upload_failed", "calls": ["control_event_hs_descriptor_upload_end", "log_fn_"]}, {"name": "transport_copy", "calls": ["tor_addr_copy", "tor_malloc_zero_", "tor_assertion_failed_", "tor_strdup_"]}, {"name": "addr_mask_get_bits", "calls": []}, {"name": "write_stream_target_to_buf", "calls": ["connection_edge_is_rendezvous_stream", "tor_snprintf"]}, {"name": "circuit_set_rendezvous_cookie", "calls": ["circuit_set_rend_token"]}, {"name": "sb_mmap2", "calls": []}, {"name": "connection_edge_finished_connecting", "calls": ["connection_start_writing", "connection_watch_events", "rep_hist_note_exit_stream_opened", "safe_str", "connection_edge_is_rendezvous_stream", "connection_edge_send_command", "tor_assertion_failed_", "connection_get_outbuf_len", "fmt_addr_impl", "escaped_safe_str", "connected_cell_format_payload", "connection_edge_process_inbuf", "log_fn_"]}, {"name": "ed_key_new", "calls": ["tor_assertion_failed_", "ed25519_keypair_generate", "tor_malloc_zero_", "tor_cert_create"]}, {"name": "chunk_free_unchecked", "calls": ["get_uint32", "tor_assertion_failed_"]}, {"name": "extend_info_free", "calls": ["crypto_pk_free"]}, {"name": "rsamap_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "routerlist_insert_old", "calls": ["get_options", "router_get_my_routerinfo", "tor_assertion_failed_", "smartlist_add", "directory_caches_dir_info", "signed_descriptor_from_routerinfo", "sdmap_set", "routerinfo_free", "tor_digest_is_zero", "sdmap_get"]}, {"name": "queued_events_flush_all", "calls": ["smartlist_free", "tor_mutex_acquire", "smartlist_add", "get_connection_array", "get_block_event_queue", "connection_flush", "tor_mutex_release", "connection_write_to_buf", "queued_event_free", "TO_CONTROL_CONN", "smartlist_new"]}, {"name": "format_iso_time_nospace", "calls": ["format_iso_time"]}, {"name": "command_process_created_cell", "calls": ["get_options", "circuit_get_by_circid_channel", "circuit_send_next_onion_skin", "circuit_finish_handshake", "created_cell_parse", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "relay_send_command_from_edge_", "extended_cell_format", "log_fn_"]}, {"name": "getinfo_helper_geoip", "calls": ["geoip_get_country_by_ipv4", "geoip_get_country_by_ipv6", "tor_addr_parse", "tor_strdup_", "geoip_is_loaded", "tor_addr_to_ipv4h", "geoip_get_country_name", "strcmpstart", "tor_addr_to_in6"]}, {"name": "find_nth_time", "calls": ["tor_assertion_failed_"]}, {"name": "init_geoip_countries", "calls": ["strlcpy", "smartlist_add", "strmap_set_lc", "strmap_new", "tor_malloc_zero_", "smartlist_new"]}, {"name": "dirserv_orconn_tls_done", "calls": ["get_options", "tor_addr_copy", "tor_assertion_failed_", "router_describe", "tor_addr_family", "authdir_mode_bridge", "tor_addr_to_str", "rep_hist_note_router_reachable", "node_get_mutable_by_id", "router_has_orport", "log_fn_"]}, {"name": "crypto_xof_free", "calls": ["memwipe"]}, {"name": "keypin_check_and_add_impl", "calls": ["edmap_HT_FIND", "keypin_add_or_replace_entry_in_map", "tor_assertion_failed_", "keypin_journal_append_entry", "rsamap_HT_FIND", "tor_memdup_", "tor_memeq"]}, {"name": "scan_unsigned", "calls": ["digit_to_num", "TOR_ISDIGIT", "TOR_ISXDIGIT", "hex_decode_digit", "tor_assertion_failed_"]}, {"name": "environment_variable_names_equal", "calls": ["str_num_before", "tor_memeq"]}, {"name": "router_pick_trusteddirserver", "calls": ["router_pick_dirserver_generic"]}, {"name": "pathbias_check_probe_response", "calls": ["get_uint32", "tor_assertion_failed_", "relay_header_unpack", "pathbias_mark_use_success", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "log_fn_"]}, {"name": "note_broken_connection", "calls": ["strmap_new", "strmap_set", "strmap_get"]}, {"name": "dump_dns_mem_usage", "calls": ["dns_cache_entry_count", "tor_log"]}, {"name": "update_approx_time", "calls": []}, {"name": "router_extrainfo_digest_is_me", "calls": ["tor_memeq", "router_get_my_extrainfo"]}, {"name": "channel_flush_from_first_active_circuit", "calls": ["get_options", "tv_to_msec", "packed_cell_get_command", "smartlist_add", "tor_assertion_failed_", "channel_write_packed_cell", "TO_OR_CIRCUIT", "smartlist_new", "tor_malloc_zero_", "circuitmux_notify_xmit_destroy", "tor_gettimeofday_cached", "cell_queue_pop", "set_streams_blocked_on_circ", "geoip_change_dirreq_state", "log_fn_"]}, {"name": "rep_hist_conn_stats_term", "calls": ["rep_hist_reset_conn_stats"]}, {"name": "compute_retry_timeout", "calls": ["get_options"]}, {"name": "get_syscall_name", "calls": ["format_dec_number_sigsafe"]}, {"name": "update_extrainfo_downloads", "calls": ["eimap_get", "get_options", "smartlist_free", "smartlist_shuffle", "router_get_by_extrainfo_digest", "base16_encode", "router_get_routerlist", "router_get_by_id_digest", "smartlist_add", "digestmap_new", "list_pending_descriptor_downloads", "should_delay_dir_fetches", "digestmap_get", "router_have_minimum_dir_info", "tor_digest_is_zero", "initiate_descriptor_downloads", "max_dl_per_request", "download_status_is_ready", "smartlist_new", "log_fn_"]}, {"name": "digestmap_iter_next", "calls": ["tor_assertion_failed_", "digestmap_impl_HT_NEXT"]}, {"name": "opt_streq", "calls": ["strcmp_opt"]}, {"name": "add_stream_log", "calls": ["tor_mutex_release", "tor_mutex_acquire", "add_stream_log_impl"]}, {"name": "tor_addr_is_null", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_to_ipv4n", "tor_addr_to_in6", "log_fn_"]}, {"name": "rend_parse_service_authorization", "calls": ["smartlist_clear", "strcmpend", "smartlist_split_string", "strmap_set", "tor_snprintf", "smartlist_free", "rend_service_authorization_free", "strmap_new", "memwipe", "tor_malloc_zero_", "base64_decode", "strmap_get", "rend_service_authorization_free_all", "strlcpy", "rend_valid_service_id", "smartlist_new", "log_fn_"]}, {"name": "create_cell_format_impl", "calls": ["tor_assertion_failed_", "set_uint16", "check_create_cell"]}, {"name": "authority_cert_parse_from_string", "calls": ["smartlist_free", "find_by_keyword_", "dump_desc", "memarea_drop_all", "authority_cert_get_by_digests", "check_signature_token", "eat_whitespace", "router_get_hash_impl", "smartlist_new", "tor_inet_aton", "parse_iso_time", "authority_cert_free", "tor_assertion_failed_", "tor_malloc_", "tor_memeq", "escaped", "find_opt_by_keyword", "tor_malloc_zero_", "crypto_pk_get_digest", "memarea_new", "tokenize_string", "tor_addr_port_split", "base16_decode", "token_clear", "log_fn_"]}, {"name": "tor_libevent_get_version_str", "calls": []}, {"name": "key_to_string", "calls": ["crypto_log_errors", "tor_malloc_"]}, {"name": "lost_owning_controller", "calls": ["activate_signal", "log_fn_"]}, {"name": "load_policy_from_option", "calls": ["addr_policy_list_free", "parse_addr_policy", "addr_policy_free", "addr_policy_get_canonical_entry", "log_fn_"]}, {"name": "periodic_timer_new", "calls": ["tor_assertion_failed_", "tor_malloc_zero_"]}, {"name": "tor_accept_socket_nonblocking", "calls": ["tor_accept_socket_with_extensions"]}, {"name": "channel_tls_get_listener", "calls": []}, {"name": "tor_mutex_init_nonrecursive", "calls": ["tor_threads_init", "log_fn_"]}, {"name": "is_compression_bomb", "calls": []}, {"name": "connection_ap_supports_optimistic_data", "calls": []}, {"name": "get_configured_bridge_by_orports_digest", "calls": ["tor_digest_is_zero", "tor_addr_compare", "tor_memeq"]}, {"name": "rep_hist_seen_new_rp_cell", "calls": []}, {"name": "tor_tls_server_info_callback", "calls": ["log_fn_", "tor_tls_get_by_ssl", "tor_tls_debug_state_callback", "tor_tls_client_is_using_v2_ciphers"]}, {"name": "connection_in_array", "calls": ["smartlist_contains"]}, {"name": "entry_guards_changed", "calls": ["get_options", "or_state_mark_dirty", "get_or_state"]}, {"name": "log_heartbeat", "calls": ["get_options", "rep_hist_log_circuit_handshake_stats", "rep_hist_log_link_protocol_counts", "node_get_by_id", "log_accounting", "circuit_log_ancient_one_hop_circuits", "public_server_mode", "router_get_my_routerinfo", "get_bytes_written", "format_client_stats_heartbeat", "bytes_to_usage", "get_bytes_read", "accounting_is_enabled", "we_are_hibernating", "secs_to_uptime", "server_mode", "log_fn_", "tls_get_write_overhead_ratio", "count_circuits", "get_uptime"]}, {"name": "channel_tls_handle_cell", "calls": ["channel_tls_to_base", "get_options", "conn_state_to_string", "channel_tls_process_netinfo_cell", "tor_assertion_failed_", "channel_state_to_string", "or_handshake_state_record_cell", "log_fn_", "connection_or_close_for_error"]}, {"name": "connection_or_launch_v3_or_handshake", "calls": ["connection_or_send_versions", "connection_init_or_handshake_state", "connection_or_nonopen_was_started_here", "tor_assertion_failed_", "get_circuit_build_times_mutable", "connection_or_change_state", "circuit_build_times_network_is_live"]}, {"name": "channel_listener_when_created", "calls": ["tor_assertion_failed_"]}, {"name": "microdesc_list_missing_digest256", "calls": ["get_options", "microdesc_cache_lookup_by_digest256", "smartlist_add", "tor_assertion_failed_", "digest256map_get", "tor_mem_is_zero", "download_status_is_ready", "smartlist_new"]}, {"name": "dirvote_clear_pending_consensuses", "calls": ["networkstatus_vote_free"]}, {"name": "new_element2", "calls": ["tor_malloc_zero_"]}, {"name": "wildcard_increment_answer", "calls": ["tor_log", "smartlist_add", "strmap_get", "strmap_new", "tor_malloc_zero_", "smartlist_contains_string", "tor_strdup_", "control_event_server_status", "smartlist_new", "strmap_set"]}, {"name": "connection_or_finished_flushing", "calls": ["assert_connection_ok", "tor_assertion_failed_", "log_fn_"]}, {"name": "update_consensus_networkstatus_downloads", "calls": ["get_options", "should_delay_dir_fetches", "networkstatus_get_latest_consensus_by_flavor", "networkstatus_consensus_is_boostrapping", "usable_consensus_flavor", "networkstatus_get_flavor_name", "tor_assertion_failed_", "check_consensus_waiting_for_certs", "consensus_max_download_tries", "connection_dir_count_by_purpose_and_resource", "directory_get_from_dirserver", "connection_dir_count_by_purpose_resource_and_state", "update_consensus_bootstrap_multiple_downloads", "we_want_to_fetch_flavor", "download_status_is_ready", "networkstatus_consensus_can_use_multiple_directories", "log_fn_"]}, {"name": "control_event_stream_bandwidth", "calls": ["TO_ORIGIN_CIRCUIT", "send_control_event", "circuit_get_by_edge_conn"]}, {"name": "authority_cert_get_by_sk_digest", "calls": ["digestmap_iter_next", "digestmap_iter_get", "digestmap_iter_done", "get_my_v3_legacy_cert", "get_my_v3_authority_cert", "digestmap_iter_init", "tor_memeq"]}, {"name": "buf_pullup", "calls": ["CHUNK_WRITE_PTR", "preferred_chunk_size", "chunk_free_unchecked", "tor_assertion_failed_", "chunk_repack", "chunk_grow", "CHUNK_REMAINING_CAPACITY"]}, {"name": "clientmap_HT_FIND", "calls": ["clientmap_HT_FIND_P_", "clientmap_entry_hash"]}, {"name": "options_need_geoip_info", "calls": ["routerset_needs_geoip"]}, {"name": "length_of_accounting_period_containing", "calls": ["edge_of_accounting_period_containing"]}, {"name": "dirserv_set_router_is_running", "calls": ["get_options", "rep_hist_note_router_unreachable", "tor_addr_is_null", "tor_assertion_failed_", "router_is_me", "running_long_enough_to_decide_unreachable", "we_are_hibernating", "node_get_mutable_by_id"]}, {"name": "router_parse_addr_policy_private", "calls": ["strcmpstart", "parse_port_range", "eat_whitespace", "addr_policy_get_canonical_entry", "log_fn_"]}, {"name": "get_var_cell_header_size", "calls": []}, {"name": "compare_cached_resolves_by_expiry_", "calls": []}, {"name": "eimap_iter_get", "calls": ["digestmap_iter_get"]}, {"name": "options_init_logs", "calls": ["set_log_time_granularity", "add_file_log", "smartlist_clear", "parse_log_severity_config", "add_stream_log", "smartlist_add", "smartlist_free", "add_syslog_log", "tor_malloc_zero_", "expand_filename", "tor_strdup_", "smartlist_split_string", "logs_set_domain_logging", "smartlist_new", "log_fn_"]}, {"name": "channel_idmap_HT_FIND_P_", "calls": ["channel_idmap_eq"]}, {"name": "tor_cond_wait", "calls": []}, {"name": "config_mark_lists_fragile", "calls": ["tor_assertion_failed_"]}, {"name": "any_bridge_descriptors_known", "calls": ["get_options", "choose_random_entry", "tor_assertion_failed_"]}, {"name": "options_validate", "calls": ["smartlist_free", "bridge_line_free", "public_server_mode", "accounting_parse_options", "get_options_from_transport_options_line", "config_is_same", "parse_bridge_line", "escaped", "routerset_free", "validate_data_directory", "dirserv_read_measured_bandwidths", "check_nickname_list", "parse_virtual_addr_network", "config_count_key", "authdir_mode", "config_lines_dup", "rend_parse_service_authorization", "routerset_parse", "routerset_len", "tor_strdup_", "rend_config_services", "decode_hashed_passwords", "config_line_append", "validate_recommended_package_line", "config_free_lines", "smartlist_join_strings", "options_init_logs", "strcmpstart", "tor_asprintf", "tor_addr_port_lookup", "dirserv_read_guardfraction_file", "validate_addr_policies", "routerset_new", "compute_real_max_mem_in_queues", "authdir_mode_any_main", "routerset_union", "evaluate_ecgroup_for_tls", "tor_assertion_failed_", "smartlist_add", "get_bindaddr_from_transport_listen_line", "tor_validate_process_specifier", "compute_publishserverdescriptor", "resolve_my_address", "is_legal_nickname", "parse_transport_line", "smartlist_add_asprintf", "get_uname", "warn_about_relative_paths", "validate_dir_servers", "server_mode", "tor_malloc_zero_", "ensure_bandwidth_cap", "parse_outbound_addresses", "validate_ports_csv", "parse_ports", "have_enough_mem_for_dircache", "smartlist_new", "routerset_is_list", "log_fn_"]}, {"name": "dirvote_add_signatures_to_pending_consensus", "calls": ["networkstatus_vote_free", "networkstatus_add_detached_signatures", "networkstatus_format_signatures", "networkstatus_get_flavor_name", "tor_assertion_failed_", "tor_realloc_", "networkstatus_parse_vote_from_string", "strlcpy", "strmap_get", "log_fn_"]}, {"name": "parse_socks", "calls": ["get_uint32", "get_uint16", "string_is_valid_ipv6_address", "addressmap_have_mapping", "escaped", "escaped_safe_str_client", "safe_str_client", "control_event_client_status", "tor_inet_ntoa", "tor_strndup_", "tor_addr_from_ipv4n", "tor_memdup_", "tor_addr_from_ipv6_bytes", "tor_assertion_failed_", "string_is_valid_hostname", "string_is_valid_ipv4_address", "strlcpy", "log_unsafe_socks_warning", "tor_strisprint", "tor_addr_to_str", "socks_request_set_socks5_error", "log_fn_"]}, {"name": "connection_dir_close_consensus_conn_if_extra", "calls": ["networkstatus_consensus_is_boostrapping", "tor_assertion_failed_", "connection_close_immediate", "connection_dir_would_close_consensus_conn_helper", "connection_mark_for_close_"]}, {"name": "worker_state_free", "calls": ["server_onion_keys_free"]}, {"name": "router_get_consensus_status_by_id", "calls": ["router_get_mutable_consensus_status_by_id"]}, {"name": "tor_log", "calls": ["logv"]}, {"name": "ed25519_keypair_free", "calls": ["memwipe"]}, {"name": "sandbox_freeaddrinfo", "calls": []}, {"name": "sb_mprotect", "calls": []}, {"name": "fp_pair_map_impl_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "consider_plaintext_ports", "calls": ["get_options", "log_fn_", "smartlist_contains_int_as_string", "control_event_client_status", "connection_mark_unattached_ap_"]}, {"name": "trusted_dir_server_new", "calls": ["get_options", "dir_server_new", "tor_dup_ip", "tor_strdup_", "resolve_my_address", "tor_addr_from_ipv4n", "tor_lookup_hostname", "log_fn_"]}, {"name": "dirserv_get_routerdescs", "calls": ["router_digest_is_me", "smartlist_free", "router_get_by_descriptor_digest", "router_get_my_routerinfo", "smartlist_add", "router_get_routerlist", "router_get_by_id_digest", "dir_split_resource_into_fingerprints", "strcmpstart", "smartlist_new"]}, {"name": "log_engine", "calls": ["log_fn_"]}, {"name": "channel_assert_counter_consistency", "calls": ["tor_assertion_failed_"]}, {"name": "memarea_memdup", "calls": ["memarea_alloc"]}, {"name": "crypto_pk_public_checksig_digest", "calls": ["crypto_pk_keysize", "tor_assertion_failed_", "tor_malloc_", "crypto_digest", "crypto_pk_public_checksig", "tor_memeq", "log_fn_"]}, {"name": "update_networkstatus_downloads", "calls": ["get_options", "should_delay_dir_fetches", "update_consensus_networkstatus_downloads", "update_certificate_downloads"]}, {"name": "connection_send_socks5_connect", "calls": ["connection_write_to_buf", "tor_addr_to_ipv4n", "tor_addr_family", "tor_addr_to_in6"]}, {"name": "digest256map_iter_init", "calls": ["tor_assertion_failed_", "digest256map_impl_HT_START"]}, {"name": "router_should_be_directory_server", "calls": ["get_options", "get_effective_bwrate", "tor_assertion_failed_", "router_has_bandwidth_to_be_dirserver", "accounting_is_enabled", "accounting_get_interval_length", "log_fn_"]}, {"name": "launch_descriptor_downloads", "calls": ["get_options", "initiate_descriptor_downloads", "authdir_mode_any_nonhidserv", "tor_assertion_failed_", "max_dl_per_request", "directory_fetches_dir_info_early", "smartlist_sort_digests", "log_fn_"]}, {"name": "tor_addr_port_parse", "calls": ["tor_addr_parse", "tor_assertion_failed_", "tor_addr_port_split"]}, {"name": "dnsserv_close_listener", "calls": ["tor_assertion_failed_", "TO_LISTENER_CONN"]}, {"name": "node_ipv6_preferred", "calls": ["tor_addr_is_null", "tor_assertion_failed_", "node_get_prim_orport"]}, {"name": "networkstatus_get_param", "calls": ["networkstatus_get_latest_consensus", "get_net_param_from_list"]}, {"name": "pathbias_get_use_success_count", "calls": ["pathbias_count_circs_in_states"]}, {"name": "log_tor_version", "calls": ["tor_fd_getpos", "tor_snprintf", "write_all", "log_prefix_"]}, {"name": "finish_writing_to_file", "calls": ["finish_writing_to_file_impl"]}, {"name": "new_element", "calls": ["new_element2"]}, {"name": "start_writing_to_file", "calls": ["tor_open_cloexec", "tor_assertion_failed_", "tor_strdup_", "tor_malloc_zero_", "tor_fd_seekend", "tor_asprintf", "log_fn_"]}, {"name": "handle_control_resetconf", "calls": ["control_setconf_helper"]}, {"name": "circuitmux_attached_circuit_direction", "calls": ["circuitmux_find_map_entry", "tor_assertion_failed_"]}, {"name": "router_reset_reachability", "calls": []}, {"name": "TO_LISTENER_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "crypto_xof_squeeze_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "curve25519_public_key_is_ok", "calls": ["safe_mem_is_zero"]}, {"name": "load_signing_key", "calls": ["log_fn_"]}, {"name": "dirvote_get_pending_detached_signatures", "calls": []}, {"name": "cell_queue_entry_new_fixed", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "sandbox_is_active", "calls": []}, {"name": "check_nickname_list", "calls": ["smartlist_free", "tor_asprintf", "smartlist_split_string", "smartlist_join_strings", "is_legal_nickname_or_hexdigest", "smartlist_new"]}, {"name": "fp_pair_map_impl_HT_CLEAR", "calls": ["tor_free_", "fp_pair_map_impl_HT_INIT"]}, {"name": "circuit_build_times_network_circ_success", "calls": []}, {"name": "policy_expand_private", "calls": ["smartlist_free", "addr_policy_free", "tor_addr_parse_mask_ports", "smartlist_add", "tor_assertion_failed_", "addr_policy_get_canonical_entry", "smartlist_new"]}, {"name": "inform_testing_reachability", "calls": ["router_get_my_routerinfo", "tor_dup_ip", "tor_snprintf", "control_event_server_status", "log_fn_"]}, {"name": "add_connection_to_closeable_list", "calls": ["smartlist_contains", "smartlist_add", "tor_assertion_failed_", "assert_connection_ok"]}, {"name": "addressmap_get_mappings", "calls": ["strmap_iter_get", "addressmap_ent_remove", "smartlist_add_asprintf", "format_iso_time", "strmap_iter_init", "strmap_iter_done", "addressmap_init", "strmap_iter_next_rmv", "strmap_iter_next"]}, {"name": "digest256map_assign_key", "calls": []}, {"name": "buf_new", "calls": ["tor_malloc_zero_"]}, {"name": "options_save_current", "calls": ["get_options", "write_configuration_file", "get_torrc_fname"]}, {"name": "connection_ext_or_auth_send_result", "calls": ["connection_write_to_buf"]}, {"name": "dump_routerlist_mem_usage", "calls": ["tor_log"]}, {"name": "tor_tls_check_lifetime", "calls": ["tls_log_errors", "check_cert_lifetime_internal"]}, {"name": "commit_max", "calls": []}, {"name": "clientmap_HT_CLEAR", "calls": ["clientmap_HT_INIT", "tor_free_"]}, {"name": "hid_serv_get_responsible_directories", "calls": ["networkstatus_get_latest_consensus", "smartlist_add", "tor_assertion_failed_", "networkstatus_vote_find_entry_idx", "log_fn_"]}, {"name": "crypto_pwbox", "calls": ["crypto_cipher_free", "crypto_cipher_crypt_inplace", "memwipe", "secret_to_key_derivekey", "crypto_cipher_new_with_iv", "set_uint32", "crypto_rand", "tor_assertion_failed_", "tor_malloc_", "secret_to_key_make_specifier", "crypto_hmac_sha256"]}, {"name": "eat_whitespace", "calls": ["tor_assertion_failed_"]}, {"name": "main", "calls": ["load_signing_key", "crypto_global_init", "read_file_to_str", "generate_signing_key", "crypto_pk_new", "generate_certificate", "set_log_severity_config", "crypto_seed_rng", "crypto_global_cleanup", "tor_main", "sandbox_disable_getaddrinfo_cache", "fmt_addr_impl", "crypto_pk_read_public_key_from_string", "network_init", "load_identity_key", "usage", "tor_malloc_zero_", "expand_filename", "init_logging", "crypto_pk_get_rsa_", "add_stream_log", "clear_passphrase", "parse_commandline", "addr_port_lookup", "crypto_pk_get_fingerprint", "do_resolve", "log_fn_"]}, {"name": "tor_tls_used_v1_handshake", "calls": []}, {"name": "channel_listener_closed", "calls": ["channel_listener_change_state", "tor_assertion_failed_"]}, {"name": "predicted_ports_init", "calls": ["add_predicted_port", "smartlist_new"]}, {"name": "replaycache_add_test_and_elapsed", "calls": ["replaycache_add_and_test_internal"]}, {"name": "resolved_cell_parse", "calls": ["get_uint32", "tor_assertion_failed_", "smartlist_add", "smartlist_free", "smartlist_add_all", "tor_memdup_nulterm_", "tor_malloc_zero_", "tor_addr_from_ipv4n", "tor_addr_from_ipv6_bytes", "smartlist_new", "address_ttl_free"]}, {"name": "smartlist_join_strings", "calls": ["smartlist_join_strings2"]}, {"name": "handle_control_setevents", "calls": ["smartlist_free", "control_update_global_event_mask", "smartlist_split_string", "send_control_done", "connection_printf_to_buf", "smartlist_new"]}, {"name": "delete_log", "calls": ["log_free"]}, {"name": "node_exit_policy_is_exact", "calls": []}, {"name": "escaped_safe_str", "calls": ["escaped", "get_options"]}, {"name": "routerlist_replace", "calls": ["get_options", "router_get_my_routerinfo", "routerlist_find_elt_", "extrainfo_free", "routerlist_insert", "sdmap_remove", "smartlist_add", "signed_descriptor_from_routerinfo", "router_dir_info_changed", "directory_caches_dir_info", "nodelist_set_routerinfo", "sdmap_set", "tor_digest_is_zero", "tor_memeq", "tor_assertion_failed_", "routerinfo_free", "eimap_remove", "rimap_set", "rimap_remove", "log_fn_"]}, {"name": "read_file_to_str", "calls": ["read_file_to_str_until_eof", "tor_open_cloexec", "tor_assertion_failed_", "read_all", "tor_malloc_", "log_fn_"]}, {"name": "circuit_append_new_exit", "calls": ["tor_assertion_failed_", "onion_append_hop", "extend_info_free", "extend_info_dup"]}, {"name": "circuit_build_times_close_rate", "calls": []}, {"name": "check_sockaddr_family_match", "calls": ["conn_type_to_string", "log_fn_"]}, {"name": "smartlist_contains", "calls": []}, {"name": "channel_is_bad_for_new_circs", "calls": ["tor_assertion_failed_"]}, {"name": "networkstatus_check_document_signature", "calls": ["crypto_pk_keysize", "hex_str", "authority_cert_is_blacklisted", "crypto_pk_get_digest", "tor_malloc_", "crypto_pk_public_checksig", "tor_memeq", "log_fn_"]}, {"name": "routerlist_insert", "calls": ["tor_digest_is_zero", "router_get_my_routerinfo", "tor_assertion_failed_", "smartlist_add", "router_dir_info_changed", "nodelist_set_routerinfo", "sdmap_set", "signed_descriptor_free", "smartlist_del", "sdmap_remove", "rimap_set"]}, {"name": "should_use_directory_guards", "calls": ["public_server_mode"]}, {"name": "chanid_circid_muxinfo_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "nodelist_remove_microdesc", "calls": ["node_get_mutable_by_id"]}, {"name": "safe_mem_is_zero", "calls": []}, {"name": "cell_queue_entry_new_var", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "tor_errno_to_tls_error", "calls": []}, {"name": "compare_pairs_", "calls": []}, {"name": "dirserv_test_reachability", "calls": ["get_options", "dirserv_single_reachability_test", "router_is_me", "authdir_mode_bridge", "router_get_routerlist"]}, {"name": "smartlist_reverse", "calls": ["tor_assertion_failed_"]}, {"name": "router_perform_bandwidth_test", "calls": ["get_options", "log_fn_", "relay_send_command_from_edge_", "circuit_get_next_by_pk_and_purpose"]}, {"name": "memarea_clear_freelist", "calls": []}, {"name": "rep_hist_make_router_pessimal", "calls": ["mark_or_down", "rep_hist_note_router_unreachable", "tor_assertion_failed_", "get_or_history"]}, {"name": "tor_zlib_state_size_precalc", "calls": []}, {"name": "process_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "strmap_remove", "calls": ["strmap_assign_tmp_key", "tor_assertion_failed_", "strmap_entry_free", "strmap_impl_HT_REMOVE"]}, {"name": "tor_cond_free", "calls": ["tor_cond_uninit"]}, {"name": "try_to_extract_certs_from_tls", "calls": ["log_fn_"]}, {"name": "get_connection_array", "calls": ["smartlist_new"]}, {"name": "smartlist_sort", "calls": []}, {"name": "router_get_trusteddirserver_by_digest", "calls": ["tor_memeq"]}, {"name": "tor_version_compare", "calls": ["tor_assertion_failed_"]}, {"name": "connection_buckets_note_empty_ts", "calls": ["msec_since_midnight"]}, {"name": "crypto_strongest_rand", "calls": ["crypto_rand", "tor_assertion_failed_", "memwipe", "crypto_strongest_rand_raw", "log_fn_"]}, {"name": "sort_version_list", "calls": ["smartlist_sort"]}, {"name": "get_total_system_memory_impl", "calls": ["tor_open_cloexec", "read_file_to_str_until_eof"]}, {"name": "rep_hist_note_bytes_read", "calls": ["add_obs"]}, {"name": "remove_old_client_helper_", "calls": ["clientmap_entry_free"]}, {"name": "circuit_purpose_from_string", "calls": ["strcasecmpstart"]}, {"name": "count_circuits", "calls": ["circuit_get_global_list"]}, {"name": "load_authority_keyset", "calls": ["get_options", "crypto_pk_eq_keys", "authority_cert_free", "read_file_to_str", "init_key_from_file", "authority_cert_parse_from_string", "options_get_datadir_fname2_suffix", "crypto_pk_free", "log_fn_"]}, {"name": "dirvote_free_all", "calls": ["smartlist_free", "dirvote_clear_pending_consensuses", "dirvote_clear_votes"]}, {"name": "circuit_increment_failure_count", "calls": ["log_fn_"]}, {"name": "strlcpy", "calls": []}, {"name": "connection_fetch_var_cell_from_buf", "calls": ["fetch_var_cell_from_buf"]}, {"name": "dirserv_dump_directory_to_string", "calls": ["get_options", "tor_snprintf", "router_get_dir_hash", "tor_assertion_failed_", "note_crypto_pk_op", "tor_malloc_", "router_append_dirobj_signature", "format_iso_time", "format_versions_list", "crypto_pk_write_public_key_to_string", "strlcat", "log_fn_"]}, {"name": "add_stream_log_impl", "calls": ["get_min_log_level", "tor_memdup_", "tor_malloc_zero_", "tor_strdup_"]}, {"name": "cell_pack", "calls": ["set_uint8", "set_uint16", "set_uint32"]}, {"name": "drop_capabilities", "calls": ["log_fn_"]}, {"name": "connection_get_by_type", "calls": ["get_connection_array"]}, {"name": "crypto_pk_write_private_key_to_filename", "calls": ["crypto_log_errors", "tor_assertion_failed_", "write_str_to_file", "memwipe", "tor_malloc_"]}, {"name": "nodelist_remove_routerinfo", "calls": ["node_get_mutable_by_id", "node_free", "nodelist_drop_node", "node_is_usable"]}, {"name": "rsamap_HT_CLEAR", "calls": ["rsamap_HT_INIT", "tor_free_"]}, {"name": "bidi_map_ent_eq", "calls": []}, {"name": "connection_mark_all_noncontrol_listeners", "calls": ["connection_is_listener", "get_connection_array", "connection_mark_for_close_"]}, {"name": "tor_asprintf", "calls": ["tor_vasprintf", "tor_assertion_failed_", "log_fn_"]}, {"name": "crypto_rand_time_range", "calls": ["tor_assertion_failed_", "crypto_rand_uint64"]}, {"name": "connection_proxy_connect", "calls": ["get_options", "pt_get_socks_args_for_proxy_addrport", "connection_proxy_state_to_string", "fmt_addrport", "get_proxy_type", "tor_snprintf", "tor_assertion_failed_", "tor_addr_family", "get_socks_args_by_bridge_addrport", "connection_write_to_buf", "tor_malloc_zero_", "tor_addr_to_ipv4n", "alloc_http_authenticator", "strlcpy", "log_fn_"]}, {"name": "bidi_map_ent_hash", "calls": []}, {"name": "cell_ewma_tick_from_timeval", "calls": []}, {"name": "buf_pos_init", "calls": []}, {"name": "buf_get_total_allocation", "calls": []}, {"name": "nodelist_map_HT_CLEAR", "calls": ["tor_free_", "nodelist_map_HT_INIT"]}, {"name": "crypto_pk_cmp_keys", "calls": ["tor_assertion_failed_", "tor_memcmp"]}, {"name": "entry_nodes_should_be_added", "calls": ["log_fn_"]}, {"name": "connection_dirserv_add_servers_to_outbuf", "calls": ["get_options", "smartlist_free", "get_signed_descriptor_by_fp", "extrainfo_get_by_descriptor_digest", "router_get_by_descriptor_digest", "rep_hist_note_desc_served", "router_get_by_id_digest", "tor_zlib_free", "connection_dir_is_encrypted", "connection_write_to_buf", "connection_get_outbuf_len", "connection_write_to_buf_zlib", "smartlist_pop_last", "signed_descriptor_get_body"]}, {"name": "chan_circid_map_HT_NEXT_RMV", "calls": []}, {"name": "tor_init_libevent_rng", "calls": ["crypto_rand"]}, {"name": "tor_addr_compare", "calls": ["tor_addr_compare_masked"]}, {"name": "connection_or_flushed_some", "calls": ["channel_tls_to_base", "scheduler_channel_wants_writes", "connection_get_outbuf_len"]}, {"name": "pathbias_count_timeout", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "entry_guards_changed"]}, {"name": "remove_invalid_intro_points", "calls": ["rend_intro_point_free", "safe_str_client", "intro_point_should_expire_now", "tor_assertion_failed_", "smartlist_add", "find_intro_circuit", "extend_info_describe", "smartlist_del", "node_get_by_id", "log_fn_"]}, {"name": "crypto_expand_key_material_TAP", "calls": ["tor_assertion_failed_", "memwipe", "tor_malloc_", "crypto_digest"]}, {"name": "save_stability_callback", "calls": ["authdir_mode_tests_reachability", "rep_hist_record_mtbf_data", "log_fn_"]}, {"name": "fp_pair_map_entries_eq", "calls": ["tor_memeq"]}, {"name": "tor_tls_context_new", "calls": ["tor_tls_context_decref", "crypto_pk_new", "crypto_pk_dup_key", "tor_tls_init", "crypto_pk_free", "tor_tls_create_certificate", "crypto_dh_new", "tor_assertion_failed_", "tor_malloc_zero_", "crypto_pk_generate_key_with_bits", "crypto_random_hostname", "crypto_pk_get_evp_pkey_", "tls_log_errors", "crypto_dh_free", "crypto_dh_get_dh_", "tor_x509_cert_new", "log_fn_"]}, {"name": "check_created_cell", "calls": []}, {"name": "fast_client_handshake", "calls": ["tor_memeq", "memwipe", "crypto_expand_key_material_TAP", "tor_malloc_"]}, {"name": "keypin_load_journal_impl", "calls": ["TOR_ISSPACE", "keypin_add_or_replace_entry_in_map", "keypin_parse_journal_line", "tor_log"]}, {"name": "fast_memcmpstart", "calls": []}, {"name": "scheduler_adjust_queue_size", "calls": ["scheduler_update_queue_heuristic", "approx_time", "log_fn_"]}, {"name": "microdesc_check_counts", "calls": ["microdesc_map_HT_NEXT", "microdesc_map_HT_START", "tor_assertion_failed_", "nodelist_get_list"]}, {"name": "channel_change_state", "calls": ["channel_state_is_valid", "tor_digest_is_zero", "channel_flush_cells", "smartlist_remove", "channel_add_to_digest_map", "smartlist_add", "channel_remove_from_digest_map", "tor_assertion_failed_", "scheduler_release_channel", "channel_state_can_transition", "channel_state_to_string", "scheduler_channel_doesnt_want_writes", "smartlist_new", "log_fn_"]}, {"name": "eimap_isempty", "calls": ["digestmap_isempty"]}, {"name": "option_get_canonical_name", "calls": ["config_find_option"]}, {"name": "get_environment", "calls": []}, {"name": "tor_getsockname", "calls": []}, {"name": "config_lines_eq", "calls": []}, {"name": "mark_or_up", "calls": []}, {"name": "document_signature_free", "calls": []}, {"name": "conn_close_if_marked", "calls": ["conn_type_to_string", "flush_buf_tls", "connection_wants_to_flush", "connection_get_outbuf_len", "connection_bucket_write_limit", "flush_buf", "connection_unlink", "escaped_safe_str_client", "TO_OR_CONN", "connection_stop_reading", "connection_is_reading", "move_buf_to_buf", "connection_start_reading_from_linked_conn", "enable_control_logging", "tor_assertion_failed_", "connection_stop_writing", "connection_is_writing", "assert_connection_ok", "log_failed_proxy_connection", "disable_control_logging", "log_fn_"]}, {"name": "router_reload_router_list_impl", "calls": ["get_options", "tor_munmap_file", "routerlist_remove_old_routers", "tor_mmap_file", "router_load_extrainfo_from_string", "read_file_to_str", "router_rebuild_store", "file_status", "options_get_datadir_fname2_suffix", "router_load_routers_from_string", "log_fn_"]}, {"name": "connection_proxy_state_to_string", "calls": []}, {"name": "rend_service_add_filenames_to_list", "calls": ["tor_assertion_failed_", "smartlist_add_asprintf"]}, {"name": "tor_addr_parse_PTR_name", "calls": ["tor_inet_aton", "strcasecmpend", "tor_addr_parse", "hex_decode_digit", "tor_addr_from_in6", "tor_addr_from_ipv4n"]}, {"name": "addressmap_virtaddress_remove", "calls": ["strmap_remove", "strmap_get", "address_is_in_virtual_range"]}, {"name": "cache_map_HT_INSERT", "calls": ["cached_resolve_hash", "cache_map_HT_GROW"]}, {"name": "in_main_thread", "calls": ["tor_get_thread_id"]}, {"name": "crypto_strongest_rand_fallback", "calls": ["read_all", "sandbox_intern_string", "log_fn_"]}, {"name": "safe_str", "calls": ["get_options", "tor_assertion_failed_"]}, {"name": "authority_cert_get_all", "calls": ["digestmap_iter_next", "digestmap_iter_get", "smartlist_add", "tor_assertion_failed_", "digestmap_iter_done", "digestmap_iter_init"]}, {"name": "connection_dir_count_by_purpose_resource_and_state", "calls": ["smartlist_free", "connection_dir_list_by_purpose_resource_and_state"]}, {"name": "connection_mark_for_close_", "calls": ["TO_OR_CONN", "connection_mark_for_close_internal_", "tor_assertion_failed_", "assert_connection_ok", "connection_or_close_for_error", "log_fn_"]}, {"name": "circuitmux_assert_okay", "calls": ["circuitmux_assert_okay_pass_two", "tor_assertion_failed_", "circuitmux_assert_okay_pass_one", "circuitmux_assert_okay_pass_three"]}, {"name": "command_process_create_cell", "calls": ["get_options", "node_describe", "channel_send_destroy", "onionskin_answer", "circuit_mark_for_close_", "assign_onionskin_to_cpuworker", "create_cell_parse", "node_get_platform", "channel_is_outgoing", "circuit_id_in_use_on_channel", "channel_when_created", "tor_assertion_failed_", "tor_malloc_zero_", "server_mode", "or_circuit_new", "node_get_by_id", "rep_hist_note_circuit_handshake_requested", "channel_mark_client", "public_server_mode", "connection_or_digest_is_known_relay", "we_are_hibernating", "memwipe", "esc_for_log", "circuit_set_state", "onion_skin_server_handshake", "log_fn_"]}, {"name": "tor_tls_get_my_certs", "calls": []}, {"name": "rep_hist_note_dir_bytes_read", "calls": ["add_obs"]}, {"name": "get_current_link_cert_cert", "calls": []}, {"name": "crypto_rand", "calls": ["crypto_rand_unmocked"]}, {"name": "parse_http_response", "calls": ["smartlist_free", "TOR_ISSPACE", "smartlist_split_string", "tor_assertion_failed_", "parse_rfc1123_time", "escaped", "tor_sscanf", "strlcpy", "strcmpstart", "smartlist_new", "log_fn_"]}, {"name": "dircollator_get_votes_for_router", "calls": ["digestmap_get", "tor_assertion_failed_"]}, {"name": "tor_tls_unblock_renegotiation", "calls": []}, {"name": "circuit_stream_is_being_handled", "calls": ["get_options", "smartlist_contains_int_as_string", "circuit_get_global_list", "connection_ap_can_use_exit", "compare_tor_addr_to_node_policy", "build_state_get_exit_node", "TO_ORIGIN_CIRCUIT"]}, {"name": "exit_policy_is_general_exit_helper", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_is_internal_", "tor_addr_to_ipv4h", "tor_addr_from_ipv4n"]}, {"name": "onion_skin_ntor_create", "calls": ["curve25519_secret_key_generate", "curve25519_public_key_generate", "tor_assertion_failed_", "tor_malloc_zero_"]}, {"name": "scheduler_channel_has_waiting_cells", "calls": ["tor_assertion_failed_", "scheduler_retrigger", "log_fn_"]}, {"name": "free_link_history_", "calls": []}, {"name": "tor_addr_is_internal_", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_to_ipv4h", "tor_addr_is_v4", "tor_addr_to_in6", "log_fn_"]}, {"name": "tor_malloc_", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "routerstatus_parse_entry_from_string", "calls": ["smartlist_free", "find_by_keyword_", "digest_from_base64", "memarea_clear", "tor_snprintf", "escaped", "smartlist_string_pos", "routerstatus_free", "tor_version_as_new_as", "find_start_of_next_routerstatus", "strlcpy", "tor_parse_ulong", "tor_strdup_", "routerstatus_parse_guardfraction", "strcmpstart", "fmt_addr32", "find_single_ipv6_orport", "tor_inet_aton", "parse_iso_time", "hex_str", "tor_assertion_failed_", "find_opt_by_keyword", "tor_malloc_", "is_legal_nickname", "smartlist_clear", "find_all_by_keyword", "tor_malloc_zero_", "tokenize_string", "tor_parse_long", "dump_desc", "digest256_from_base64", "token_clear", "log_fn_"]}, {"name": "node_nickname_matches", "calls": ["hex_digest_nickname_matches", "node_get_nickname", "node_is_named"]}, {"name": "channel_tls_connect", "calls": ["channel_mark_remote", "channel_tls_common_init", "tor_malloc_zero_", "connection_or_connect", "channel_mark_local", "channel_register", "channel_change_state", "is_local_addr", "channel_mark_outgoing", "log_fn_"]}, {"name": "router_get_dl_status_by_descriptor_digest", "calls": ["router_get_mutable_consensus_status_by_descriptor_digest"]}, {"name": "networkstatus_get_latest_consensus_by_flavor", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_get_by_circid_channel", "calls": ["circuit_get_by_circid_channel_impl"]}, {"name": "append_address_to_payload", "calls": ["tor_addr_to_ipv4n", "tor_addr_family", "tor_addr_to_in6"]}, {"name": "tor_join_win_cmdline", "calls": ["smartlist_free", "smartlist_add", "smartlist_join_strings", "smartlist_new", "format_win_cmdline_argument"]}, {"name": "update_router_descriptor_downloads", "calls": ["get_options", "should_delay_dir_fetches", "networkstatus_get_reasonably_live_consensus", "update_consensus_router_descriptor_downloads", "we_fetch_router_descriptors"]}, {"name": "set_constrained_socket_buffers", "calls": ["log_fn_"]}, {"name": "bw_arrays_init", "calls": ["bw_array_new", "bw_array_free"]}, {"name": "get_total_system_memory", "calls": ["get_total_system_memory_impl"]}, {"name": "control_event_client_error", "calls": ["queued_events_flush_all", "control_event_status"]}, {"name": "dirserv_generate_networkstatus_vote_obj", "calls": ["get_options", "rep_hist_make_router_pessimal", "smartlist_free", "running_long_enough_to_decide_unreachable", "digestmap_iter_done", "smartlist_add_all", "dirserv_read_measured_bandwidths", "dirserv_compute_performance_thresholds", "tor_malloc_zero_", "dirvote_get_preferred_voting_intervals", "get_microdesc_cache", "smartlist_sort_strings", "routers_sort_by_identity", "dirserv_set_router_is_running", "get_my_v3_legacy_cert", "validate_recommended_package_line", "digestmap_get", "dirserv_count_measured_bws", "node_get_mutable_by_id", "set_routerstatus_from_routerinfo", "dirserv_clear_measured_bw_cache", "dirvote_format_all_microdesc_vote_lines", "clear_status_flags_on_sybil", "dirserv_read_guardfraction_file", "smartlist_new", "authority_cert_dup", "networkstatus_get_live_consensus", "smartlist_split_string", "get_possible_sybil_list", "tor_strdup_", "smartlist_add", "tor_assertion_failed_", "router_get_advertised_or_port", "resolve_my_address", "microdescs_add_list_to_cache", "version_from_platform", "format_versions_list", "digestmap_iter_init", "digestmap_iter_next", "router_get_routerlist", "digestmap_iter_get", "tor_dup_ip", "format_iso_time", "crypto_pk_get_digest", "router_get_advertised_dir_port", "dirvote_get_start_of_next_interval", "dirserv_get_measured_bw_cache_size", "log_fn_"]}, {"name": "get_master_signing_key_cert", "calls": []}, {"name": "rend_service_free_all", "calls": ["smartlist_free", "rend_service_free"]}, {"name": "document_signature_dup", "calls": ["tor_memdup_"]}, {"name": "stream_status_to_string", "calls": []}, {"name": "options_transition_affects_descriptor", "calls": ["opt_streq", "get_effective_bwburst", "config_lines_eq", "public_server_mode", "get_effective_bwrate"]}, {"name": "networkstatus_reset_download_failures", "calls": ["download_status_reset"]}, {"name": "rsamap_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "parse_ports", "calls": ["check_server_ports", "smartlist_free", "tor_strdup_", "smartlist_new", "count_real_listeners", "port_cfg_free", "parse_port_config"]}, {"name": "router_digest_is_trusted_dir_type", "calls": ["get_options", "router_digest_is_me", "authdir_mode", "tor_memeq"]}, {"name": "microdesc_wipe_body", "calls": []}, {"name": "router_add_exit_policy", "calls": ["addr_policy_free", "smartlist_add", "router_parse_addr_policy", "tor_addr_family", "smartlist_new", "log_fn_"]}, {"name": "getinfo_helper_entry_guards", "calls": ["smartlist_free", "base16_encode", "smartlist_add_asprintf", "format_iso_time", "smartlist_join_strings", "node_get_by_id", "node_get_verbose_nickname", "smartlist_new"]}, {"name": "rep_hist_note_extend_succeeded", "calls": ["get_link_history"]}, {"name": "connection_edge_package_raw_inbuf", "calls": ["connection_edge_send_command", "write_to_buf", "buf_new", "connection_stop_reading", "circuit_consider_stop_edge_reading", "connection_get_inbuf_len", "connection_fetch_from_buf", "buf_free", "circuit_get_by_edge_conn", "EDGE_TO_ENTRY_CONN", "buf_datalen", "fetch_from_buf", "tor_assertion_failed_", "log_fn_"]}, {"name": "decide_to_advertise_dirport", "calls": ["net_is_disabled", "authdir_mode", "check_whether_dirport_reachable", "router_get_advertised_dir_port", "router_should_be_directory_server"]}, {"name": "control_event_hs_descriptor_uploaded", "calls": ["control_event_hs_descriptor_upload_end", "log_fn_"]}, {"name": "tor_tls_free", "calls": ["tor_assertion_failed_", "tor_tls_get_n_raw_bytes", "tor_tls_context_decref"]}, {"name": "escaped_safe_str_client", "calls": ["escaped", "get_options"]}, {"name": "dirreqmap_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "control_event_networkstatus_changed", "calls": ["control_event_networkstatus_changed_helper"]}, {"name": "onion_num_pending", "calls": []}, {"name": "string_is_C_identifier", "calls": ["TOR_ISALPHA", "TOR_ISDIGIT"]}, {"name": "circuit_build_times_add_time", "calls": ["get_options", "or_state_mark_dirty", "get_or_state", "log_fn_"]}, {"name": "connection_is_listener", "calls": []}, {"name": "rend_parse_introduction_points", "calls": ["tor_memstr", "smartlist_free", "find_by_keyword_", "memarea_clear", "tor_addr_family", "escaped", "rend_intro_point_free", "tor_assertion_failed_", "smartlist_add", "crypto_pk_public_exponent_ok", "tor_malloc_zero_", "memarea_drop_all", "smartlist_clear", "base16_encode", "tor_addr_parse", "memarea_new", "tokenize_string", "tor_parse_long", "base32_decode", "fast_memcmpstart", "smartlist_new", "token_clear", "log_fn_"]}, {"name": "connection_get_inbuf_len", "calls": ["buf_datalen"]}, {"name": "connection_or_set_state_open", "calls": ["control_event_or_conn_status", "or_handshake_state_free", "connection_start_reading", "connection_or_change_state"]}, {"name": "routerlist_find_my_routerinfo", "calls": ["router_is_me"]}, {"name": "find_largest_max", "calls": []}, {"name": "channel_tls_is_canonical_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_"]}, {"name": "rend_config_services", "calls": ["smartlist_free", "smartlist_add_all", "smartlist_del", "check_private_dir", "circuit_mark_for_close_", "rend_service_free", "safe_str_client", "tor_strdup_", "smartlist_sort_strings", "extend_info_describe", "rend_service_parse_port_config", "smartlist_split_string", "smartlist_add", "tor_assertion_failed_", "rend_add_service", "tor_malloc_zero_", "circuit_get_global_list", "TO_ORIGIN_CIRCUIT", "smartlist_uniq_strings", "tor_memeq", "smartlist_clear", "smartlist_new", "tor_parse_long", "log_fn_"]}, {"name": "getinfo_helper_misc", "calls": ["get_options", "directory_dump_request_log", "smartlist_free", "get_bw_samples", "tor_getpwuid", "get_bytes_written", "get_version", "options_dump", "rep_hist_circbuilding_dormant", "get_torrc_fname", "smartlist_join_strings", "list_getinfo_options", "tor_asprintf", "tor_strdup_", "smartlist_add", "get_max_sockets", "server_mode", "tor_malloc_", "router_pick_published_address", "get_server_identity_key", "tor_dup_ip", "smartlist_new", "get_bytes_read", "crypto_pk_get_fingerprint"]}, {"name": "smartlist_pqueue_pop", "calls": ["tor_assertion_failed_"]}, {"name": "secret_to_key_rfc2440", "calls": ["tor_assertion_failed_", "crypto_digest_free", "memwipe", "tor_malloc_", "crypto_expand_key_material_rfc5869_sha256", "crypto_digest_new", "crypto_digest_add_bytes", "crypto_digest_get_digest"]}, {"name": "digest256map_iter_next_rmv", "calls": ["digest256map_entry_free", "digest256map_impl_HT_NEXT_RMV", "tor_assertion_failed_"]}, {"name": "routerkeys_free_all", "calls": ["tor_cert_free", "ed25519_keypair_free"]}, {"name": "circuit_testing_opened", "calls": ["consider_testing_reachability", "circuit_enough_testing_circs", "circuit_mark_for_close_", "router_perform_bandwidth_test", "check_whether_orport_reachable"]}, {"name": "connection_control_reached_eof", "calls": ["tor_assertion_failed_", "connection_mark_for_close_", "log_fn_"]}, {"name": "remove_cell_ewma", "calls": ["smartlist_pqueue_remove", "tor_assertion_failed_"]}, {"name": "init_keys_client", "calls": ["init_keys_common", "crypto_pk_free", "router_initialize_tls_context", "set_client_identity_key", "crypto_pk_generate_key_with_bits", "crypto_pk_new", "log_fn_"]}, {"name": "save_transport_to_state", "calls": ["get_options", "get_transport_bindaddr", "fmt_addrport", "get_transport_in_state_by_name", "or_state_mark_dirty", "tor_strdup_", "tor_malloc_zero_", "get_or_state", "tor_asprintf", "log_fn_"]}, {"name": "learned_bridge_descriptor", "calls": ["get_options", "entry_guard_register_connect_status", "hex_str", "routerlist_retry_directory_downloads", "get_configured_bridge_by_routerinfo", "rewrite_node_address_for_bridge", "add_an_entry_guard", "router_describe", "tor_assertion_failed_", "num_bridges_usable", "node_get_mutable_by_id", "router_set_status", "fmt_addr_impl", "download_status_reset", "tor_digest_is_zero", "log_fn_"]}, {"name": "hibernate_go_dormant", "calls": ["TO_OR_CONN", "channel_tls_to_base", "hibernate_begin", "get_or_state", "or_state_mark_dirty", "get_options", "connection_get_by_type", "accounting_record_bandwidth_usage", "TO_ENTRY_CONN", "connection_mark_for_close_", "connection_edge_end", "TO_EDGE_CONN", "log_fn_", "connection_mark_unattached_ap_"]}, {"name": "tor_validate_process_specifier", "calls": ["parse_process_specifier", "tor_assertion_failed_"]}, {"name": "rend_cache_store_v2_desc_as_dir", "calls": ["get_options", "rend_service_descriptor_free", "hid_serv_responsible_for_desc_id", "digestmap_set", "hid_serv_acting_as_directory", "rend_cache_entry_allocation", "rend_parse_v2_service_descriptor", "safe_str_client", "safe_str", "tor_strndup_", "digestmap_get", "strcmpstart", "approx_time", "tor_assertion_failed_", "tor_malloc_zero_", "rend_cache_decrement_allocation", "base32_encode", "rep_hist_stored_maybe_new_hs", "rend_cache_increment_allocation", "log_fn_"]}, {"name": "tor_addr_compare_masked", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_to_ipv4h", "tor_memcmp", "tor_addr_is_v4", "tor_addr_to_in6", "tor_addr_to_mapped_ipv4h"]}, {"name": "onion_skin_create", "calls": ["onion_skin_TAP_create", "onion_skin_ntor_create", "log_fn_", "tor_mem_is_zero", "fast_onionskin_create"]}, {"name": "sandbox_free_getaddrinfo_cache", "calls": ["cached_getaddrinfo_item_free", "getaddrinfo_cache_HT_NEXT_RMV", "getaddrinfo_cache_HT_CLEAR", "getaddrinfo_cache_HT_START"]}, {"name": "connection_or_write_var_cell_to_buf", "calls": ["channel_tls_to_base", "channel_timestamp_active", "var_cell_pack_header", "or_handshake_state_record_var_cell", "tor_assertion_failed_", "connection_write_to_buf"]}, {"name": "networkstatus_free_all", "calls": ["networkstatus_vote_free"]}, {"name": "rep_hist_buffer_stats_init", "calls": []}, {"name": "process_map_HT_REP_IS_BAD_", "calls": ["process_map_entry_hash_"]}, {"name": "sweep_bridge_list", "calls": ["smartlist_del", "smartlist_new", "bridge_free"]}, {"name": "chanid_circid_muxinfo_map_HT_INSERT", "calls": ["chanid_circid_entry_hash", "chanid_circid_muxinfo_map_HT_GROW"]}, {"name": "hid_serv_responsible_for_desc_id", "calls": ["router_get_my_routerinfo", "smartlist_free", "hid_serv_get_responsible_directories", "hid_serv_acting_as_directory", "smartlist_new", "rend_id_is_in_interval"]}, {"name": "routers_sort_by_identity", "calls": ["smartlist_sort"]}, {"name": "get_options_from_transport_options_line", "calls": ["smartlist_free", "smartlist_split_string", "string_is_key_value", "smartlist_add", "escaped", "tor_strdup_", "smartlist_new", "log_fn_"]}, {"name": "addr_is_in_cc_list", "calls": ["smartlist_contains_string_case", "geoip_get_country_by_addr", "geoip_get_country_name", "tor_addr_from_ipv4n"]}, {"name": "connection_dir_retry_bridges", "calls": ["escaped", "base16_decode", "retry_bridge_descriptor_fetch_directly", "log_fn_"]}, {"name": "proxy_type_to_string", "calls": ["tor_assertion_failed_"]}, {"name": "clear_waitpid_callback", "calls": ["process_map_HT_REMOVE", "log_fn_"]}, {"name": "n_cells_in_circ_queues", "calls": ["TO_OR_CIRCUIT"]}, {"name": "control_event_hs_descriptor_upload_end", "calls": ["send_control_event", "node_describe_longname_by_id", "tor_asprintf", "log_fn_"]}, {"name": "get_cached_network_liveness", "calls": []}, {"name": "smartlist_del", "calls": ["tor_assertion_failed_"]}, {"name": "policies_parse_from_options", "calls": ["parse_reachable_addresses", "load_policy_from_option"]}, {"name": "sb_time", "calls": []}, {"name": "connection_get_by_type_state", "calls": ["get_connection_array"]}, {"name": "dumpstats", "calls": ["TO_OR_CONN", "channel_listener_dumpstats", "rep_hist_dump_stats", "conn_state_to_string", "tor_tls_get_buffer_sizes", "conn_type_to_string", "connection_is_listener", "tor_log", "connection_get_inbuf_len", "connection_get_outbuf_len", "rend_service_dump_stats", "channel_dumpstats", "dump_pk_ops", "dump_distinct_digest_count", "cpuworker_log_onionskin_overhead", "safe_str_client", "buf_allocation", "dumpmemusage", "circuit_dump_by_conn"]}, {"name": "nodelist_map_HT_INIT", "calls": []}, {"name": "connection_init_accepted_conn", "calls": ["TO_OR_CONN", "control_event_or_conn_status", "connection_ext_or_start_auth", "connection_tls_start_handshake", "TO_ENTRY_CONN", "connection_start_reading", "get_signewnym_epoch", "connection_ap_process_transparent", "connection_or_close_for_error"]}, {"name": "circuitmux_clear_policy", "calls": ["tor_assertion_failed_"]}, {"name": "connection_expire_held_open", "calls": ["conn_state_to_string", "conn_type_to_string", "get_connection_array", "tor_assertion_failed_", "log_fn_"]}, {"name": "set_uint16", "calls": []}, {"name": "cached_resolve_add_answer", "calls": ["tor_addr_to_ipv4h", "tor_addr_family", "tor_addr_to_in6", "tor_strdup_"]}, {"name": "or_connection_new", "calls": ["connection_or_set_canonical", "tor_assertion_failed_", "connection_or_set_ext_or_identifier", "tor_malloc_zero_", "connection_init"]}, {"name": "chanid_circid_muxinfo_map_HT_REP_IS_BAD_", "calls": ["chanid_circid_entry_hash"]}, {"name": "channel_listener_timestamp_created", "calls": ["tor_assertion_failed_"]}, {"name": "config_assign_value", "calls": ["smartlist_free", "routerset_new", "routerset_parse", "tor_strdup_", "config_parse_msec_interval", "config_line_append", "config_free_lines", "tor_asprintf", "parse_iso_time", "smartlist_split_string", "smartlist_add", "tor_assertion_failed_", "tor_malloc_zero_", "routerset_free", "smartlist_clear", "config_find_option", "smartlist_new", "config_parse_interval", "config_parse_memunit", "tor_parse_long", "log_fn_"]}, {"name": "configure_accounting", "calls": ["accounting_set_wakeup_time", "length_of_accounting_period_containing", "start_of_accounting_period_containing", "start_of_accounting_period_after", "read_bandwidth_usage", "reset_accounting", "log_fn_"]}, {"name": "validate_addr_policies", "calls": ["policy_is_reject_star", "tor_strdup_", "server_mode", "policies_parse_exit_policy_from_options", "addr_policy_list_free", "parse_addr_policy", "log_fn_"]}, {"name": "get_fingerprint", "calls": ["crypto_new_pk_from_rsa_", "crypto_pk_get_fingerprint", "crypto_pk_free"]}, {"name": "channel_tls_from_base", "calls": ["tor_assertion_failed_"]}, {"name": "geoip_ipv4_compare_key_to_entry_", "calls": []}, {"name": "crypto_xof_add_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "routerset_len", "calls": []}, {"name": "connection_ap_expire_beginning", "calls": ["get_options", "mark_circuit_unusable_for_new_conns", "conn_state_to_string", "compute_retry_timeout", "connection_edge_end", "get_connection_array", "tor_addr_is_null", "circuit_state_to_string", "safe_str_client", "TO_ENTRY_CONN", "extend_info_describe", "pathbias_mark_use_rollback", "log_fn_", "circuit_get_by_edge_conn", "circuit_purpose_to_string", "TO_ORIGIN_CIRCUIT", "connection_ap_detach_retriable", "pathbias_state_to_string", "connection_mark_unattached_ap_"]}, {"name": "router_load_extrainfo_from_string", "calls": ["routerlist_assert_ok", "smartlist_free", "hex_str", "base16_encode", "download_status_mark_impossible", "router_get_routerlist", "WRA_NEVER_DOWNLOADABLE", "router_rebuild_store", "WRA_WAS_ADDED", "smartlist_contains_string", "smartlist_string_remove", "router_add_extrainfo_to_routerlist", "router_get_by_extrainfo_digest", "smartlist_new", "router_parse_list_from_string", "log_fn_"]}, {"name": "dirserv_load_fingerprint_file", "calls": ["get_options", "read_file_to_str", "directory_remove_invalid", "authdir_config_new", "config_get_lines", "config_free_lines", "tor_strstrip", "options_get_datadir_fname2_suffix", "base16_decode", "dirserv_free_fingerprint_list", "add_fingerprint_to_dir", "log_fn_"]}, {"name": "rend_add_service", "calls": ["rend_service_free", "fmt_addrport", "smartlist_add", "rend_service_escaped_dir", "smartlist_new", "log_fn_"]}, {"name": "microdesc_map_HT_NEXT_RMV", "calls": []}, {"name": "inform_pending_connections", "calls": ["circuit_detach_stream", "connection_exit_connect", "send_resolved_hostname_cell", "set_exitconn_info_from_resolve", "tor_assertion_failed_", "TO_OR_CIRCUIT", "send_resolved_cell", "assert_connection_ok", "circuit_get_by_edge_conn", "connection_free", "connection_edge_end"]}, {"name": "assert_buf_ok", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "n_bits_set_u8", "calls": []}, {"name": "circuit_remove_handled_ports", "calls": ["circuit_stream_is_being_handled", "tor_assertion_failed_", "smartlist_del", "log_fn_"]}, {"name": "connection_edge_compatible_with_circuit", "calls": ["tor_strdup_", "memeq_opt", "tor_addr_compare", "log_fn_"]}, {"name": "rend_client_purge_last_hid_serv_requests", "calls": ["log_fn_"]}, {"name": "circuit_dump_by_conn", "calls": ["TO_ORIGIN_CIRCUIT", "TO_OR_CIRCUIT", "circuit_get_global_list", "circuit_dump_conn_details"]}, {"name": "rend_cache_free_all", "calls": []}, {"name": "connection_or_nonopen_was_started_here", "calls": ["tor_assertion_failed_", "tor_tls_is_server"]}, {"name": "connection_control_closed", "calls": ["control_update_global_event_mask", "tor_assertion_failed_", "lost_owning_controller", "rend_service_del_ephemeral"]}, {"name": "circuit_build_times_min_timeout", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "smartlist_remove", "calls": []}, {"name": "should_record_bridge_info", "calls": []}, {"name": "router_describe", "calls": ["router_get_description"]}, {"name": "channel_tls_has_queued_writes_method", "calls": ["channel_tls_from_base", "connection_get_outbuf_len", "tor_assertion_failed_", "log_fn_"]}, {"name": "fp_pair_map_impl_HT_INSERT", "calls": ["fp_pair_map_impl_HT_GROW", "fp_pair_map_entry_hash"]}, {"name": "getinfo_helper_events", "calls": ["get_options", "smartlist_free", "orconn_target_get_name", "networkstatus_get_latest_consensus", "get_connection_array", "get_n_authorities", "tor_version_is_obsolete", "write_stream_target_to_buf", "check_whether_dirport_reachable", "check_whether_orport_reachable", "TO_OR_CONN", "addressmap_get_mappings", "have_completed_a_circuit", "tor_strdup_", "smartlist_add_asprintf", "circuit_get_by_edge_conn", "smartlist_join_strings", "strcmpstart", "tor_asprintf", "smartlist_new", "router_have_minimum_dir_info", "extrainfo_free", "tor_assertion_failed_", "tor_malloc_", "routerinfo_free", "TO_ENTRY_CONN", "circuit_get_global_list", "directories_have_accepted_server_descriptor", "TO_ORIGIN_CIRCUIT", "router_build_fresh_descriptor", "signed_descriptor_get_body", "server_mode", "geoip_get_bridge_stats_controller", "circuit_describe_status_for_controller", "log_fn_"]}, {"name": "sandbox_cfg_allow_openat_filename", "calls": ["new_element", "log_fn_"]}, {"name": "client_would_use_router", "calls": []}, {"name": "threadpool_queue_work", "calls": ["tor_mutex_release", "tor_cond_signal_one", "workqueue_entry_new", "tor_mutex_acquire"]}, {"name": "tor_tls_get_ciphersuite_name", "calls": []}, {"name": "handle_signals", "calls": ["tor_libevent_get_base", "log_fn_"]}, {"name": "tor_memcmp", "calls": []}, {"name": "worker_state_new", "calls": ["server_onion_keys_new", "tor_malloc_zero_"]}, {"name": "sandbox_cfg_allow_stat_filename", "calls": ["new_element", "log_fn_"]}, {"name": "config_reset", "calls": ["config_clear", "tor_strdup_", "tor_assertion_failed_", "tor_malloc_zero_", "config_free_lines", "config_assign_value", "log_fn_"]}, {"name": "flush_log_messages_from_startup", "calls": ["logfile_wants_message", "smartlist_free", "tor_mutex_acquire", "tor_mutex_release", "pending_log_message_free"]}, {"name": "replaycache_scrub_if_needed_internal", "calls": ["digest256map_iter_next_rmv", "digest256map_iter_init", "digest256map_iter_get", "digest256map_iter_done", "digest256map_iter_next", "log_fn_"]}, {"name": "run_main_loop_once", "calls": ["connection_ap_attach_pending", "got_libevent_error", "update_approx_time", "tor_libevent_get_base", "tor_libevent_get_method", "log_fn_"]}, {"name": "directory_clean_last_hid_serv_requests", "calls": ["strmap_iter_get", "strmap_iter_init", "strmap_iter_done", "strmap_iter_next_rmv", "strmap_iter_next", "get_last_hid_serv_requests"]}, {"name": "get_current_auth_keypair", "calls": []}, {"name": "connection_exit_begin_conn", "calls": ["get_options", "rend_service_set_connection_addr_port", "connection_exit_connect", "relay_header_unpack", "connection_or_digest_is_known_relay", "tor_strdup_", "safe_str", "dns_resolve", "tor_strlower", "connection_exit_connect_dir", "relay_send_end_cell_from_edge", "assert_circuit_ok", "begin_cell_parse", "rend_data_dup", "tor_assertion_failed_", "server_mode", "connection_free", "directory_permits_begindir_requests", "TO_ORIGIN_CIRCUIT", "should_refuse_unknown_exits", "tor_addr_copy", "connection_edge_is_rendezvous_stream", "TO_OR_CIRCUIT", "pathbias_mark_use_success", "edge_connection_new", "we_are_hibernating", "log_fn_"]}, {"name": "crypto_pk_asn1_encode", "calls": []}, {"name": "tor_zlib_new", "calls": ["tor_zlib_state_size_precalc", "get_memlevel", "method_bits", "tor_malloc_zero_", "is_gzip_supported", "log_fn_"]}, {"name": "get_time_period", "calls": []}, {"name": "dirserv_get_consensus", "calls": ["strmap_get"]}, {"name": "geoip_load_file", "calls": ["geoip_parse_entry", "get_options", "smartlist_free", "tor_assertion_failed_", "options_need_geoip_info", "smartlist_sort", "tor_fopen_cloexec", "crypto_digest_free", "init_geoip_countries", "crypto_digest_new", "refresh_all_country_info", "crypto_digest_add_bytes", "smartlist_new", "crypto_digest_get_digest", "log_fn_"]}, {"name": "circuit_build_times_update_alpha", "calls": ["tor_assertion_failed_", "tor_mathlog", "circuit_build_times_get_xm", "log_fn_"]}, {"name": "connection_ap_fail_onehop", "calls": ["tor_digest_is_zero", "tor_addr_compare", "hexdigest_to_digest", "get_connection_array", "TO_ENTRY_CONN", "tor_addr_parse", "connection_mark_unattached_ap_", "tor_memeq", "log_fn_"]}, {"name": "connection_ap_handshake_attach_circuit", "calls": ["get_options", "rend_client_send_introduction", "assert_circuit_ok", "connection_ap_handshake_send_begin", "connection_edge_is_rendezvous_stream", "tor_assertion_failed_", "connection_ap_handshake_attach_chosen_circuit", "connection_ap_can_use_exit", "tor_addr_is_null", "circuit_get_open_circ_or_launch", "circuit_log_path", "node_get_by_nickname", "link_apconn_to_circ", "safe_str_client", "pathbias_count_use_attempt", "log_fn_"]}, {"name": "onion_queue_entry_remove", "calls": ["log_fn_"]}, {"name": "dimap_add_entry", "calls": ["dimap_search", "tor_malloc_zero_", "tor_assertion_failed_"]}, {"name": "tor_addr_copy_tight", "calls": ["tor_assertion_failed_", "tor_addr_family"]}, {"name": "circuit_launch", "calls": ["circuit_launch_by_extend_info"]}, {"name": "chanid_circid_muxinfo_map_HT_REMOVE", "calls": ["chanid_circid_entry_hash", "chanid_circid_muxinfo_map_HT_FIND_P_"]}, {"name": "connection_init", "calls": ["connection_is_listener", "buf_new"]}, {"name": "dircollator_collate", "calls": ["dircollator_collate_by_rsa", "dircollator_collate_by_ed25519", "tor_assertion_failed_", "smartlist_new", "smartlist_sort_digests"]}, {"name": "set_unix_port", "calls": ["tor_addr_make_unspec", "tor_strdup_", "tor_assertion_failed_"]}, {"name": "tor_process_monitor_new", "calls": ["tor_process_monitor_free", "tor_assertion_failed_", "tor_malloc_zero_", "parse_process_specifier"]}, {"name": "parse_create2_payload", "calls": ["create_cell_init", "get_uint16"]}, {"name": "write_ni", "calls": []}, {"name": "geoip_get_n_countries", "calls": ["init_geoip_countries"]}, {"name": "sandbox_cfg_allow_open_filename", "calls": ["new_element", "log_fn_"]}, {"name": "circuit_queue_streams_are_blocked", "calls": []}, {"name": "write_pidfile", "calls": ["log_fn_"]}, {"name": "channel_get_global_queue_estimate", "calls": []}, {"name": "compare_string_ptrs_", "calls": []}, {"name": "networkstatus_parse_flavor_name", "calls": []}, {"name": "routerstatus_parse_guardfraction", "calls": ["tor_assertion_failed_", "should_apply_guardfraction", "escaped", "tor_parse_ulong", "log_fn_"]}, {"name": "tor_strlower", "calls": []}, {"name": "rend_authorized_client_free", "calls": ["memwipe", "crypto_pk_free"]}, {"name": "connection_ap_handshake_rewrite", "calls": ["get_options", "tor_snprintf", "escaped", "addressmap_rewrite", "escaped_safe_str_client", "safe_str_client", "tor_addr_parse_PTR_name", "control_event_client_status", "addressmap_rewrite_reverse", "connection_ap_handshake_socks_resolved", "addressmap_address_should_automap", "addressmap_register_virtual_address", "escaped_safe_str", "tor_strlower", "tor_strdup_", "tor_addr_is_internal_", "strlcpy", "strcmpend", "tor_addr_parse", "address_is_in_virtual_range", "control_event_stream_status", "log_fn_"]}, {"name": "config_parse_unix_port", "calls": ["tor_assertion_failed_", "strcmpstart", "tor_strdup_"]}, {"name": "compare_tor_version_str_ptr_", "calls": ["tor_version_parse", "tor_version_compare"]}, {"name": "config_load_geoip_file_", "calls": ["geoip_load_file"]}, {"name": "get_transport_in_state_by_name", "calls": ["smartlist_free", "smartlist_split_string", "tor_assertion_failed_", "get_or_state", "smartlist_new"]}, {"name": "router_is_named", "calls": ["networkstatus_get_router_digest_by_nickname", "tor_memeq"]}, {"name": "router_pick_fallback_dirserver", "calls": ["router_pick_dirserver_generic"]}, {"name": "dirserv_thinks_router_is_hs_dir", "calls": ["get_options", "router_is_active", "real_uptime", "rep_hist_get_uptime"]}, {"name": "check_tap_onion_key_crosscert", "calls": ["crypto_pk_keysize", "tor_malloc_", "crypto_pk_public_checksig", "tor_memeq", "log_fn_"]}, {"name": "rep_hist_note_circuit_handshake_assigned", "calls": []}, {"name": "send_resolved_cell", "calls": ["strlcpy", "connection_edge_send_command", "tor_assertion_failed_", "set_uint32", "dns_clip_ttl"]}, {"name": "policy_summary_reject", "calls": ["policy_summary_split", "tor_assertion_failed_"]}, {"name": "socket_accounting_unlock", "calls": ["tor_mutex_release"]}, {"name": "smartlist_subtract", "calls": ["smartlist_remove"]}, {"name": "round_to_next_multiple_of", "calls": ["tor_assertion_failed_"]}, {"name": "connection_ap_get_original_destination", "calls": ["destination_from_socket"]}, {"name": "socks_policy_permits_address", "calls": ["addr_policy_permits_tor_addr"]}, {"name": "config_parse_interval", "calls": ["config_parse_units", "log_fn_"]}, {"name": "rend_parse_client_keys", "calls": ["smartlist_free", "find_by_keyword_", "memarea_clear", "memarea_drop_all", "strmap_set", "strmap_size", "eat_whitespace", "strcmpstart", "tor_strdup_", "tor_assertion_failed_", "smartlist_clear", "tor_malloc_zero_", "escaped", "find_opt_by_keyword", "strmap_get", "memarea_new", "tokenize_string", "base64_decode", "smartlist_new", "token_clear", "log_fn_"]}, {"name": "connection_or_close_normally", "calls": ["channel_tls_to_base", "connection_mark_for_close_internal_", "channel_is_in_state", "tor_assertion_failed_", "channel_close_from_lower_layer"]}, {"name": "consensus_is_waiting_for_certs", "calls": ["usable_consensus_flavor"]}, {"name": "check_or_create_data_subdir", "calls": ["get_options", "check_private_dir", "options_get_datadir_fname2_suffix", "log_fn_"]}, {"name": "handle_control_getconf", "calls": ["get_options", "smartlist_free", "option_get_canonical_name", "option_is_recognized", "smartlist_add", "tor_assertion_failed_", "smartlist_add_asprintf", "connection_write_to_buf", "connection_write_str_to_buf", "smartlist_join_strings", "connection_printf_to_buf", "smartlist_split_string", "option_get_assignment", "smartlist_new"]}, {"name": "entry_guard_set_status", "calls": ["base16_encode", "control_event_guard", "node_is_dir", "routerset_contains_node", "node_is_a_configured_bridge", "log_fn_"]}, {"name": "digest256map_impl_HT_REMOVE", "calls": ["digest256map_impl_HT_FIND_P_", "digest256map_entry_hash"]}, {"name": "base16_decode", "calls": ["hex_decode_digit_"]}, {"name": "stream_end_reason_to_control_string", "calls": []}, {"name": "node_handles_some_port", "calls": ["tor_assertion_failed_", "compare_tor_addr_to_node_policy"]}, {"name": "routerlist_free_all", "calls": ["smartlist_free", "clear_dir_servers", "routerlist_free"]}, {"name": "get_interface_address6_via_udp_socket_hack", "calls": ["tor_connect_socket", "tor_getsockname", "tor_close_socket", "tor_open_socket", "tor_addr_is_loopback", "tor_addr_is_multicast", "tor_addr_from_sockaddr", "log_fn_"]}, {"name": "rend_service_port_config_free", "calls": []}, {"name": "nodelist_map_HT_REP_IS_BAD_", "calls": ["node_id_hash"]}, {"name": "onion_handshake_state_release", "calls": ["ntor_handshake_state_free", "crypto_dh_free", "fast_handshake_state_free", "log_fn_"]}, {"name": "digestmap_iter_done", "calls": []}, {"name": "directory_caches_dir_info", "calls": ["should_refuse_unknown_exits", "dir_server_mode", "advertised_server_mode", "server_mode", "router_my_exit_policy_is_reject_star"]}, {"name": "channel_tls_handle_incoming", "calls": ["channel_mark_remote", "channel_tls_common_init", "log_fn_", "tor_malloc_zero_", "channel_mark_local", "channel_register", "is_local_addr", "tor_assertion_failed_", "channel_mark_incoming"]}, {"name": "channel_listener_timestamp_accepted", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_get_open_circ_or_launch", "calls": ["get_options", "rend_client_refetch_v2_renddesc", "circuit_launch_by_extend_info", "routerlist_retry_directory_downloads", "count_pending_general_client_circuits", "connection_get_by_type", "rep_hist_note_used_internal", "circuit_get_open_circ_or_launch", "router_exit_policy_all_nodes_reject", "conn_state_to_string", "entry_list_is_constrained", "escaped_safe_str_client", "router_have_minimum_dir_info", "rate_limit_log", "safe_str_client", "connection_edge_update_circuit_isolation", "extend_info_free", "have_enough_path_info", "extend_info_describe", "tor_addr_from_ipv4n", "node_has_descriptor", "approx_time", "any_bridge_descriptors_known", "tor_inet_aton", "connection_ap_mark_as_non_pending_circuit", "rend_data_dup", "tor_assertion_failed_", "extend_info_new", "smartlist_contains_int_as_string", "extend_info_from_node", "rend_client_get_random_intro", "circuit_get_best", "entries_known_but_down", "connection_edge_is_rendezvous_stream", "circuit_has_opened", "connection_ap_can_use_exit", "node_get_by_nickname", "base16_decode", "tor_addr_parse", "entries_retry_all", "log_fn_"]}, {"name": "handle_control_getinfo", "calls": ["smartlist_free", "smartlist_split_string", "tor_strdup_", "write_escaped_data", "smartlist_add", "connection_write_to_buf", "connection_write_str_to_buf", "connection_printf_to_buf", "smartlist_new"]}, {"name": "file_status", "calls": ["clean_name_for_stat", "tor_strdup_", "sandbox_intern_string", "log_fn_"]}, {"name": "router_my_exit_policy_is_reject_star", "calls": ["router_get_my_routerinfo"]}, {"name": "connection_dns_remove", "calls": ["strlcpy", "cache_map_HT_FIND", "tor_assertion_failed_", "assert_connection_ok", "escaped_safe_str", "log_fn_"]}, {"name": "make_socket_reuseable", "calls": []}, {"name": "circuit_build_times_filter_timeouts", "calls": ["circuit_build_times_timeout_rate", "log_fn_"]}, {"name": "tor_tls_init", "calls": ["log_fn_", "check_no_tls_errors_", "tor_tls_allocate_tor_tls_object_ex_data_index"]}, {"name": "ip_address_changed", "calls": ["get_options", "router_reset_reachability", "init_keys_client", "server_mode", "dns_servers_relaunch_checks", "mark_my_descriptor_dirty", "reset_bandwidth_test", "log_fn_"]}, {"name": "launch_one_resolve", "calls": ["get_options", "tor_addr_to_in", "tor_addr_family", "tor_malloc_", "tor_addr_to_in6", "log_fn_"]}, {"name": "rep_hist_note_used_resolve", "calls": ["rep_hist_note_used_port"]}, {"name": "dirserv_estimate_microdesc_size", "calls": ["microdesc_average_size"]}, {"name": "nodelist_map_HT_FIND", "calls": ["node_id_hash", "nodelist_map_HT_FIND_P_"]}, {"name": "strmap_impl_HT_CLEAR", "calls": ["strmap_impl_HT_INIT", "tor_free_"]}, {"name": "compare_old_routers_by_identity_", "calls": []}, {"name": "format_client_stats_heartbeat", "calls": ["clientmap_HT_START", "tor_asprintf", "clientmap_HT_NEXT"]}, {"name": "control_event_bootstrap_problem", "calls": ["get_options", "hex_str", "control_event_client_status", "tor_snprintf", "any_other_active_or_conns", "tor_assertion_failed_", "connection_or_report_broken_states", "bootstrap_status_to_string", "we_are_hibernating", "orconn_end_reason_to_control_string", "log_fn_"]}, {"name": "rep_hist_get_predicted_ports", "calls": ["get_options", "smartlist_add", "tor_assertion_failed_", "tor_memdup_", "smartlist_del", "smartlist_new", "log_fn_"]}, {"name": "find_dl_schedule", "calls": ["dir_server_mode", "networkstatus_consensus_can_use_extra_fallbacks", "networkstatus_consensus_is_boostrapping", "tor_assertion_failed_", "networkstatus_consensus_can_use_multiple_directories"]}, {"name": "download_status_is_ready", "calls": []}, {"name": "retry_listener_ports", "calls": ["get_options", "smartlist_free", "tor_addr_compare", "tor_dup_addr", "smartlist_remove", "tor_addr_to_sockaddr", "smartlist_add", "connection_listener_new", "tor_assertion_failed_", "smartlist_new", "tor_malloc_", "smartlist_add_all", "smartlist_del", "create_unix_sockaddr"]}, {"name": "clear_geoip_db", "calls": ["smartlist_free"]}, {"name": "crypto_pk_read_public_key_from_string", "calls": ["tor_assertion_failed_", "crypto_log_errors"]}, {"name": "tor_check_dh_key", "calls": ["tor_assertion_failed_", "init_dh_param", "log_fn_"]}, {"name": "circuitmux_append_destroy_cell", "calls": ["channel_flush_from_first_active_circuit", "cell_queue_append_packed_copy", "log_fn_"]}, {"name": "list_pending_microdesc_downloads", "calls": ["list_pending_downloads"]}, {"name": "compare_vote_rs_", "calls": ["compare_vote_rs"]}, {"name": "compute_real_max_mem_in_queues", "calls": ["get_total_system_memory", "log_fn_"]}, {"name": "parse_port_range", "calls": ["tor_assertion_failed_", "escaped", "tor_parse_long", "log_fn_"]}, {"name": "crypto_rand_uint64_range", "calls": ["tor_assertion_failed_", "crypto_rand_uint64"]}, {"name": "pick_ed25519_impl", "calls": ["log_fn_"]}, {"name": "strmap_impl_HT_REMOVE", "calls": ["strmap_impl_HT_FIND_P_", "strmap_entry_hash"]}, {"name": "load_torrc_from_disk", "calls": ["tor_strdup_", "read_file_to_str", "file_status", "find_torrc_filename", "log_fn_"]}, {"name": "crypto_force_rand_ssleay", "calls": ["log_fn_"]}, {"name": "check_ed_keys_callback", "calls": ["load_ed_keys", "server_mode", "should_make_new_ed_keys", "generate_ed_link_cert", "tor_cleanup", "log_fn_"]}, {"name": "handle_control_attachstream", "calls": ["get_options", "get_stream", "smartlist_free", "node_allows_single_hop_exits", "tor_parse_ulong", "connection_printf_to_buf", "connection_ap_handshake_rewrite_and_attach", "hex_str", "circuit_detach_stream", "tor_strdup_", "circuit_get_by_edge_conn", "circuit_get_cpath_len", "connection_write_str_to_buf", "tor_digest_is_zero", "find_element_starting_with", "connection_ap_mark_as_non_pending_circuit", "tor_assertion_failed_", "send_control_done", "circuit_get_cpath_hop", "connection_edge_end", "node_get_by_id", "getargs_helper", "get_circ", "log_fn_"]}, {"name": "circuit_build_failed", "calls": ["entry_guard_register_connect_status", "escaped", "circuit_testing_failed", "circuit_discard_optional_exit_enclaves", "connection_ap_fail_onehop", "rend_service_relaunch_rendezvous", "circuit_increment_failure_count", "build_state_get_exit_nickname", "log_fn_"]}, {"name": "double_digest_map_HT_REP_IS_BAD_", "calls": ["ddmap_entry_hash"]}, {"name": "do_hup", "calls": ["get_options", "authdir_mode_handles_descs", "routerlist_reset_warnings", "options_init_from_torrc", "circuit_mark_all_dirty_circs_as_unusable", "tor_strdup_", "get_or_state", "approx_time", "cpuworkers_rotate_keyinfo", "router_reset_warnings", "router_reset_status_download_failures", "dirserv_load_fingerprint_file", "server_mode", "router_reset_descriptor_download_failures", "accounting_record_bandwidth_usage", "set_options", "update_networkstatus_downloads", "load_ed_keys", "dns_reset", "truncate_logs", "accounting_is_enabled", "generate_ed_link_cert", "log_fn_"]}, {"name": "crypto_digest512_new", "calls": ["tor_assertion_failed_", "crypto_digest_alloc_bytes", "tor_malloc_"]}, {"name": "double_digest_map_HT_CLEAR", "calls": ["double_digest_map_HT_INIT", "tor_free_"]}, {"name": "memarea_drop_all", "calls": ["chunk_free_unchecked"]}, {"name": "connection_or_client_learned_peer_id", "calls": ["get_options", "entry_guard_register_connect_status", "authdir_mode_tests_reachability", "control_event_or_conn_status", "base16_encode", "server_mode", "control_event_bootstrap_problem", "tor_malloc_", "learned_router_identity", "tor_digest_is_zero", "dirserv_orconn_tls_done", "connection_or_set_identity_digest", "tor_memeq", "log_fn_"]}, {"name": "digest256map_isempty", "calls": []}, {"name": "validate_ports_csv", "calls": ["tor_assertion_failed_", "tor_asprintf"]}, {"name": "strmap_impl_HT_NEXT_RMV", "calls": []}, {"name": "tor_fopen_cloexec", "calls": ["log_fn_"]}, {"name": "running_long_enough_to_decide_unreachable", "calls": ["get_options", "approx_time"]}, {"name": "addr_policy_permits_tor_addr", "calls": ["compare_tor_addr_to_addr_policy", "log_fn_"]}, {"name": "tor_log2", "calls": []}, {"name": "node_sl_choose_by_bandwidth", "calls": ["smartlist_choose_node_by_bandwidth_weights"]}, {"name": "channel_mark_client", "calls": ["tor_assertion_failed_"]}, {"name": "dns_free_all", "calls": ["cache_map_HT_CLEAR", "smartlist_free", "cache_map_HT_START", "cache_map_HT_NEXT_RMV", "free_cached_resolve_"]}, {"name": "mark_or_down", "calls": []}, {"name": "is_legal_hexdigest", "calls": ["tor_assertion_failed_", "is_legal_nickname"]}, {"name": "entry_connection_new", "calls": ["socks_request_new", "tor_assertion_failed_", "tor_malloc_zero_", "connection_init"]}, {"name": "rep_hist_bandwidth_assess", "calls": ["find_largest_max"]}, {"name": "extrainfo_dump_to_string", "calls": ["get_options", "smartlist_free", "extrainfo_dump_to_string", "should_record_bridge_info", "ed25519_pubkey_eq", "pt_get_extra_info_descriptor_string", "base64_encode", "extrainfo_free", "tor_strdup_", "rep_hist_get_bandwidth_lines", "smartlist_add_asprintf", "geoip_is_loaded", "router_append_dirobj_signature", "smartlist_join_strings", "geoip_get_bridge_stats_extrainfo", "tor_asprintf", "crypto_digest_smartlist_prefix", "ed25519_signature_to_base64", "smartlist_del_keeporder", "extrainfo_parse_entry_from_string", "router_get_extrainfo_hash", "smartlist_add", "load_stats_file", "geoip_db_digest", "base16_encode", "format_iso_time", "smartlist_new", "log_fn_"]}, {"name": "start_writing_to_stdio_file", "calls": ["fdopen_file", "abort_writing_to_file", "start_writing_to_file"]}, {"name": "handle_control_setconf", "calls": ["control_setconf_helper"]}, {"name": "connection_wants_to_flush", "calls": []}, {"name": "dirreqmap_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "flush_queued_events_cb", "calls": ["queued_events_flush_all"]}, {"name": "control_update_global_event_mask", "calls": ["get_connection_array", "TO_EDGE_CONN", "control_adjust_event_log_severity", "TO_CONTROL_CONN", "clear_circ_bw_fields"]}, {"name": "stream_end_reason_to_socks5_response", "calls": ["get_options", "log_fn_"]}, {"name": "tor_vasprintf", "calls": []}, {"name": "smartlist_choose_node_by_bandwidth_weights", "calls": ["scale_array_elements_to_u64", "choose_array_element_by_weight", "compute_weighted_bandwidths"]}, {"name": "signed_descs_update_status_from_consensus_networkstatus", "calls": ["digestmap_get", "router_get_consensus_status_by_descriptor_digest"]}, {"name": "log_backtrace", "calls": ["tor_mutex_acquire", "tor_log", "tor_mutex_release"]}, {"name": "circuitmux_assert_okay_pass_three", "calls": ["chanid_circid_muxinfo_map_HT_NEXT", "chanid_circid_muxinfo_map_HT_START", "tor_assertion_failed_"]}, {"name": "smartlist_ints_eq", "calls": []}, {"name": "policies_copy_addr_to_smartlist", "calls": ["tor_addr_copy", "smartlist_add", "tor_malloc_", "tor_addr_is_null"]}, {"name": "fp_pair_map_iter_init", "calls": ["fp_pair_map_impl_HT_START", "tor_assertion_failed_"]}, {"name": "format_number_sigsafe", "calls": ["tor_assertion_failed_"]}, {"name": "connection_or_send_auth_challenge_cell", "calls": ["crypto_rand", "var_cell_free", "tor_assertion_failed_", "var_cell_new", "connection_or_write_var_cell_to_buf"]}, {"name": "buf_datalen", "calls": []}, {"name": "node_has_descriptor", "calls": []}, {"name": "router_get_active_listener_port_by_type_af", "calls": ["get_connection_array"]}, {"name": "log_addr_has_changed", "calls": ["tor_addr_is_null", "strlcpy", "tor_addr_to_str", "log_fn_"]}, {"name": "connection_or_note_state_when_broken", "calls": ["note_broken_connection", "log_fn_", "connection_or_get_state_description"]}, {"name": "options_trial_assign", "calls": ["get_options", "set_options", "config_free", "config_dup", "options_transition_allowed", "config_assign", "options_validate", "get_options_mutable"]}, {"name": "router_exit_policy_rejects_all", "calls": []}, {"name": "connection_dir_process_inbuf", "calls": ["connection_get_inbuf_len", "directory_handle_command", "tor_assertion_failed_", "connection_mark_for_close_", "log_fn_"]}, {"name": "retry_dns_callback", "calls": ["has_dns_init_failed", "server_mode", "dns_init"]}, {"name": "we_use_microdescriptors_for_circuits", "calls": ["any_bridge_supports_microdescriptors", "server_mode"]}, {"name": "run_connection_housekeeping", "calls": ["TO_OR_CONN", "channel_tls_to_base", "connection_dir_reached_eof", "channel_is_bad_for_new_circs", "connection_or_close_normally", "connection_or_write_cell_to_buf", "get_options", "TO_DIR_CONN", "connection_get_inbuf_len", "we_are_hibernating", "connection_state_is_open", "connection_get_outbuf_len", "connection_mark_for_close_", "channel_num_circuits", "connection_or_connect_failed", "tor_assertion_failed_", "log_fn_"]}, {"name": "crypto_pk_check_key", "calls": ["crypto_log_errors", "tor_assertion_failed_"]}, {"name": "queue_pending_tasks", "calls": ["onion_next_task", "assign_onionskin_to_cpuworker", "log_fn_"]}, {"name": "approx_time", "calls": []}, {"name": "tor_assertion_failed_", "calls": ["tor_snprintf", "log_backtrace", "log_fn_"]}, {"name": "download_status_get_n_failures", "calls": []}, {"name": "networkstatus_nickname_is_unnamed", "calls": ["strmap_get_lc"]}, {"name": "addressmap_virtaddress_ent_free", "calls": []}, {"name": "router_pick_trusteddirserver_impl", "calls": ["get_options", "router_digest_is_me", "smartlist_free", "router_get_my_routerinfo", "fascist_firewall_allows_address_dir", "smartlist_add", "routerset_contains_routerstatus", "fascist_firewall_allows_address_or", "tor_addr_from_ipv4n", "dirserver_choose_by_weight", "connection_get_by_type_addr_port_purpose", "router_supports_extrainfo", "smartlist_new"]}, {"name": "sock_drain", "calls": ["recv_ni"]}, {"name": "control_event_networkstatus_changed_helper", "calls": ["smartlist_free", "tor_strdup_", "write_escaped_data", "smartlist_add", "send_control_event_string", "smartlist_join_strings", "networkstatus_getinfo_helper_single", "smartlist_new"]}, {"name": "channel_clear_remote_end", "calls": ["tor_digest_is_zero", "channel_is_in_state", "channel_remove_from_digest_map", "tor_assertion_failed_", "log_fn_"]}, {"name": "vote_routerstatus_free", "calls": []}, {"name": "warn_about_relative_paths", "calls": ["tor_assertion_failed_", "warn_if_option_path_is_relative"]}, {"name": "retry_all_listeners", "calls": ["connection_is_listener", "get_options", "smartlist_free", "conn_type_to_string", "get_connection_array", "get_configured_ports", "router_get_advertised_or_port_by_af", "router_get_advertised_or_port", "connection_close_immediate", "retry_listener_ports", "mark_my_descriptor_dirty", "connection_mark_for_close_", "router_get_advertised_dir_port", "smartlist_new", "smartlist_add", "log_fn_"]}, {"name": "digestmap_iter_get", "calls": ["tor_assertion_failed_"]}, {"name": "crypto_dh_get_dh_", "calls": []}, {"name": "pathbias_get_extreme_use_rate", "calls": ["networkstatus_get_param"]}, {"name": "get_net_param_from_list", "calls": ["tor_assertion_failed_", "strcmpstart", "tor_parse_long", "log_fn_"]}, {"name": "get_memlevel", "calls": []}, {"name": "max_dl_per_request", "calls": ["directory_fetches_from_authorities"]}, {"name": "TOR_ISUPPER", "calls": []}, {"name": "read_all", "calls": []}, {"name": "getaddrinfo_cache_HT_FIND", "calls": ["cached_getaddrinfo_item_hash", "getaddrinfo_cache_HT_FIND_P_"]}, {"name": "dir_connection_new", "calls": ["tor_malloc_zero_", "connection_init"]}, {"name": "tor_mem_is_zero", "calls": []}, {"name": "tor_tls_get_n_raw_bytes", "calls": ["log_fn_"]}, {"name": "update_all_descriptor_downloads", "calls": ["get_options", "launch_dummy_descriptor_download_as_needed", "update_router_descriptor_downloads", "update_microdesc_downloads"]}, {"name": "or_state_load", "calls": ["get_options", "or_state_set", "or_state_new", "or_state_save_broken", "clock_skew_warning", "config_get_lines", "config_free", "config_free_lines", "config_assign", "file_status", "options_get_datadir_fname2_suffix", "read_file_to_str", "or_state_validate", "or_state_save", "log_fn_"]}, {"name": "smartlist_sort_digests", "calls": ["smartlist_sort"]}, {"name": "note_that_we_maybe_cant_complete_circuits", "calls": []}, {"name": "tor_tls_get_pending_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "tor_x509_name_new", "calls": []}, {"name": "connection_or_send_netinfo", "calls": ["get_options", "router_get_my_routerinfo", "tor_assertion_failed_", "tor_addr_is_null", "connection_or_write_cell_to_buf", "append_address_to_payload", "public_server_mode", "tor_addr_from_ipv4n", "set_uint32", "log_fn_"]}, {"name": "rep_hist_exit_stats_term", "calls": []}, {"name": "networkstatus_get_latest_consensus", "calls": ["get_options", "we_use_microdescriptors_for_circuits"]}, {"name": "rend_cache_failure_intro_entry_new", "calls": ["tor_malloc_"]}, {"name": "pathbias_is_new_circ_attempt", "calls": []}, {"name": "rend_cache_get_total_allocation", "calls": []}, {"name": "policy_summary_accept", "calls": ["policy_summary_split", "tor_assertion_failed_"]}, {"name": "control_event_network_liveness_update", "calls": ["get_cached_network_liveness", "set_cached_network_liveness", "send_control_event_string", "log_fn_"]}, {"name": "conn_state_to_string", "calls": ["tor_snprintf", "conn_type_to_string", "log_fn_"]}, {"name": "circuit_build_times_calculate_timeout", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_build_times_needs_circuits_now", "calls": ["approx_time", "circuit_build_times_needs_circuits", "circuit_build_times_test_frequency"]}, {"name": "circuitmux_assert_okay_pass_two", "calls": ["tor_assertion_failed_", "chanid_circid_muxinfo_map_HT_FIND", "TO_OR_CIRCUIT"]}, {"name": "crypto_seed_rng", "calls": ["memwipe", "crypto_strongest_rand_raw", "log_fn_"]}, {"name": "launch_reachability_tests_callback", "calls": ["authdir_mode_tests_reachability", "net_is_disabled", "dirserv_test_reachability"]}, {"name": "ddmap_entry_eq", "calls": []}, {"name": "dnsserv_resolved", "calls": ["evdns_get_orig_address", "tor_strndup_"]}, {"name": "clientmap_entry_hash", "calls": ["tor_addr_hash"]}, {"name": "str_num_before", "calls": []}, {"name": "we_fetch_router_descriptors", "calls": ["we_use_microdescriptors_for_circuits", "directory_caches_dir_info"]}, {"name": "control_free_all", "calls": ["queued_event_free", "smartlist_free", "tor_event_free"]}, {"name": "set_server_advertised", "calls": []}, {"name": "digest256map_get", "calls": ["tor_assertion_failed_", "digest256map_assign_tmp_key", "digest256map_impl_HT_FIND"]}, {"name": "tor_mutex_new_nonrecursive", "calls": ["tor_malloc_zero_", "tor_mutex_init_nonrecursive"]}, {"name": "digest256map_remove", "calls": ["digest256map_entry_free", "digest256map_impl_HT_REMOVE", "digest256map_assign_tmp_key", "tor_assertion_failed_"]}, {"name": "connection_or_send_certs_cell", "calls": ["var_cell_free", "tor_assertion_failed_", "tor_x509_cert_get_der", "set_uint16", "var_cell_new", "tor_tls_get_my_certs", "connection_or_write_var_cell_to_buf"]}, {"name": "set_streams_blocked_on_circ", "calls": ["connection_stop_reading", "connection_is_reading", "TO_OR_CIRCUIT", "connection_start_reading", "TO_ORIGIN_CIRCUIT", "tor_assertion_failed_"]}, {"name": "digest256map_entry_free", "calls": []}, {"name": "rend_service_del_ephemeral", "calls": ["rend_service_free", "safe_str_client", "smartlist_remove", "rend_service_get_by_service_id", "tor_assertion_failed_", "extend_info_describe", "circuit_get_global_list", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "rend_valid_service_id", "tor_memeq", "log_fn_"]}, {"name": "tor_cert_get_checkable_sig", "calls": ["tor_assertion_failed_"]}, {"name": "rend_mid_rendezvous", "calls": ["get_options", "circuit_set_rendezvous_cookie", "base16_encode", "circuit_get_rendezvous", "circuit_change_purpose", "circuit_mark_for_close_", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "command_process_var_cell", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "extrainfo_parse_entry_from_string", "calls": ["crypto_digest256", "smartlist_free", "find_by_keyword_", "smartlist_pos", "dump_desc", "escaped", "ed25519_signature_from_base64", "check_signature_token", "crypto_digest256_new", "digestmap_get", "router_get_hash_impl_helper", "tor_cert_parse", "tor_memdup_", "crypto_digest_add_bytes", "tor_cert_get_checkable_sig", "tor_memdup_nulterm_", "parse_iso_time", "extrainfo_free", "router_get_extrainfo_hash", "tor_assertion_failed_", "crypto_digest_free", "note_crypto_pk_op", "tor_malloc_zero_", "is_legal_nickname", "strlcpy", "memarea_drop_all", "find_opt_by_keyword", "memarea_new", "tokenize_string", "token_clear", "base16_decode", "smartlist_new", "crypto_digest_get_digest", "log_fn_"]}, {"name": "router_reset_warnings", "calls": ["smartlist_clear"]}, {"name": "circuit_change_purpose", "calls": ["control_event_circuit_purpose_changed", "tor_assertion_failed_", "circuit_purpose_to_string", "TO_ORIGIN_CIRCUIT", "log_fn_"]}, {"name": "tor_init_weak_random", "calls": []}, {"name": "connection_start_reading", "calls": ["tor_assertion_failed_", "connection_should_read_from_linked_conn", "connection_start_reading_from_linked_conn", "log_fn_"]}, {"name": "TO_ORIGIN_CIRCUIT", "calls": ["tor_assertion_failed_"]}, {"name": "fp_pair_map_iter_next", "calls": ["tor_assertion_failed_", "fp_pair_map_impl_HT_NEXT"]}, {"name": "dns_seems_to_be_broken", "calls": []}, {"name": "add_fingerprint_to_dir", "calls": ["tor_strdup_", "tor_assertion_failed_", "tor_malloc_zero_", "tor_strstrip", "escaped", "digestmap_get", "digestmap_set", "base16_decode", "log_fn_"]}, {"name": "cached_resolves_eq", "calls": ["assert_resolve_ok"]}, {"name": "rend_intro_point_free", "calls": ["extend_info_free", "crypto_pk_free", "replaycache_free"]}, {"name": "rend_client_send_introduction", "calls": ["rend_client_refetch_v2_renddesc", "crypto_pk_asn1_encode", "crypto_dh_generate_public", "circuit_mark_for_close_", "set_uint16", "safe_str_client", "tor_addr_to_ipv4n", "extend_info_describe", "rend_cmp_service_ids", "crypto_dh_new", "set_uint32", "crypto_pk_public_hybrid_encrypt", "connection_ap_mark_as_non_pending_circuit", "circuit_change_purpose", "tor_assertion_failed_", "TO_ENTRY_CONN", "note_crypto_pk_op", "connection_get_by_type_state_rendquery", "rend_client_reextend_intro_circuit", "rend_cache_lookup_entry", "tor_memeq", "pathbias_count_use_attempt", "tor_malloc_zero_", "crypto_pk_get_digest", "memwipe", "rend_client_any_intro_points_usable", "crypto_dh_get_public", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "routerlist_remove_old_routers", "calls": ["digestset_add", "routerlist_remove", "digestset_new", "networkstatus_get_latest_consensus", "routerlist_remove_old_cached_routers_with_id", "router_describe", "digestset_free", "smartlist_sort", "router_rebuild_store", "trusted_dirs_remove_old_certs", "routerlist_remove_old", "digestset_contains", "tor_memeq", "log_fn_"]}, {"name": "tor_tls_err_to_string", "calls": []}, {"name": "microdesc_map_HT_REP_IS_BAD_", "calls": ["microdesc_hash_"]}, {"name": "node_get_address_string", "calls": ["tor_addr_to_str", "strlcpy", "fmt_addr32", "tor_addr_from_ipv4n"]}, {"name": "sb_rt_sigprocmask", "calls": []}, {"name": "connection_or_set_ext_or_identifier", "calls": ["crypto_rand", "tor_digest_is_zero", "connection_or_remove_from_ext_or_id_map", "tor_assertion_failed_", "digestmap_new", "tor_malloc_zero_", "digestmap_get", "digestmap_set"]}, {"name": "or_handshake_state_free", "calls": ["memwipe", "tor_x509_cert_free", "crypto_digest_free"]}, {"name": "addr_policy_get_canonical_entry", "calls": ["tor_assertion_failed_", "policy_map_HT_INSERT", "tor_memdup_", "tor_malloc_zero_", "policy_map_HT_FIND", "cmp_single_addr_policy"]}, {"name": "channel_num_circuits", "calls": ["tor_assertion_failed_"]}, {"name": "get_min_log_level", "calls": []}, {"name": "channel_set_circid_type", "calls": ["get_server_identity_key", "get_tlsclient_identity_key", "tor_assertion_failed_", "channel_is_outgoing", "crypto_pk_cmp_keys"]}, {"name": "add_obs", "calls": ["advance_obs"]}, {"name": "digestmap_impl_HT_INIT", "calls": []}, {"name": "strmap_iter_next", "calls": ["strmap_impl_HT_NEXT", "tor_assertion_failed_"]}, {"name": "check_server_ports", "calls": ["have_capability_support", "tor_addr_family", "log_fn_"]}, {"name": "connection_exit_connect", "calls": ["get_options", "circuit_detach_stream", "errno_to_stream_end_reason", "connection_watch_events", "connection_edge_is_rendezvous_stream", "connection_edge_send_command", "tor_assertion_failed_", "tor_addr_family", "connection_connect", "connection_get_outbuf_len", "circuit_get_by_edge_conn", "connection_free", "connection_connect_unix", "connection_edge_end", "router_compare_to_my_exit_policy", "connected_cell_format_payload", "escaped_safe_str_client", "log_fn_"]}, {"name": "config_init", "calls": ["config_reset", "tor_assertion_failed_"]}, {"name": "geoip_note_client_seen", "calls": ["get_options", "safe_str_client", "geoip_get_country_by_addr", "clientmap_HT_INSERT", "tor_addr_copy", "tor_strdup_", "clientmap_HT_FIND", "tor_malloc_zero_", "fmt_addr_impl", "log_fn_"]}, {"name": "dirvote_get_pending_consensus", "calls": ["tor_assertion_failed_"]}, {"name": "handle_control_mapaddress", "calls": ["addressmap_register_virtual_address", "smartlist_clear", "safe_str_client", "tor_strdup_", "smartlist_free", "smartlist_add_asprintf", "addressmap_register_auto", "connection_write_to_buf", "smartlist_join_strings", "smartlist_split_string", "tor_strlower", "address_is_invalid_mapaddress_target", "smartlist_new", "log_fn_"]}, {"name": "read_encrypted_secret_key", "calls": ["get_options", "memwipe", "do_getpass", "crypto_unpwbox", "crypto_read_tagged_contents_from_file", "log_fn_"]}, {"name": "router_initialize_tls_context", "calls": ["get_options", "crypto_rand_int_range", "get_server_identity_key", "get_tlsclient_identity_key", "public_server_mode", "server_mode", "tor_tls_context_init", "crypto_rand_int"]}, {"name": "rend_service_derive_key_digests", "calls": ["log_fn_", "rend_get_service_id", "crypto_pk_get_digest"]}, {"name": "trusted_dirs_flush_certs_to_disk", "calls": ["get_options", "smartlist_free", "digestmap_iter_next", "digestmap_iter_get", "smartlist_add", "digestmap_iter_done", "tor_malloc_", "options_get_datadir_fname2_suffix", "write_chunks_to_file", "digestmap_iter_init", "smartlist_new", "log_fn_"]}, {"name": "new_route_len", "calls": ["count_acceptable_nodes", "tor_assertion_failed_", "log_fn_"]}, {"name": "cell_ewma_set_scale_factor", "calls": ["networkstatus_get_param", "log_fn_"]}, {"name": "rsamap_HT_REP_IS_BAD_", "calls": ["keypin_ent_hash_rsa"]}, {"name": "tor_cleanup", "calls": ["get_options", "authdir_mode_tests_reachability", "rep_hist_record_mtbf_data", "tor_free_all", "or_state_mark_dirty", "accounting_record_bandwidth_usage", "crypto_global_cleanup", "accounting_is_enabled", "get_or_state", "keypin_close_journal", "or_state_save", "log_fn_"]}, {"name": "fdopen_file", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "router_reset_status_download_failures", "calls": ["mark_all_dirservers_up"]}, {"name": "signed_desc_digest_is_recognized", "calls": ["networkstatus_vote_find_entry", "tor_memeq", "networkstatus_get_latest_consensus"]}, {"name": "openssl_locking_cb_", "calls": ["tor_mutex_release", "tor_mutex_acquire"]}, {"name": "short_policy_free", "calls": []}, {"name": "ntor_key_map_free_helper", "calls": ["memwipe"]}, {"name": "dirserv_set_routerstatus_testing", "calls": ["get_options", "tor_assertion_failed_", "routerset_contains_routerstatus"]}, {"name": "write_chunks_to_file_impl", "calls": ["write_all", "tor_assertion_failed_", "abort_writing_to_file", "finish_writing_to_file", "start_writing_to_file", "log_fn_"]}, {"name": "_cmp_uint32_t", "calls": []}, {"name": "circuit_set_p_circid_chan", "calls": ["approx_time", "channel_mark_circid_unusable", "tor_assertion_failed_", "circuit_set_circid_chan_helper"]}, {"name": "microdesc_map_HT_INIT", "calls": []}, {"name": "base64_encode", "calls": ["base64_encode_size", "tor_assertion_failed_"]}, {"name": "channel_tls_describe_transport_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_", "tor_asprintf"]}, {"name": "circuit_id_when_marked_unusable_on_channel", "calls": ["chan_circid_map_HT_FIND"]}, {"name": "process_map_HT_INIT", "calls": []}, {"name": "tor_sscanf", "calls": ["tor_vsscanf"]}, {"name": "dir_routerdesc_download_failed", "calls": ["get_options", "escaped", "router_get_by_extrainfo_digest", "tor_assertion_failed_", "download_status_increment_failure", "connection_dir_retry_bridges", "router_get_dl_status_by_descriptor_digest", "base16_decode", "log_fn_", "directory_fetches_from_authorities"]}, {"name": "options_new", "calls": ["config_new"]}, {"name": "get_transport_proxy_ports", "calls": ["tor_assertion_failed_", "smartlist_add_asprintf", "smartlist_new"]}, {"name": "compute_publishserverdescriptor", "calls": ["log_fn_"]}, {"name": "check_cert_lifetime_internal", "calls": ["log_cert_lifetime"]}, {"name": "connection_get_by_type_state_rendquery", "calls": ["get_connection_array", "TO_DIR_CONN", "tor_assertion_failed_", "rend_cmp_service_ids", "TO_EDGE_CONN"]}, {"name": "crypto_digest", "calls": ["tor_assertion_failed_"]}, {"name": "buf_add_chunk_with_capacity", "calls": ["preferred_chunk_size", "tor_gettimeofday_cached_monotonic", "tor_assertion_failed_", "tv_to_msec", "chunk_new_with_alloc_size"]}, {"name": "format_versions_list", "calls": ["smartlist_free", "smartlist_split_string", "sort_version_list", "smartlist_join_strings", "smartlist_new"]}, {"name": "sandbox_init_filter", "calls": ["get_options", "smartlist_free", "get_ext_or_auth_cookie_file_name", "options_get_datadir_fname2_suffix", "rend_services_add_filenames_to_lists", "server_mode", "tor_strdup_", "sandbox_cfg_allow_open_filename", "smartlist_new", "tor_log_get_logfile_names", "sandbox_cfg_allow_openat_filename", "authdir_mode_handles_descs", "sandbox_cfg_new", "get_torrc_fname", "init_addrinfo", "tor_asprintf", "sandbox_cfg_allow_stat_filename", "sandbox_cfg_allow_rename", "get_controller_cookie_file_name"]}, {"name": "channel_flush_some_cells", "calls": ["chan_cell_queue_len", "circuitmux_num_cells", "channel_is_in_state", "tor_assertion_failed_", "channel_flush_from_first_active_circuit"]}, {"name": "connection_ap_handshake_send_resolve", "calls": ["mark_circuit_unusable_for_new_conns", "safe_str_client", "tor_addr_parse_PTR_name", "connection_edge_send_command", "tor_assertion_failed_", "tor_dup_addr", "get_unique_stream_id_by_circ", "tor_addr_to_PTR_name", "TO_ORIGIN_CIRCUIT", "log_fn_", "control_event_stream_status", "connection_mark_unattached_ap_"]}, {"name": "tor_memeq", "calls": []}, {"name": "should_use_create_fast_for_circuit", "calls": ["get_options", "tor_assertion_failed_", "networkstatus_get_param", "public_server_mode"]}, {"name": "download_status_log_helper", "calls": ["log_fn_"]}, {"name": "get_transport_by_bridge_addrport", "calls": ["transport_get_by_name", "tor_addr_compare"]}, {"name": "kb_to_bytes", "calls": []}, {"name": "connection_tls_start_handshake", "calls": ["channel_tls_handle_incoming", "tor_tls_set_logged_address", "channel_tls_start_listener", "tor_assertion_failed_", "connection_or_change_state", "note_crypto_pk_op", "connection_start_reading", "channel_tls_get_listener", "escaped_safe_str", "log_fn_", "tor_tls_new", "command_setup_listener", "connection_tls_continue_handshake"]}, {"name": "format_iso_time", "calls": ["tor_gmtime_r"]}, {"name": "smartlist_new", "calls": ["tor_malloc_", "tor_calloc_"]}, {"name": "tor_threadlocal_set", "calls": ["tor_assertion_failed_"]}, {"name": "policy_map_HT_REP_IS_BAD_", "calls": ["policy_hash"]}, {"name": "WRA_NEVER_DOWNLOADABLE", "calls": []}, {"name": "getinfo_helper_listeners", "calls": ["smartlist_free", "tor_sockaddr_to_str", "get_connection_array", "smartlist_add", "smartlist_join_strings", "smartlist_add_asprintf", "esc_for_log", "smartlist_new"]}, {"name": "mark_circuit_unusable_for_new_conns", "calls": ["get_options", "approx_time", "tor_assertion_failed_"]}, {"name": "tor_addr_to_mapped_ipv4h", "calls": ["tor_assertion_failed_", "tor_addr_to_in6"]}, {"name": "rend_service_set_connection_addr_port", "calls": ["set_unix_port", "add_unix_port", "smartlist_free", "log_fn_ratelim_", "base32_encode", "smartlist_add", "tor_assertion_failed_", "tor_addr_copy", "smartlist_choose", "smartlist_new", "rend_service_get_by_pk_digest", "log_fn_"]}, {"name": "packed_cell_is_destroy", "calls": ["get_uint16", "get_uint32"]}, {"name": "smartlist_contains_int_as_string", "calls": ["tor_snprintf", "smartlist_contains_string"]}, {"name": "smartlist_join_strings2", "calls": ["tor_assertion_failed_", "tor_malloc_"]}, {"name": "process_handle_new", "calls": ["tor_malloc_zero_"]}, {"name": "format_hex_number_sigsafe", "calls": ["format_number_sigsafe"]}, {"name": "dirserv_add_multiple_descriptors", "calls": ["smartlist_clear", "WRA_WAS_ADDED", "dirserv_add_descriptor", "WRA_MORE_SEVERE", "smartlist_free", "format_iso_time", "smartlist_new", "escaped", "router_purpose_to_string", "tor_snprintf", "tor_assertion_failed_", "dirserv_add_extrainfo", "router_parse_list_from_string"]}, {"name": "upload_service_descriptor", "calls": ["get_options", "smartlist_clear", "rend_encoded_v2_service_descriptor_free", "networkstatus_get_latest_consensus", "smartlist_add", "smartlist_free", "directory_post_to_hs_dir", "rend_get_service_id", "rend_encode_v2_descriptors", "smartlist_new", "log_fn_"]}, {"name": "edmap_HT_REMOVE", "calls": ["keypin_ent_hash_ed", "edmap_HT_FIND_P_"]}, {"name": "set_cached_network_liveness", "calls": []}, {"name": "parse_transport_line", "calls": ["pt_kickstart_proxy", "smartlist_free", "fmt_addrport", "smartlist_del_keeporder", "tor_addr_port_lookup", "tor_assertion_failed_", "transport_is_needed", "escaped", "tor_calloc_", "transport_add_from_config", "smartlist_split_string", "string_is_C_identifier", "smartlist_new", "log_fn_"]}, {"name": "retry_bridge_descriptor_fetch_directly", "calls": ["find_bridge_by_digest", "launch_direct_bridge_descriptor_fetch"]}, {"name": "sb_rt_sigaction", "calls": []}, {"name": "addressmap_get_virtual_address", "calls": ["crypto_rand", "base32_encode", "tor_assertion_failed_", "tor_strdup_", "tor_addr_to_str", "strmap_get", "tor_addr_to_ipv4h", "get_random_virtual_addr", "strlcat", "log_fn_"]}, {"name": "authority_certs_fetch_missing", "calls": ["get_options", "smartlist_free", "smartlist_contains_digest", "directory_get_from_dirserver", "directory_caches_unknown_auth_certs", "trusteddirserver_get_by_v3_auth_digest", "download_status_reset", "authority_cert_get_by_digests", "download_status_reset_by_sk_in_cl", "fp_pair_map_new", "tor_strdup_", "digestmap_new", "should_delay_dir_fetches", "digestmap_get", "tor_asprintf", "download_status_is_ready", "hex_str", "fp_pair_map_get_by_digests", "smartlist_add", "smartlist_join_strings", "get_cert_list", "list_pending_downloads", "tor_malloc_", "base16_encode", "list_pending_fpsk_downloads", "smartlist_new", "fp_pair_map_get", "download_status_is_ready_by_sk_in_cl", "log_fn_"]}, {"name": "channel_tls_write_cell_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_", "connection_or_write_cell_to_buf", "log_fn_"]}, {"name": "router_add_running_nodes_to_smartlist", "calls": ["smartlist_add", "nodelist_get_list", "node_is_unreliable"]}, {"name": "edge_of_accounting_period_containing", "calls": ["tor_localtime_r", "tor_assertion_failed_"]}, {"name": "tor_tls_assert_renegotiation_unblocked", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_mark_all_dirty_circs_as_unusable", "calls": ["TO_ORIGIN_CIRCUIT", "mark_circuit_unusable_for_new_conns", "circuit_get_global_list"]}, {"name": "TO_DIR_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "rend_service_decrypt_intro", "calls": ["crypto_pk_keysize", "tor_asprintf", "base32_encode", "tor_strdup_", "crypto_pk_get_digest", "escaped", "memwipe", "tor_malloc_", "crypto_pk_private_hybrid_decrypt", "note_crypto_pk_op", "tor_memeq"]}, {"name": "channel_close_from_lower_layer", "calls": ["channel_is_in_state", "channel_change_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "command_process_cell", "calls": ["command_process_create_cell", "command_process_created_cell", "command_process_relay_cell", "command_process_destroy_cell", "log_fn_"]}, {"name": "get_or_state", "calls": ["tor_assertion_failed_"]}, {"name": "packed_cell_new", "calls": ["tor_malloc_zero_"]}, {"name": "http_get_header", "calls": ["tor_strndup_", "strcasecmpstart", "tor_strdup_"]}, {"name": "append_bytes_to_file", "calls": ["write_bytes_to_file_impl"]}, {"name": "relay_header_pack", "calls": ["set_uint8", "set_uint16"]}, {"name": "get_bindaddr_for_server_proxy", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_add_asprintf", "get_stored_bindaddr_for_server_transport", "smartlist_join_strings", "smartlist_new"]}, {"name": "router_get_hash_impl", "calls": ["crypto_digest256", "crypto_digest", "router_get_hash_impl_helper", "log_fn_"]}, {"name": "channel_set_identity_digest", "calls": ["tor_digest_is_zero", "channel_is_in_state", "hex_str", "channel_remove_from_digest_map", "tor_assertion_failed_", "channel_add_to_digest_map", "log_fn_"]}, {"name": "get_n_authorities", "calls": []}, {"name": "show_help", "calls": []}, {"name": "init_libevent", "calls": ["tor_check_libevent_header_compatibility", "configure_libevent_logging", "tor_libevent_initialize", "tor_assertion_failed_", "suppress_libevent_log_msg", "get_num_cpus"]}, {"name": "chan_circid_map_HT_INIT", "calls": []}, {"name": "consider_testing_reachability", "calls": ["get_options", "router_get_my_routerinfo", "circuit_launch_by_extend_info", "directory_initiate_command", "routerset_contains_router", "extend_info_free", "extend_info_from_router", "circuit_enough_testing_circs", "tor_addr_from_ipv4n", "log_fn_ratelim_", "connection_get_by_type_addr_port_purpose", "check_whether_dirport_reachable", "fmt_addr32", "check_whether_orport_reachable", "log_fn_"]}, {"name": "circuitmux_assert_okay_pass_one", "calls": ["channel_find_by_global_id", "chanid_circid_muxinfo_map_HT_START", "tor_assertion_failed_", "TO_OR_CIRCUIT", "chanid_circid_muxinfo_map_HT_NEXT", "circuit_get_by_circid_channel_even_if_marked"]}, {"name": "sb_prctl", "calls": []}, {"name": "options_transition_affects_workers", "calls": ["opt_streq", "config_lines_eq", "public_server_mode"]}, {"name": "logs_set_domain_logging", "calls": ["tor_mutex_release", "tor_mutex_acquire"]}, {"name": "compare_tor_addr_to_short_policy", "calls": ["get_options", "tor_addr_is_null", "tor_assertion_failed_", "tor_addr_is_internal_", "tor_addr_is_loopback"]}, {"name": "parse_dir_authority_line", "calls": ["smartlist_free", "tor_parse_double", "tor_addr_family", "escaped", "smartlist_join_strings", "strcmpstart", "smartlist_split_string", "smartlist_del_keeporder", "is_legal_nickname", "TOR_ISDIGIT", "strcasecmpstart", "dir_server_add", "tor_addr_port_parse", "addr_port_lookup", "trusted_dir_server_new", "base16_decode", "smartlist_new", "tor_parse_long", "log_fn_"]}, {"name": "authdir_mode_any_nonhidserv", "calls": ["authdir_mode_any_main"]}, {"name": "bitarray_set", "calls": []}, {"name": "crypto_pk_copy_full", "calls": ["tor_assertion_failed_", "crypto_log_errors", "crypto_new_pk_from_rsa_", "log_fn_"]}, {"name": "dns_get_expiry_ttl", "calls": []}, {"name": "find_nth_int", "calls": ["tor_assertion_failed_"]}, {"name": "router_get_mutable_by_digest", "calls": ["rimap_get", "tor_assertion_failed_"]}, {"name": "ddmap_entry_set_digests", "calls": []}, {"name": "launch_wildcard_check", "calls": ["tor_assertion_failed_", "crypto_random_hostname", "log_fn_"]}, {"name": "or_state_validate", "calls": ["entry_guards_parse_state", "validate_transports_in_state"]}, {"name": "parse_outbound_addresses", "calls": ["tor_addr_copy", "tor_addr_parse", "tor_asprintf"]}, {"name": "rend_client_lookup_service_authorization", "calls": ["tor_assertion_failed_", "strmap_get"]}, {"name": "get_n_open_sockets", "calls": ["socket_accounting_unlock", "socket_accounting_lock"]}, {"name": "fp_pair_map_get", "calls": ["fp_pair_map_impl_HT_FIND", "tor_assertion_failed_"]}, {"name": "clear_pending_onions", "calls": ["tor_assertion_failed_", "onion_queue_entry_remove"]}, {"name": "dirserv_router_get_status", "calls": ["get_options", "dirserv_get_status_impl", "router_describe", "keypin_check_lone_rsa", "crypto_pk_get_digest", "keypin_check", "log_fn_"]}, {"name": "accounting_get_interval_length", "calls": []}, {"name": "extrainfo_insert", "calls": ["rimap_get", "log_fn_ratelim_", "extrainfo_free", "base16_encode", "tor_assertion_failed_", "eimap_set", "sdmap_get", "router_get_my_extrainfo", "routerinfo_incompatible_with_extrainfo", "tor_memeq", "log_fn_"]}, {"name": "set_uint64", "calls": []}, {"name": "launch_dummy_descriptor_download_as_needed", "calls": ["directory_get_from_dirserver", "server_mode"]}, {"name": "connection_ext_or_auth_handle_client_nonce", "calls": ["TO_OR_CONN", "handle_client_auth_nonce", "connection_fetch_from_buf", "memwipe", "connection_get_inbuf_len", "connection_write_to_buf", "log_fn_"]}, {"name": "getaddrinfo_cache_HT_INIT", "calls": []}, {"name": "marked_circuit_streams_free_bytes", "calls": ["single_conn_free_bytes"]}, {"name": "have_been_under_memory_pressure", "calls": ["approx_time"]}, {"name": "eventfd_alert", "calls": ["write_ni"]}, {"name": "relay_header_unpack", "calls": ["get_uint16"]}, {"name": "parse_process_specifier", "calls": ["tor_parse_long"]}, {"name": "rep_hist_exit_stats_write", "calls": ["check_or_create_data_subdir", "rep_hist_reset_exit_stats", "write_to_data_subdir", "rep_hist_format_exit_stats", "log_fn_"]}, {"name": "scheduler_evt_callback", "calls": ["scheduler_retrigger", "tor_assertion_failed_", "scheduler_more_work", "scheduler_run", "log_fn_"]}, {"name": "tor_fd_seekend", "calls": []}, {"name": "process_map_HT_CLEAR", "calls": ["process_map_HT_INIT", "tor_free_"]}, {"name": "router_exit_policy_all_nodes_reject", "calls": ["nodelist_get_list", "compare_tor_addr_to_node_policy", "node_is_unreliable"]}, {"name": "connection_edge_flushed_some", "calls": ["connection_edge_consider_sending_sendme"]}, {"name": "remove_obsolete_entry_guards", "calls": ["log_entry_guards", "guards_get_lifetime", "tor_version_parse", "smartlist_del_keeporder", "base16_encode", "control_event_guard", "tor_assertion_failed_", "escaped", "log_fn_", "entry_guard_free"]}, {"name": "config_count_key", "calls": []}, {"name": "connection_dir_avoid_extra_connection_for_purpose", "calls": ["get_options", "networkstatus_consensus_is_downloading_usable_flavor", "networkstatus_consensus_can_use_multiple_directories", "networkstatus_consensus_is_boostrapping"]}, {"name": "get_options_mutable", "calls": ["tor_assertion_failed_"]}, {"name": "routerlist_assert_ok", "calls": ["tor_digest_is_zero", "eimap_to_digestmap", "rimap_get", "digestmap_iter_next", "digestmap_iter_get", "tor_assertion_failed_", "digestmap_iter_done", "sdmap_to_digestmap", "rimap_to_digestmap", "sdmap_get", "digestmap_iter_init", "tor_memeq"]}, {"name": "connection_or_remove_from_ext_or_id_map", "calls": ["tor_digest_is_zero", "tor_assertion_failed_", "digestmap_remove"]}, {"name": "tls_log_errors", "calls": ["tor_tls_log_one_error"]}, {"name": "get_bytes_read", "calls": []}, {"name": "router_counts_toward_thresholds", "calls": ["dirserv_has_measured_bw", "get_options", "digestmap_get", "router_is_active", "dirserv_get_credible_bandwidth_kb"]}, {"name": "geoip_is_loaded", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_get_by_rend_token_and_purpose", "calls": ["hex_str", "tor_strdup_", "safe_str", "digestmap_get", "tor_memeq", "log_fn_"]}, {"name": "dirserv_add_extrainfo", "calls": ["extrainfo_free", "tor_assertion_failed_", "router_get_by_id_digest", "router_add_extrainfo_to_routerlist", "routerinfo_incompatible_with_extrainfo", "log_fn_"]}, {"name": "geoip_get_bridge_stats_extrainfo", "calls": ["load_bridge_stats"]}, {"name": "hibernate_hard_limit_reached", "calls": ["get_accounting_bytes", "get_options"]}, {"name": "geoip_get_dirreq_history", "calls": ["smartlist_free", "round_uint32_to_next_multiple_of", "dirreqmap_HT_START", "smartlist_add", "tor_snprintf", "dirreqmap_HT_NEXT_RMV", "dirreqmap_HT_NEXT", "tor_gettimeofday", "tor_malloc_zero_", "tv_mdiff", "tor_calloc_", "median_uint32", "smartlist_new"]}, {"name": "median_uint32", "calls": ["find_nth_uint32"]}, {"name": "connection_is_rate_limited", "calls": ["get_options", "tor_addr_is_internal_", "tor_addr_family"]}, {"name": "compare_duration_idx_", "calls": []}, {"name": "crypto_rand_unmocked", "calls": ["tor_assertion_failed_"]}, {"name": "directory_initiate_command_routerstatus_rend", "calls": ["get_options", "dir_conn_purpose_to_string", "routerset_contains_routerstatus", "routerstatus_describe", "dirind_is_anon", "tor_addr_from_ipv4n", "directory_initiate_command_rend", "node_get_by_id", "log_fn_"]}, {"name": "router_load_single_router", "calls": ["smartlist_free", "routers_update_status_from_consensus_networkstatus", "router_add_to_routerlist", "WRA_WAS_ADDED", "tor_snprintf", "smartlist_add", "tor_assertion_failed_", "router_is_me", "router_purpose_to_string", "routerlist_descriptors_added", "router_parse_entry_from_string", "routerinfo_free", "smartlist_new", "log_fn_"]}, {"name": "smartlist_split_string", "calls": ["TOR_ISSPACE", "smartlist_add", "tor_assertion_failed_", "tor_strstrip", "tor_strndup_"]}, {"name": "pathbias_get_min_circs", "calls": ["networkstatus_get_param"]}, {"name": "tor_tls_shutdown", "calls": ["tor_assertion_failed_", "check_no_tls_errors_", "tor_tls_get_error", "log_fn_"]}, {"name": "tor_zlib_free", "calls": []}, {"name": "choose_good_middle_server", "calls": ["get_options", "smartlist_free", "router_choose_random_node", "tor_assertion_failed_", "nodelist_add_node_and_family", "build_state_get_exit_node", "node_get_by_id", "smartlist_new", "log_fn_"]}, {"name": "intro_point_should_expire_now", "calls": ["intro_point_accepted_intro_count", "tor_assertion_failed_", "crypto_rand_int_range"]}, {"name": "tor_addr_is_public_for_reject", "calls": ["tor_addr_is_internal_", "tor_addr_is_null", "tor_addr_is_multicast"]}, {"name": "tor_mutex_init", "calls": ["tor_threads_init", "log_fn_"]}, {"name": "dump_microdescriptor", "calls": ["tor_fd_getpos", "tor_snprintf", "format_iso_time", "write_all", "log_fn_"]}, {"name": "note_crypto_pk_op", "calls": ["log_fn_"]}, {"name": "handle_control_extendcircuit", "calls": ["smartlist_free", "circuit_send_next_onion_skin", "connection_printf_to_buf", "smartlist_split_string", "circuit_mark_for_close_", "circuit_launch", "circuit_purpose_from_string", "extend_info_free", "origin_circuit_init", "connection_write_str_to_buf", "node_has_descriptor", "control_event_circuit_status", "find_element_starting_with", "is_keyval_pair", "smartlist_add", "tor_assertion_failed_", "extend_info_from_node", "circuit_append_new_exit", "circuit_handle_first_hop", "getargs_helper", "node_get_by_nickname", "circuit_set_state", "smartlist_new", "get_circ", "log_fn_"]}, {"name": "digest256map_impl_HT_REP_IS_BAD_", "calls": ["digest256map_entry_hash"]}, {"name": "connection_or_get_num_circuits", "calls": ["channel_tls_to_base", "tor_assertion_failed_", "channel_num_circuits"]}, {"name": "config_find_option", "calls": ["config_find_option_mutable"]}, {"name": "onion_warning", "calls": ["log_fn_"]}, {"name": "networkstatus_vote_free", "calls": ["vote_routerstatus_free", "smartlist_free", "routerstatus_free", "authority_cert_free", "memwipe", "document_signature_free"]}, {"name": "validate_transports_in_state", "calls": ["tor_assertion_failed_", "state_transport_line_is_valid", "log_fn_"]}, {"name": "curve25519_impl", "calls": ["memwipe"]}, {"name": "tor_set_max_memlock", "calls": ["log_fn_"]}, {"name": "crypto_openssl_get_header_version_str", "calls": ["parse_openssl_version_str"]}, {"name": "smartlist_sort_pointers", "calls": ["smartlist_sort"]}, {"name": "hibernate_begin_shutdown", "calls": ["hibernate_begin"]}, {"name": "threadpool_get_replyqueue", "calls": []}, {"name": "circuit_build_times_network_is_live", "calls": ["approx_time", "control_event_network_liveness_update", "reschedule_descriptor_update_check", "log_fn_"]}, {"name": "node_get_or_create", "calls": ["nodelist_map_HT_INSERT", "smartlist_add", "node_get_mutable_by_id", "tor_malloc_zero_"]}, {"name": "sandbox_intern_string", "calls": ["log_fn_"]}, {"name": "nodelist_map_HT_FIND_P_", "calls": ["node_id_eq"]}, {"name": "onion_skin_server_handshake", "calls": ["onion_skin_TAP_server_handshake", "onion_skin_ntor_server_handshake", "memwipe", "tor_malloc_", "fast_server_handshake", "log_fn_"]}, {"name": "crypto_rand_int", "calls": ["crypto_rand", "tor_assertion_failed_"]}, {"name": "circuit_clear_cell_queue", "calls": ["cell_queue_clear", "circuitmux_is_circuit_attached", "TO_OR_CIRCUIT", "tor_assertion_failed_", "update_circuit_on_cmux_"]}, {"name": "routerlist_add_node_and_family", "calls": ["node_get_by_id", "nodelist_add_node_and_family"]}, {"name": "voter_get_sig_by_algorithm", "calls": []}, {"name": "memarea_get_stats", "calls": ["get_uint32", "tor_assertion_failed_"]}, {"name": "digest_from_base64", "calls": ["base64_decode"]}, {"name": "connection_or_compute_authenticate_cell_body", "calls": ["crypto_digest256", "crypto_pk_private_sign", "tor_tls_get_peer_cert", "tor_x509_cert_get_id_digests", "tor_tls_get_my_certs", "crypto_rand", "crypto_pk_keysize", "tor_tls_get_tlssecrets", "tor_assertion_failed_", "tor_x509_cert_free", "tor_x509_cert_get_cert_digests", "crypto_digest_get_digest", "log_fn_"]}, {"name": "cell_queues_get_total_allocation", "calls": ["packed_cell_mem_cost"]}, {"name": "router_should_rebuild_store", "calls": []}, {"name": "connection_ap_handshake_socks_resolved_addr", "calls": ["tor_addr_family", "tor_addr_to_ipv4n", "connection_ap_handshake_socks_resolved", "tor_addr_to_in6", "log_fn_"]}, {"name": "cached_resolve_hash", "calls": []}, {"name": "read_to_buf", "calls": ["tor_assertion_failed_", "read_to_chunk", "buf_add_chunk_with_capacity", "CHUNK_REMAINING_CAPACITY"]}, {"name": "ed_key_init_from_file", "calls": ["get_options", "read_encrypted_secret_key", "ed25519_seckey_read_from_file", "file_status", "crypto_write_tagged_contents_to_file", "ed_key_new", "tor_strdup_", "tor_cert_parse", "tor_cert_free", "tor_asprintf", "tor_log", "tor_snprintf", "tor_assertion_failed_", "tor_malloc_zero_", "ed25519_pubkey_write_to_file", "ed25519_pubkey_read_from_file", "tor_cert_checksig", "tor_memeq", "write_secret_key", "memwipe", "tor_cert_create", "ed25519_pubkey_eq", "crypto_read_tagged_contents_from_file"]}, {"name": "channel_when_last_recv", "calls": ["tor_assertion_failed_"]}, {"name": "did_last_state_file_write_fail", "calls": []}, {"name": "parse_config_line_from_str_verbose", "calls": ["tor_assertion_failed_", "unescape_string", "TOR_ISSPACE", "tor_strndup_"]}, {"name": "tor_tls_new", "calls": ["check_no_tls_errors_", "tor_tls_setup_session_secret_cb", "tls_log_errors", "tor_tls_context_incref", "tor_malloc_zero_", "log_fn_", "tor_assertion_failed_", "crypto_random_hostname"]}, {"name": "channel_tls_to_base", "calls": []}, {"name": "circuit_discard_optional_exit_enclaves", "calls": ["safe_str_client", "get_connection_array", "tor_assertion_failed_", "clear_trackexithost_mappings", "TO_ENTRY_CONN", "node_get_by_nickname", "node_get_by_id", "consider_plaintext_ports", "escaped_safe_str_client", "log_fn_"]}, {"name": "smartlist_overlap", "calls": ["smartlist_contains"]}, {"name": "rep_hist_note_used_port", "calls": ["add_predicted_port", "tor_assertion_failed_"]}, {"name": "cache_map_HT_NEXT_RMV", "calls": []}, {"name": "smartlist_uniq_digests256", "calls": []}, {"name": "ed25519_set_impl_params", "calls": []}, {"name": "pick_hsdir", "calls": ["get_options", "directory_clean_last_hid_serv_requests", "routerset_contains_node", "smartlist_add", "lookup_last_hid_serv_request", "smartlist_free", "smartlist_del", "smartlist_choose", "hid_serv_get_responsible_directories", "node_has_descriptor", "node_get_by_id", "tor_assertion_failed_", "smartlist_new", "log_fn_"]}, {"name": "dsmap_free", "calls": []}, {"name": "router_parse_addr_policy_item_from_string", "calls": ["memarea_drop_all", "TOR_ISDIGIT", "addr_policy_free", "tor_snprintf", "memarea_new", "router_parse_addr_policy", "tor_addr_family", "escaped", "eat_whitespace", "tor_assertion_failed_", "get_next_token", "tor_strlower", "token_clear", "log_fn_"]}, {"name": "ewma_free_cmux_data", "calls": ["tor_assertion_failed_", "smartlist_free", "TO_EWMA_POL_DATA"]}, {"name": "connection_or_num_cells_writeable", "calls": ["get_cell_network_size", "connection_get_outbuf_len", "tor_assertion_failed_"]}, {"name": "connection_edge_destroy", "calls": ["TO_OR_CONN", "connection_mark_for_close_internal_", "control_event_stream_bandwidth", "EDGE_TO_ENTRY_CONN", "log_fn_", "connection_or_close_for_error", "control_event_stream_status", "connection_mark_unattached_ap_"]}, {"name": "round_to_power_of_2", "calls": ["tor_log2"]}, {"name": "handle_control_redirectstream", "calls": ["get_stream", "smartlist_free", "strlcpy", "tor_strdup_", "send_control_done", "tor_parse_ulong", "getargs_helper", "connection_printf_to_buf"]}, {"name": "cmp_addr_policies", "calls": ["cmp_single_addr_policy"]}, {"name": "option_is_recognized", "calls": ["config_find_option"]}, {"name": "tell_controller_about_resolved_result", "calls": ["get_uint32", "tor_dup_ip", "control_event_address_mapped", "tor_strndup_"]}, {"name": "ewma_alloc_cmux_data", "calls": ["tor_malloc_zero_", "cell_ewma_get_tick", "tor_assertion_failed_", "smartlist_new"]}, {"name": "refill_callback", "calls": ["get_options", "tv_mdiff", "connection_bucket_refill", "tor_gettimeofday", "accounting_is_enabled", "accounting_add_bytes"]}, {"name": "rend_get_service_id", "calls": ["base32_encode", "tor_assertion_failed_", "crypto_pk_get_digest"]}, {"name": "circuit_state_to_string", "calls": ["tor_snprintf", "log_fn_"]}, {"name": "CONST_TO_OR_CIRCUIT", "calls": ["tor_assertion_failed_"]}, {"name": "check_sockaddr", "calls": ["tor_mem_is_zero", "log_fn_"]}, {"name": "circuit_truncated", "calls": ["circuit_mark_for_close_", "tor_assertion_failed_"]}, {"name": "circuit_pick_create_handshake", "calls": ["circuits_can_use_ntor", "tor_mem_is_zero"]}, {"name": "buf_new_with_capacity", "calls": ["preferred_chunk_size", "buf_new"]}, {"name": "validate_bridge_stats", "calls": ["parse_iso_time", "strlcpy", "tor_assertion_failed_", "format_iso_time", "find_str_at_start_of_line"]}, {"name": "check_extended_cell", "calls": ["check_created_cell"]}, {"name": "load_stats_file", "calls": ["get_options", "parse_iso_time", "strlcpy", "tor_strdup_", "read_file_to_str", "file_status", "options_get_datadir_fname2_suffix"]}, {"name": "dirvote_recalculate_timing", "calls": ["networkstatus_get_live_consensus", "tor_assertion_failed_", "format_iso_time", "authdir_mode_v3", "dirvote_get_start_of_next_interval", "log_fn_"]}, {"name": "get_interface_addresses_ioctl", "calls": ["tor_log", "ifreq_to_smartlist", "tor_realloc_", "tor_assertion_failed_"]}, {"name": "alert_sockets_create", "calls": ["set_socket_nonblocking", "tor_close_socket", "tor_socketpair"]}, {"name": "llvm.va_end", "calls": []}, {"name": "policies_parse_exit_policy", "calls": ["policies_parse_exit_policy_internal"]}, {"name": "log_portfw_spawn_error_message", "calls": ["tor_sscanf", "log_fn_"]}, {"name": "bootstrap_status_to_string", "calls": ["router_have_consensus_path"]}, {"name": "make_path_absolute", "calls": ["tor_assertion_failed_", "tor_strdup_", "tor_asprintf", "alloc_getcwd", "log_fn_"]}, {"name": "or_state_free_all", "calls": ["or_state_free"]}, {"name": "list_v3_auth_ids", "calls": ["tor_digest_is_zero", "smartlist_free", "hex_str", "tor_strdup_", "smartlist_add", "router_get_trusted_dir_servers", "smartlist_join_strings", "smartlist_new"]}, {"name": "write_chunks_to_file", "calls": ["write_chunks_to_file_impl"]}, {"name": "log_severity_to_event", "calls": []}, {"name": "dirserv_free_fingerprint_list", "calls": []}, {"name": "circuit_set_state", "calls": ["smartlist_add", "tor_assertion_failed_", "smartlist_new", "smartlist_remove"]}, {"name": "get_current_auth_key_cert", "calls": []}, {"name": "get_ext_or_auth_cookie_file_name", "calls": ["get_options", "tor_strdup_", "options_get_datadir_fname2_suffix"]}, {"name": "ewma_notify_circ_active", "calls": ["TO_EWMA_POL_CIRC_DATA", "add_cell_ewma", "TO_EWMA_POL_DATA", "tor_assertion_failed_"]}, {"name": "connection_listener_new", "calls": ["get_options", "fmt_addrport", "conn_type_to_string", "tor_addr_make_unspec", "dnsserv_configure_listener", "tor_getpwnam", "make_socket_reuseable", "check_location_for_unix_socket", "tor_strdup_", "tor_close_socket", "connection_add_impl", "tor_listen", "warn_too_many_conns", "tor_addr_from_sockaddr", "tor_open_socket_nonblocking", "tor_assertion_failed_", "tor_addr_family", "connection_start_reading", "connection_free", "listener_connection_new", "tor_addr_copy", "conn_listener_type_supports_af_unix", "log_fn_"]}, {"name": "digest256map_set", "calls": ["digest256map_assign_key", "digest256map_impl_HT_GROW", "digest256map_impl_HT_FIND_P_", "tor_assertion_failed_", "tor_malloc_zero_", "digest256map_entry_hash", "digest256map_assign_tmp_key"]}, {"name": "circuit_finish_handshake", "calls": ["tor_assertion_failed_", "onion_handshake_state_release", "pathbias_count_build_attempt", "onion_next_hop_in_cpath", "circuit_init_cpath_crypto", "circuit_log_path", "onion_skin_client_handshake", "control_event_circuit_status", "log_fn_"]}, {"name": "crypto_rand_double", "calls": ["crypto_rand"]}, {"name": "consider_recording_trackhost", "calls": ["get_options", "base16_encode", "hostname_in_track_host_exits", "addressmap_have_mapping", "addressmap_register", "tor_asprintf"]}, {"name": "connection_or_process_inbuf", "calls": ["channel_tls_to_base", "channel_timestamp_active", "connection_or_nonopen_was_started_here", "conn_state_to_string", "connection_or_process_cells_from_inbuf", "tor_assertion_failed_", "get_options", "connection_tls_start_handshake", "log_fn_", "buf_datalen", "connection_read_proxy_handshake", "connection_or_close_for_error"]}, {"name": "router_new_address_suggestion", "calls": ["get_options", "tor_addr_is_internal_", "tor_addr_compare", "tor_addr_copy", "tor_addr_from_ipv4n", "server_mode", "escaped", "resolve_my_address", "ip_address_changed", "tor_addr_parse", "control_event_server_status", "log_addr_has_changed", "get_last_resolved_addr", "log_fn_"]}, {"name": "write_all", "calls": ["tor_assertion_failed_"]}, {"name": "tor_getpwnam", "calls": ["tor_passwd_dup", "tor_passwd_free", "log_fn_"]}, {"name": "tor_version_as_new_as", "calls": ["strlcpy", "tor_assertion_failed_", "tor_version_compare", "eat_whitespace", "strcmpstart", "tor_version_parse", "find_whitespace", "log_fn_"]}, {"name": "sample_laplace_distribution", "calls": ["clamp_double_to_int64", "tor_assertion_failed_", "tor_mathlog"]}, {"name": "circuit_mark_for_close_", "calls": ["assert_circuit_ok", "tor_assertion_failed_", "pathbias_check_close", "TO_OR_CIRCUIT", "smartlist_new", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "smartlist_add", "log_fn_"]}, {"name": "ntor_handshake_state_free", "calls": ["memwipe"]}, {"name": "node_get_pref_orport", "calls": ["get_options", "node_ipv6_preferred", "tor_assertion_failed_", "node_get_prim_orport", "node_get_pref_ipv6_orport"]}, {"name": "circuit_resume_edge_reading", "calls": ["circuit_queue_streams_are_blocked", "TO_ORIGIN_CIRCUIT", "circuit_resume_edge_reading_helper", "TO_OR_CIRCUIT", "log_fn_"]}, {"name": "node_id_eq", "calls": ["tor_memeq"]}, {"name": "router_digest_is_me", "calls": ["tor_memeq"]}, {"name": "connection_fetch_from_buf_socks_client", "calls": ["fetch_from_buf_socks_client"]}, {"name": "channel_note_destroy_pending", "calls": ["circuit_get_by_circid_channel_even_if_marked", "channel_mark_circid_unusable", "TO_OR_CIRCUIT"]}, {"name": "router_get_by_descriptor_digest", "calls": ["tor_assertion_failed_", "sdmap_get"]}, {"name": "rep_history_clean", "calls": ["get_options", "digestmap_iter_init", "digestmap_iter_next", "digestmap_iter_get", "free_or_history", "digestmap_iter_done", "digestmap_iter_next_rmv", "authdir_mode"]}, {"name": "is_test_address", "calls": ["get_options", "smartlist_contains_string_case"]}, {"name": "update_consensus_router_descriptor_downloads", "calls": ["get_options", "smartlist_free", "router_add_to_routerlist", "directory_caches_dir_info", "router_get_by_id_digest", "launch_descriptor_downloads", "trusteddirserver_get_by_v3_auth_digest", "authdir_mode", "routerstatus_describe", "routerlist_assert_ok", "router_get_by_descriptor_digest", "digestmap_new", "client_would_use_router", "digestmap_get", "WRA_WAS_OUTDATED", "download_status_is_ready", "smartlist_add", "tor_assertion_failed_", "list_pending_descriptor_downloads", "directory_too_idle_to_fetch_descriptors", "authdir_mode_handles_descs", "tor_memeq", "router_get_routerlist", "format_iso_time", "dirserv_would_reject_router", "smartlist_new", "routerlist_reparse_old", "log_fn_"]}, {"name": "set_main_thread", "calls": ["tor_get_thread_id"]}, {"name": "rep_hist_circbuilding_dormant", "calls": ["get_options", "server_mode", "circuit_enough_testing_circs", "any_predicted_circuits", "check_whether_dirport_reachable", "check_whether_orport_reachable"]}, {"name": "crypto_unpwbox", "calls": ["secret_to_key_derivekey", "crypto_cipher_free", "crypto_hmac_sha256", "crypto_cipher_decrypt", "memwipe", "crypto_cipher_new_with_iv", "tor_malloc_zero_", "tor_memeq"]}, {"name": "h_tweak", "calls": ["crypto_hmac_sha256"]}, {"name": "init_circuit_base", "calls": ["smartlist_add", "tor_gettimeofday", "cell_queue_init", "circuit_initial_package_window", "circuit_get_global_list"]}, {"name": "rend_client_close_other_intros", "calls": ["TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "rend_cmp_service_ids", "circuit_get_global_list", "log_fn_"]}, {"name": "set_uint32", "calls": []}, {"name": "chanid_circid_muxinfo_map_HT_CLEAR", "calls": ["chanid_circid_muxinfo_map_HT_INIT", "tor_free_"]}, {"name": "getinfo_helper_networkstatus", "calls": ["get_options", "smartlist_free", "we_use_microdescriptors_for_circuits", "router_get_consensus_status_by_id", "networkstatus_get_latest_consensus", "networkstatus_getinfo_by_purpose", "smartlist_add", "strcmpstart", "format_iso_time", "smartlist_join_strings", "tor_strdup_", "base16_decode", "router_get_consensus_status_by_nickname", "networkstatus_getinfo_helper_single", "smartlist_new"]}, {"name": "tor_cert_create", "calls": ["tor_cert_sign_impl"]}, {"name": "suppress_libevent_log_msg", "calls": []}, {"name": "directory_all_unreachable", "calls": ["tor_assertion_failed_", "tor_libevent_get_base"]}, {"name": "add_unix_port", "calls": ["smartlist_add", "tor_assertion_failed_"]}, {"name": "channel_listener_get_listener_fn", "calls": ["tor_assertion_failed_"]}, {"name": "connection_dir_client_reached_eof", "calls": ["control_event_hs_descriptor_failed", "get_options", "body_is_plausible", "dirvote_add_signatures", "router_new_address_suggestion", "control_event_hs_descriptor_content", "dirvote_add_vote", "router_dirport_found_reachable", "tor_strdup_", "detect_compression_method", "router_get_trusteddirserver_by_digest", "smartlist_free", "escaped", "control_event_hs_descriptor_upload_failed", "router_digest_is_trusted_dir_type", "control_event_bootstrap", "router_get_mutable_consensus_status_by_id", "router_get_fallback_dirserver_by_digest", "tor_gzip_uncompress", "connection_fetch_from_buf_http", "update_microdescs_from_networkstatus", "tor_log", "clock_skew_warning", "get_microdesc_cache", "dir_routerdesc_download_failed", "control_event_hs_descriptor_uploaded", "dir_split_resource_into_fingerprints", "directory_info_has_arrived", "rend_get_service_id", "http_get_header", "control_event_server_status", "rend_service_desc_has_uploaded", "trusted_dirs_load_certs_from_string", "routers_update_all_from_networkstatus", "parse_http_response", "note_client_request", "connection_dir_download_cert_failed", "update_microdesc_downloads", "tor_assertion_failed_", "router_load_extrainfo_from_string", "rend_cache_store_v2_desc_as_client", "networkstatus_consensus_download_failed", "networkstatus_set_current_consensus", "microdescs_add_to_cache", "directories_have_accepted_server_descriptor", "count_loading_descriptors_progress", "rend_client_desc_trynow", "strcmpstart", "control_event_hs_descriptor_received", "dir_microdesc_download_failed", "memwipe", "log_fn_", "load_downloaded_routers", "smartlist_new", "directory_conn_is_self_reachability_test", "connection_dir_download_routerdesc_failed"]}, {"name": "rep_hist_desc_stats_write", "calls": ["get_options", "rep_hist_reset_desc_stats", "tor_assertion_failed_", "check_or_create_data_subdir", "options_get_datadir_fname2_suffix", "rep_hist_format_desc_stats", "append_bytes_to_file", "log_fn_"]}, {"name": "authority_cert_free", "calls": ["crypto_pk_free"]}, {"name": "rate_limit_log", "calls": ["rate_limit_is_ready", "tor_asprintf", "tor_strdup_"]}, {"name": "connection_or_change_state", "calls": ["channel_tls_handle_state_change_on_orconn", "tor_assertion_failed_"]}, {"name": "rend_service_intro_established", "calls": ["safe_str_client", "base32_encode", "circuit_change_purpose", "tor_assertion_failed_", "pathbias_mark_use_success", "find_intro_point", "circuit_mark_for_close_", "rend_service_get_by_pk_digest", "log_fn_"]}, {"name": "consider_hibernation", "calls": ["get_options", "hibernate_begin", "hibernate_soft_limit_reached", "hibernate_end_time_elapsed", "format_local_iso_time", "tor_assertion_failed_", "tor_cleanup", "hibernate_go_dormant", "hibernate_hard_limit_reached", "hibernate_end", "log_fn_"]}, {"name": "second_elapsed_callback", "calls": ["get_options", "control_event_circuit_cell_stats", "control_event_stream_bandwidth_used", "run_scheduled_events", "router_get_my_routerinfo", "control_event_bandwidth_used", "server_mode", "control_event_conn_bandwidth_used", "update_approx_time", "tor_dup_ip", "circuit_note_clock_jumped", "net_is_disabled", "control_event_circ_bandwidth_used", "check_whether_dirport_reachable", "control_event_server_status", "have_completed_a_circuit", "check_whether_orport_reachable", "log_fn_"]}, {"name": "strmap_remove_lc", "calls": ["tor_strdup_", "strmap_remove", "tor_strlower"]}, {"name": "crypto_pk_public_encrypt", "calls": ["crypto_pk_keysize", "crypto_log_errors", "tor_assertion_failed_", "crypto_get_rsa_padding"]}, {"name": "estimated_usec_for_onionskins", "calls": []}, {"name": "node_id_hash", "calls": []}, {"name": "circuit_purpose_to_controller_hs_state_string", "calls": ["log_fn_"]}, {"name": "digest256map_impl_HT_FIND", "calls": ["digest256map_impl_HT_FIND_P_", "digest256map_entry_hash"]}, {"name": "cache_map_HT_CLEAR", "calls": ["cache_map_HT_INIT", "tor_free_"]}, {"name": "clientmap_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "c_hist_compare_", "calls": []}, {"name": "router_purpose_to_string", "calls": ["tor_assertion_failed_"]}, {"name": "new_cached_dir", "calls": ["tor_gzip_compress", "tor_malloc_zero_", "log_fn_"]}, {"name": "compare_digests_", "calls": ["tor_memcmp"]}, {"name": "rend_cache_store_v2_desc_as_service", "calls": ["rend_parse_v2_service_descriptor", "rend_service_descriptor_free", "strlcpy", "tor_assertion_failed_", "strmap_set_lc", "strmap_get_lc", "tor_malloc_zero_", "rend_get_service_id", "safe_str_client", "rend_cache_decrement_allocation", "log_fn_", "rend_cache_increment_allocation", "rend_cache_entry_allocation"]}, {"name": "tor_split_lines", "calls": ["TOR_ISPRINT", "smartlist_add"]}, {"name": "stream_choice_seed_weak_rng", "calls": ["crypto_seed_weak_rng"]}, {"name": "add_noparam_filter", "calls": ["log_fn_"]}, {"name": "channel_get_var_cell_handler", "calls": ["channel_is_in_state", "tor_assertion_failed_"]}, {"name": "circuit_get_by_circid_channel_even_if_marked", "calls": ["circuit_get_by_circid_channel_impl"]}, {"name": "dircollator_new", "calls": ["double_digest_map_HT_INIT", "tor_assertion_failed_", "tor_malloc_zero_", "digestmap_new"]}, {"name": "router_differences_are_cosmetic", "calls": ["cmp_addr_policies", "tor_addr_compare", "crypto_pk_eq_keys", "tor_assertion_failed_"]}, {"name": "connection_dir_finished_flushing", "calls": ["tor_assertion_failed_", "geoip_change_dirreq_state", "connection_mark_for_close_", "log_fn_"]}, {"name": "smartlist_bsearch", "calls": []}, {"name": "buf_find_pos_of_char", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_launch_by_extend_info", "calls": ["get_options", "router_have_minimum_dir_info", "circuit_change_purpose", "pathbias_check_close", "circuit_purpose_to_string", "circuit_extend_to_new_exit", "have_enough_path_info", "control_event_circuit_cannibalized", "tor_gettimeofday", "circuit_establish_circuit", "circuit_find_to_cannibalize", "tor_assertion_failed_", "build_state_get_exit_nickname", "log_fn_"]}, {"name": "connection_or_is_bad_for_new_circs", "calls": ["channel_tls_to_base", "tor_assertion_failed_", "channel_is_bad_for_new_circs"]}, {"name": "eimap_set", "calls": ["digestmap_set"]}, {"name": "connection_ext_or_handle_cmd_useraddr", "calls": ["get_options", "tor_memdup_nulterm_", "tor_dup_addr", "tor_addr_copy", "tor_addr_parse", "safe_str", "tor_addr_port_split", "log_fn_"]}, {"name": "signed_descriptor_free", "calls": []}, {"name": "nodelist_add_node_and_family", "calls": ["get_options", "routerset_contains_node", "smartlist_add", "addrs_in_same_network_family", "tor_assertion_failed_", "node_get_declared_family", "routerset_get_all_nodes", "nodelist_get_list", "node_get_by_nickname", "node_get_addr", "node_get_by_id", "node_nickname_matches"]}, {"name": "channel_timestamp_recv", "calls": ["tor_assertion_failed_"]}, {"name": "directory_fetches_dir_info_later", "calls": []}, {"name": "geoip_format_bridge_stats", "calls": ["tor_asprintf", "geoip_get_client_history", "format_iso_time", "geoip_get_transport_history"]}, {"name": "nodelist_set_routerinfo", "calls": ["get_options", "dirserv_set_node_flags_from_authoritative_status", "init_nodelist", "routers_have_same_or_addrs", "tor_assertion_failed_", "node_addrs_changed", "node_set_country", "node_get_or_create", "dirserv_router_get_status", "authdir_mode"]}, {"name": "control_event_clients_seen", "calls": ["send_control_event"]}, {"name": "channel_unregister", "calls": ["tor_digest_is_zero", "channel_is_in_state", "smartlist_remove", "channel_remove_from_digest_map", "tor_assertion_failed_"]}, {"name": "tor_tls_free_all", "calls": ["check_no_tls_errors_", "tor_tls_context_decref"]}, {"name": "trusteddirserver_get_by_v3_auth_digest", "calls": ["tor_memeq"]}, {"name": "mark_all_dirservers_up", "calls": ["router_dir_info_changed", "control_event_networkstatus_changed_single", "node_get_mutable_by_id", "router_get_mutable_consensus_status_by_id"]}, {"name": "crypto_pk_private_sign_digest", "calls": ["crypto_pk_private_sign", "crypto_digest", "memwipe"]}, {"name": "rend_data_dup", "calls": ["tor_memdup_", "smartlist_add", "tor_assertion_failed_", "smartlist_new"]}, {"name": "broken_state_count_compare", "calls": []}, {"name": "routerlist_retry_directory_downloads", "calls": ["router_reset_status_download_failures", "router_reset_descriptor_download_failures", "reschedule_directory_downloads"]}, {"name": "channel_idmap_HT_INIT", "calls": []}, {"name": "ifreq_to_smartlist", "calls": ["smartlist_add", "tor_malloc_", "tor_memdup_", "tor_addr_from_sockaddr", "smartlist_new"]}, {"name": "config_line_find", "calls": []}, {"name": "config_register_addressmaps", "calls": ["addressmap_clear_configured", "smartlist_clear", "smartlist_split_string", "smartlist_free", "addressmap_register_auto", "smartlist_new", "log_fn_"]}, {"name": "bridge_free", "calls": ["smartlist_free"]}, {"name": "circuit_is_better", "calls": ["connection_edge_update_circuit_isolation", "n_bits_set_u8"]}, {"name": "scale_single_cell_ewma", "calls": ["get_scale_factor"]}, {"name": "is_sensitive_dir_purpose", "calls": []}, {"name": "tor_process_handle_destroy", "calls": ["clear_waitpid_callback", "tor_terminate_process", "tor_process_get_pid", "log_fn_"]}, {"name": "dirreqmap_HT_CLEAR", "calls": ["tor_free_", "dirreqmap_HT_INIT"]}, {"name": "tor_parse_double", "calls": []}, {"name": "dirvote_format_all_microdesc_vote_lines", "calls": ["microdesc_free_", "smartlist_add", "dirvote_create_microdescriptor", "tor_malloc_zero_", "dirvote_format_microdesc_vote_line", "tor_strdup_"]}, {"name": "dirserv_read_guardfraction_file", "calls": ["read_file_to_str", "dirserv_read_guardfraction_file_from_str", "log_fn_"]}, {"name": "rend_mid_establish_rendezvous", "calls": ["get_options", "circuit_set_rendezvous_cookie", "base16_encode", "circuit_get_rendezvous", "circuit_change_purpose", "circuit_purpose_to_string", "circuit_mark_for_close_", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "smartlist_add_all", "calls": ["smartlist_ensure_capacity", "tor_assertion_failed_"]}, {"name": "crypto_add_spaces_to_fp", "calls": ["tor_assertion_failed_"]}, {"name": "authdir_wants_to_reject_router", "calls": ["router_describe", "esc_router_info", "tor_assertion_failed_", "dirserv_router_has_valid_address", "dirserv_router_get_status", "log_fn_"]}, {"name": "channel_add_to_digest_map", "calls": ["tor_digest_is_zero", "hex_str", "channel_idmap_HT_FIND", "channel_is_in_state", "tor_assertion_failed_", "tor_malloc_", "channel_state_to_string", "channel_idmap_HT_INSERT", "log_fn_"]}, {"name": "crypto_digest_free", "calls": ["crypto_digest_alloc_bytes", "memwipe"]}, {"name": "tor_addr_family", "calls": []}, {"name": "dirserv_router_has_valid_address", "calls": ["get_options", "router_describe", "tor_addr_is_internal_", "tor_addr_from_ipv4n", "log_fn_"]}, {"name": "circuit_build_times_count_close", "calls": ["circuit_build_times_get_initial_timeout", "circuit_build_times_network_check_live", "circuit_build_times_disabled", "circuit_build_times_network_close", "circuit_build_times_add_time"]}, {"name": "microdescs_add_list_to_cache", "calls": ["smartlist_clear", "microdesc_free_", "microdesc_map_HT_INSERT", "networkstatus_get_latest_consensus", "router_dir_info_changed", "microdesc_map_HT_FIND", "abort_writing_to_file", "smartlist_new", "start_writing_to_file", "dump_microdescriptor", "nodelist_add_microdesc", "finish_writing_to_file", "smartlist_add", "log_fn_"]}, {"name": "median_time", "calls": ["find_nth_time"]}, {"name": "queued_event_free", "calls": []}, {"name": "conn_get_buffer_age", "calls": ["buf_get_oldest_chunk_timestamp"]}, {"name": "rend_client_note_connection_attempt_ended", "calls": ["purge_hid_serv_from_last_hid_serv_requests", "safe_str_client", "rend_cache_lookup_entry", "log_fn_"]}, {"name": "strcmp_len", "calls": []}, {"name": "record_num_bytes_transferred_impl", "calls": ["rep_hist_note_or_conn_bytes", "rep_hist_note_dir_bytes_written", "rep_hist_note_bytes_written", "rep_hist_note_exit_bytes", "connection_is_rate_limited", "rep_hist_note_bytes_read", "rep_hist_note_dir_bytes_read"]}, {"name": "dircollator_collate_by_ed25519", "calls": ["digestmap_iter_next", "digestmap_iter_get", "tor_assertion_failed_", "smartlist_add", "digestmap_new", "digestmap_iter_done", "double_digest_map_HT_NEXT", "digestmap_get", "digestmap_set", "digestmap_iter_init", "double_digest_map_HT_START"]}, {"name": "strmap_impl_HT_INIT", "calls": []}, {"name": "smartlist_uniq_digests", "calls": []}, {"name": "have_room_for_onionskin", "calls": ["get_options", "num_ntors_per_tap", "get_num_cpus", "estimated_usec_for_onionskins"]}, {"name": "geoip_get_transport_history", "calls": ["smartlist_free", "clientmap_HT_START", "safe_str_client", "tor_strdup_", "strmap_new", "smartlist_sort_strings", "smartlist_add", "smartlist_join_strings", "smartlist_add_asprintf", "round_uint64_to_next_multiple_of", "clientmap_HT_NEXT", "fmt_addr_impl", "strmap_get", "smartlist_new", "strmap_set", "log_fn_"]}, {"name": "clear_passphrase", "calls": ["memwipe"]}, {"name": "crypto_pk_get_hashed_fingerprint", "calls": ["crypto_digest", "base16_encode", "crypto_pk_get_digest"]}, {"name": "get_server_identity_key", "calls": ["assert_identity_keys_ok", "get_options", "tor_assertion_failed_", "server_mode"]}, {"name": "rep_hist_fill_bandwidth_history", "calls": ["get_options", "tor_assertion_failed_", "tor_snprintf"]}, {"name": "ewma_notify_circ_inactive", "calls": ["TO_EWMA_POL_CIRC_DATA", "remove_cell_ewma", "TO_EWMA_POL_DATA", "tor_assertion_failed_"]}, {"name": "get_proxy_addrport", "calls": ["get_options", "get_transport_by_bridge_addrport", "tor_addr_make_unspec", "tor_addr_copy"]}, {"name": "ed25519_pubkey_eq", "calls": ["tor_assertion_failed_", "tor_memeq"]}, {"name": "options_init_from_string", "calls": ["options_init", "set_options", "tor_asprintf", "config_free", "tor_assertion_failed_", "config_dup", "tor_malloc_zero_", "config_get_lines", "config_free_lines", "config_assign", "config_find_option_mutable", "options_transition_allowed", "tor_strdup_", "options_validate"]}, {"name": "bidi_map_free", "calls": ["bidimap_HT_CLEAR", "bidimap_HT_NEXT_RMV", "bidimap_HT_START"]}, {"name": "dirserv_get_measured_bw_cache_size", "calls": ["digestmap_size"]}, {"name": "get_uptime", "calls": []}, {"name": "connection_mark_all_noncontrol_connections", "calls": ["TO_OR_CONN", "connection_or_close_normally", "get_connection_array", "TO_ENTRY_CONN", "connection_mark_for_close_", "connection_mark_unattached_ap_"]}, {"name": "curve25519_secret_key_generate", "calls": ["curve25519_rand_seckey_bytes"]}, {"name": "router_get_mutable_consensus_status_by_descriptor_digest", "calls": ["get_options", "we_use_microdescriptors_for_circuits", "digestmap_get", "digestmap_new", "digestmap_set"]}, {"name": "connection_fetch_from_buf_line", "calls": ["fetch_from_buf_line"]}, {"name": "load_torrc_from_stdin", "calls": ["read_file_to_str_until_eof"]}, {"name": "get_transport_bindaddr", "calls": ["strcmpstart", "tor_asprintf"]}, {"name": "fp_pair_map_impl_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "microdescs_parse_from_string", "calls": ["get_options", "crypto_digest256", "smartlist_free", "find_by_keyword_", "ed25519_public_from_base64", "memarea_clear", "memarea_drop_all", "find_start_of_next_microdesc", "eat_whitespace_eos", "tor_strdup_", "find_all_by_keyword", "tor_memstr", "tor_memdup_", "curve25519_public_from_base64", "tor_memdup_nulterm_", "parse_iso_time", "microdesc_free_", "tor_assertion_failed_", "smartlist_add", "crypto_pk_public_exponent_ok", "find_single_ipv6_orport", "parse_short_policy", "tor_malloc_zero_", "smartlist_clear", "escaped", "find_opt_by_keyword", "memarea_new", "tokenize_string", "is_legal_nickname_or_hexdigest", "smartlist_new", "token_clear", "log_fn_"]}, {"name": "directory_caches_unknown_auth_certs", "calls": ["dir_server_mode"]}, {"name": "crypto_pk_read_private_key_from_filename", "calls": ["crypto_pk_check_key", "read_file_to_str", "memwipe", "crypto_pk_read_private_key_from_string", "log_fn_"]}, {"name": "connection_about_to_close_connection", "calls": ["TO_OR_CONN", "connection_or_about_to_close", "connection_dir_about_to_close", "TO_DIR_CONN", "tor_assertion_failed_", "TO_ENTRY_CONN", "TO_EDGE_CONN", "connection_ap_about_to_close", "connection_exit_about_to_close"]}, {"name": "hex_digest_nickname_decode", "calls": ["tor_assertion_failed_", "base16_decode", "strlcpy"]}, {"name": "tor_tls_context_incref", "calls": []}, {"name": "replaycache_free", "calls": ["log_fn_"]}, {"name": "circuit_clear_cpath", "calls": ["circuit_free_cpath_node"]}, {"name": "get_circuit_build_timeout_ms", "calls": []}, {"name": "process_map_HT_FIND_P_", "calls": ["process_map_entries_eq_"]}, {"name": "extrainfo_free_", "calls": ["extrainfo_free"]}, {"name": "init_nodelist", "calls": ["tor_malloc_zero_", "smartlist_new", "nodelist_map_HT_INIT"]}, {"name": "buf_remove_from_front", "calls": ["chunk_free_unchecked", "tor_assertion_failed_"]}, {"name": "compare_tor_addr_to_addr_policy", "calls": ["compare_unknown_tor_addr_to_addr_policy", "tor_addr_family", "compare_known_tor_addr_to_addr_policy_noport", "compare_known_tor_addr_to_addr_policy", "tor_addr_is_null", "log_fn_"]}, {"name": "parse_socks_client", "calls": ["socks4_response_code_to_string", "tor_strdup_", "tor_assertion_failed_", "socks5_response_code_to_string", "log_fn_"]}, {"name": "rep_hist_note_router_reachable", "calls": ["get_options", "rep_hist_note_router_unreachable", "tor_addr_compare", "hex_str", "networkstatus_get_latest_consensus", "format_local_iso_time", "tor_addr_is_null", "tor_assertion_failed_", "tor_addr_copy", "rep_hist_note_router_reachable", "get_or_history", "log_fn_"]}, {"name": "tor_passwd_dup", "calls": ["tor_malloc_zero_", "tor_strdup_"]}, {"name": "fetch_networkstatus_callback", "calls": ["get_options", "should_delay_dir_fetches", "networkstatus_consensus_is_boostrapping", "update_networkstatus_downloads", "directory_fetches_from_authorities"]}, {"name": "get_dirportfrontpage", "calls": []}, {"name": "generate_key", "calls": ["crypto_pk_get_rsa_", "crypto_pk_generate_key_with_bits", "crypto_pk_free", "crypto_pk_new"]}, {"name": "extended_cell_format", "calls": ["set_uint16", "check_extended_cell"]}, {"name": "edmap_HT_INSERT", "calls": ["edmap_HT_GROW", "keypin_ent_hash_ed"]}, {"name": "rep_hist_downrate_old_runs", "calls": ["digestmap_iter_next", "digestmap_iter_get", "digestmap_new", "digestmap_iter_done", "digestmap_iter_init", "log_fn_"]}, {"name": "connection_start_reading_from_linked_conn", "calls": ["smartlist_contains", "smartlist_add", "tor_assertion_failed_", "tor_libevent_get_base"]}, {"name": "digit_to_num", "calls": ["tor_assertion_failed_"]}, {"name": "get_master_rsa_crosscert", "calls": []}, {"name": "clientmap_HT_FIND_P_", "calls": ["clientmap_entries_eq"]}, {"name": "networkstatus_get_detached_signatures", "calls": ["smartlist_free", "base16_encode", "networkstatus_format_signatures", "smartlist_add", "networkstatus_get_flavor_name", "tor_assertion_failed_", "crypto_digest_algorithm_get_name", "smartlist_add_asprintf", "format_iso_time", "tor_mem_is_zero", "smartlist_join_strings", "smartlist_new", "log_fn_"]}, {"name": "channel_when_created", "calls": ["tor_assertion_failed_"]}, {"name": "compute_consensus_package_lines", "calls": ["smartlist_clear", "validate_recommended_package_line", "strmap_new", "smartlist_add", "smartlist_sort_strings", "smartlist_free", "smartlist_add_asprintf", "strmap_iter_done", "tor_strndup_", "strmap_set", "tor_calloc_", "strmap_get", "strmap_iter_get", "smartlist_join_strings", "strmap_iter_init", "smartlist_get_most_frequent_string_", "strmap_iter_next", "smartlist_new"]}, {"name": "TO_ENTRY_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "digestmap_iter_next_rmv", "calls": ["digestmap_entry_free", "tor_assertion_failed_", "digestmap_impl_HT_NEXT_RMV"]}, {"name": "strcmp_opt", "calls": []}, {"name": "notify_pending_waitpid_callbacks", "calls": []}, {"name": "ewma_alloc_circ_data", "calls": ["cell_ewma_get_tick", "tor_assertion_failed_", "tor_malloc_zero_"]}, {"name": "config_expand_abbrev", "calls": ["log_fn_"]}, {"name": "buf_allocation", "calls": []}, {"name": "download_status_get_n_attempts", "calls": []}, {"name": "transport_get_by_name", "calls": ["tor_assertion_failed_"]}, {"name": "memeq_opt", "calls": ["tor_memeq"]}, {"name": "dirvote_create_microdescriptor", "calls": ["smartlist_free", "fmt_addrport", "smartlist_join_strings", "write_short_policy", "digest_to_base64", "crypto_pk_write_public_key_to_string", "policy_summarize", "smartlist_add_asprintf", "tor_addr_is_null", "microdescs_parse_from_string", "ed25519_public_to_base64", "microdesc_free_", "base64_encode", "smartlist_new", "log_fn_"]}, {"name": "round_uint32_to_next_multiple_of", "calls": ["tor_assertion_failed_"]}, {"name": "predicted_ports_free", "calls": ["smartlist_free"]}, {"name": "tor_open_socket_with_extensions", "calls": ["set_socket_nonblocking", "socket_accounting_lock", "tor_close_socket_simple", "get_n_open_sockets", "socket_accounting_unlock", "log_fn_"]}, {"name": "heartbeat_callback", "calls": ["log_heartbeat"]}, {"name": "tor_cert_dup", "calls": ["tor_memdup_"]}, {"name": "tor_cond_signal_one", "calls": []}, {"name": "router_get_advertised_dir_port", "calls": ["router_get_active_listener_port_by_type_af", "get_first_advertised_port_by_type_af"]}, {"name": "tor_open_socket", "calls": ["tor_open_socket_with_extensions"]}, {"name": "connection_dir_download_routerdesc_failed", "calls": ["tor_assertion_failed_"]}, {"name": "getaddrinfo_cache_HT_NEXT_RMV", "calls": []}, {"name": "circuitmux_num_cells", "calls": ["tor_assertion_failed_"]}, {"name": "command_setup_listener", "calls": ["tor_assertion_failed_", "channel_listener_set_listener_fn"]}, {"name": "connection_read_proxy_handshake", "calls": ["get_options", "pt_get_socks_args_for_proxy_addrport", "connection_proxy_state_to_string", "connection_fetch_from_buf_socks_client", "get_proxy_type", "connection_write_to_buf", "tor_assertion_failed_", "escaped", "connection_send_socks5_connect", "connection_read_https_proxy_response", "log_fn_"]}, {"name": "eimap_to_digestmap", "calls": []}, {"name": "tor_addr_to_in", "calls": []}, {"name": "rep_hist_exit_stats_init", "calls": ["tor_calloc_"]}, {"name": "dns_seems_to_be_broken_for_ipv6", "calls": []}, {"name": "connection_or_group_set_badness", "calls": ["channel_tls_to_base", "tor_addr_compare", "connection_or_is_bad_for_new_circs", "channel_is_better", "connection_or_mark_bad_for_new_circs", "log_fn_"]}, {"name": "fp_pair_map_iter_next_rmv", "calls": ["tor_assertion_failed_", "fp_pair_map_impl_HT_NEXT_RMV"]}, {"name": "circuit_extend_to_new_exit", "calls": ["warn_if_last_router_excluded", "circuit_send_next_onion_skin", "tor_gettimeofday", "extend_info_describe", "circuit_mark_for_close_", "circuit_set_state", "circuit_append_new_exit", "log_fn_"]}, {"name": "switch_id", "calls": ["log_credential_status", "drop_capabilities", "tor_getpwnam", "tor_assertion_failed_", "log_fn_"]}, {"name": "connection_free_all", "calls": ["clear_broken_connection_map", "smartlist_free", "control_update_global_event_mask", "connection_free_", "connection_or_clear_identity_map", "get_connection_array", "connection_or_clear_ext_or_id_map", "TO_CONTROL_CONN"]}, {"name": "write_bridge_ns_callback", "calls": ["networkstatus_dump_bridge_status_to_file"]}, {"name": "tor_mutex_release", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "config_value_needs_escape", "calls": ["TOR_ISPRINT"]}, {"name": "directory_get_from_dirserver", "calls": ["get_options", "networkstatus_get_latest_consensus_by_flavor", "dir_conn_purpose_to_string", "dir_fetch_type", "router_pick_directory_server", "log_fn_", "dirserv_get_consensus", "directory_initiate_command_routerstatus", "node_get_addr", "purpose_needs_anonymity", "choose_random_dirguard", "directory_initiate_command", "networkstatus_parse_flavor_name", "directory_all_unreachable", "directory_pick_generic_dirserver", "router_pick_trusteddirserver", "directory_fetches_from_authorities"]}, {"name": "_cmp_int", "calls": []}, {"name": "scheduler_retrigger", "calls": ["tor_assertion_failed_"]}, {"name": "node_get_addr", "calls": ["tor_addr_copy", "node_get_prim_orport"]}, {"name": "log_fn_ratelim_", "calls": ["logv", "approx_time", "rate_limit_log"]}, {"name": "parse_http_url", "calls": ["strlcpy", "tor_strndup_", "tor_malloc_", "tor_sscanf", "eat_whitespace_no_nl", "strcmpstart", "find_whitespace", "strlcat", "log_fn_"]}, {"name": "digestset_contains", "calls": ["bitarray_is_set"]}, {"name": "router_get_hash_impl_helper", "calls": ["tor_memstr", "log_fn_"]}, {"name": "set_waitpid_callback", "calls": ["tor_malloc_zero_", "process_map_HT_REPLACE", "log_fn_"]}, {"name": "circuit_expire_old_circuits_serverside", "calls": ["circuit_mark_for_close_", "TO_OR_CIRCUIT", "circuit_get_global_list", "channel_when_last_xmit", "log_fn_"]}, {"name": "routers_update_status_from_consensus_networkstatus", "calls": ["get_options", "dirserv_should_launch_reachability_test", "we_use_microdescriptors_for_circuits", "routers_sort_by_identity", "router_get_mutable_by_digest", "router_dir_info_changed", "authdir_mode_v3", "download_status_reset", "tor_memcmp", "tor_memeq"]}, {"name": "channel_idmap_HT_FIND", "calls": ["channel_idmap_hash", "channel_idmap_HT_FIND_P_"]}, {"name": "config_free_all", "calls": ["smartlist_free", "config_free_lines", "port_cfg_free", "or_options_free"]}, {"name": "connection_write_to_buf", "calls": ["connection_write_to_buf_impl_"]}, {"name": "tor_addr_to_ipv4h", "calls": ["tor_addr_to_ipv4n"]}, {"name": "tor_addr_to_ipv4n", "calls": []}, {"name": "connection_link_connections", "calls": ["tor_assertion_failed_"]}, {"name": "format_dec_number_sigsafe", "calls": ["format_number_sigsafe"]}, {"name": "socks5_response_code_to_string", "calls": []}, {"name": "rend_cache_decrement_allocation", "calls": ["log_fn_"]}, {"name": "pathbias_get_notice_use_rate", "calls": ["networkstatus_get_param"]}, {"name": "connection_bucket_refill_helper", "calls": ["log_fn_"]}, {"name": "microdesc_map_HT_REMOVE", "calls": ["microdesc_hash_", "microdesc_map_HT_FIND_P_"]}, {"name": "handle_control_hsfetch", "calls": ["smartlist_free", "rend_data_free", "rend_client_fetch_v2_desc", "node_get_by_hex_id", "send_control_done", "smartlist_new", "base32_decode", "rend_data_client_create", "strcasecmpstart", "getargs_helper", "rend_valid_descriptor_id", "connection_printf_to_buf", "strcmpstart", "smartlist_add", "rend_valid_service_id"]}, {"name": "dirserv_expire_measured_bw_cache", "calls": ["digestmap_iter_next", "digestmap_iter_get", "digestmap_iter_done", "digestmap_iter_next_rmv", "digestmap_size", "digestmap_iter_init"]}, {"name": "crypto_digest_algorithm_get_length", "calls": ["tor_assertion_failed_"]}, {"name": "cell_queue_append_packed_copy", "calls": ["packed_cell_copy", "tv_to_msec", "cell_queue_append", "tor_gettimeofday_cached_monotonic"]}, {"name": "assert_circuit_ok", "calls": ["smartlist_contains", "tor_assertion_failed_", "CONST_TO_OR_CIRCUIT", "CONST_TO_ORIGIN_CIRCUIT", "circuit_get_by_circid_channel_impl", "assert_cpath_ok"]}, {"name": "connection_or_clear_identity_map", "calls": ["TO_OR_CONN", "get_connection_array"]}, {"name": "secret_to_key_key_len", "calls": []}, {"name": "connection_or_clear_ext_or_id_map", "calls": []}, {"name": "find_transport_name_by_bridge_addrport", "calls": ["tor_addr_compare"]}, {"name": "setup_openssl_threading", "calls": ["tor_calloc_", "tor_mutex_new"]}, {"name": "getinfo_helper_dir", "calls": ["get_options", "list_server_status_v1", "smartlist_free", "node_get_by_hex_id", "munge_extrainfo_into_routerinfo", "dirserv_get_consensus", "read_file_to_str", "signed_descriptor_get_annotations", "tor_strdup_", "directory_caches_dir_info", "tor_strndup_", "options_get_datadir_fname2_suffix", "smartlist_join_strings", "strcmpstart", "tor_asprintf", "rend_cache_lookup_v2_desc_as_service", "smartlist_add", "tor_malloc_", "dirserv_get_routerdescs", "router_extrainfo_digest_is_me", "rend_cache_lookup_entry", "signed_descriptor_get_body", "router_get_my_extrainfo", "extrainfo_get_by_descriptor_digest", "router_get_routerlist", "node_get_by_nickname", "base16_decode", "smartlist_new", "log_fn_"]}, {"name": "connection_handle_read_impl", "calls": ["connection_stop_reading_from_linked_conn", "connection_read_to_buf", "connection_wants_to_flush", "connection_close_immediate", "connection_reached_eof", "TO_OR_CONN", "connection_or_notify_error", "connection_is_reading", "connection_flushed_some", "buf_datalen", "connection_mark_for_close_", "TO_EDGE_CONN", "connection_process_inbuf", "errno_to_orconn_end_reason", "tor_assertion_failed_", "TO_ENTRY_CONN", "connection_finished_flushing", "connection_edge_end_errno", "connection_mark_for_close_internal_", "approx_time", "connection_handle_listener_read", "connection_buckets_decrement"]}, {"name": "init_logging", "calls": ["smartlist_new", "tor_mutex_init"]}, {"name": "control_event_my_descriptor_changed", "calls": ["send_control_event"]}, {"name": "have_completed_a_circuit", "calls": []}, {"name": "networkstatus_consensus_can_use_multiple_directories", "calls": ["public_server_mode"]}, {"name": "router_get_description", "calls": ["format_node_description", "router_is_named"]}, {"name": "dircollator_free", "calls": ["smartlist_free", "double_digest_map_HT_NEXT_RMV", "ddmap_entry_free", "double_digest_map_HT_CLEAR", "double_digest_map_HT_START"]}, {"name": "curve25519_basepoint_impl", "calls": ["pick_curve25519_basepoint_impl", "curve25519_impl"]}, {"name": "circuit_build_times_update_last_circ", "calls": ["approx_time"]}, {"name": "replaycache_add_and_test_internal", "calls": ["crypto_digest256", "tor_malloc_", "digest256map_get", "replaycache_scrub_if_needed_internal", "digest256map_set", "log_fn_"]}, {"name": "rep_hist_stored_maybe_new_hs", "calls": ["digestmap_get", "digestmap_set", "crypto_pk_get_digest"]}, {"name": "validate_intro_point_failure", "calls": ["rend_cache_failure_entry_free", "tor_assertion_failed_", "cache_failure_intro_dup", "digestmap_new", "strmap_get_lc", "tor_malloc_", "digestmap_set", "smartlist_del", "cache_failure_intro_lookup", "rend_intro_point_free", "strmap_set_lc"]}, {"name": "bucket_millis_empty", "calls": ["msec_since_midnight"]}, {"name": "parse_commandline", "calls": ["tor_inet_ntoa", "add_stream_log", "tor_strdup_", "show_help", "memwipe", "addr_port_lookup", "set_log_severity_config", "load_passphrase", "tor_asprintf", "log_fn_"]}, {"name": "handle_control_del_onion", "calls": ["smartlist_free", "escaped", "memwipe", "smartlist_string_pos", "getargs_helper", "send_control_done", "smartlist_del", "connection_printf_to_buf", "rend_valid_service_id", "rend_service_del_ephemeral", "log_fn_"]}, {"name": "configure_backtrace_handler", "calls": ["install_bt_handler", "tor_asprintf"]}, {"name": "parse_possibly_bad_iso_time", "calls": ["parse_iso_time", "strlcpy", "tor_parse_long"]}, {"name": "connection_exit_about_to_close", "calls": ["circuit_detach_stream", "circuit_get_by_edge_conn", "connection_dns_remove", "connection_edge_about_to_close"]}, {"name": "directory_initiate_command_rend", "calls": ["get_options", "directory_send_command", "connection_ap_make_link", "tor_addr_family", "connection_connect", "connection_dir_close_consensus_conn_if_extra", "escaped_safe_str_client", "rep_hist_note_used_port", "connection_watch_events", "is_sensitive_dir_purpose", "connection_add_impl", "directory_command_should_use_begindir", "connection_dir_avoid_extra_connection_for_purpose", "connection_mark_for_close_", "dir_conn_purpose_to_string", "rend_data_dup", "tor_assertion_failed_", "connection_start_reading", "rep_hist_note_used_internal", "tor_dup_addr", "dir_connection_new", "tor_addr_copy", "dirind_is_anon", "tor_addr_to_str", "log_fn_"]}, {"name": "relay_send_command_from_edge_", "calls": ["smartlist_free", "relay_header_pack", "tor_assertion_failed_", "relay_command_to_string", "TO_OR_CIRCUIT", "channel_timestamp_client", "circuit_package_relay_cell", "smartlist_join_strings", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "smartlist_new", "smartlist_add", "geoip_change_dirreq_state", "log_fn_"]}, {"name": "eat_whitespace_eos_no_nl", "calls": []}, {"name": "policy_write_item", "calls": ["tor_snprintf", "tor_addr_to_str", "tor_addr_family", "strlcat"]}, {"name": "run_main_loop_until_done", "calls": ["run_main_loop_once"]}, {"name": "buf_find_string_offset", "calls": ["buf_pos_inc", "buf_find_pos_of_char", "buf_matches_at_pos", "tor_assertion_failed_", "buf_pos_init"]}, {"name": "node_in_nickname_smartlist", "calls": ["node_nickname_matches"]}, {"name": "eat_whitespace_eos", "calls": ["tor_assertion_failed_"]}, {"name": "onion_pick_cpath_exit", "calls": ["warn_if_last_router_excluded", "extend_info_dup", "new_route_len", "tor_assertion_failed_", "choose_good_exit_server", "extend_info_describe", "nodelist_get_list", "extend_info_from_node", "log_fn_"]}, {"name": "networkstatus_get_live_consensus", "calls": ["get_options", "we_use_microdescriptors_for_circuits"]}, {"name": "assert_unconfigured_count_ok", "calls": ["tor_assertion_failed_"]}, {"name": "addressmap_register_auto", "calls": ["address_is_invalid_destination", "addressmap_register", "tor_strdup_"]}, {"name": "scheduler_more_work", "calls": ["tor_assertion_failed_", "scheduler_get_queue_heuristic"]}, {"name": "rend_cache_lookup_v2_desc_as_dir", "calls": ["get_options", "safe_str", "tor_assertion_failed_", "base32_decode", "digestmap_get", "approx_time", "log_fn_"]}, {"name": "connection_consider_empty_read_buckets", "calls": ["TO_OR_CONN", "connection_counts_as_relayed_traffic", "connection_stop_reading", "enable_control_logging", "log_fn_", "connection_is_rate_limited", "approx_time", "tor_assertion_failed_", "disable_control_logging"]}, {"name": "signed_descriptor_get_annotations", "calls": ["signed_descriptor_get_body_impl"]}, {"name": "check_whether_orport_reachable", "calls": ["get_options"]}, {"name": "rep_hist_buffer_stats_add_circ", "calls": ["rep_hist_add_buffer_stats", "TO_OR_CIRCUIT"]}, {"name": "fp_pair_map_new", "calls": ["tor_malloc_", "fp_pair_map_impl_HT_INIT"]}, {"name": "channel_find_by_global_id", "calls": []}, {"name": "secret_to_key_compute_key", "calls": ["secret_to_key_rfc2440"]}, {"name": "dirreqmap_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "tor_cond_init", "calls": []}, {"name": "time_to_record_bandwidth_usage", "calls": []}, {"name": "_cmp_time_t", "calls": []}, {"name": "addr_policy_intersects", "calls": ["tor_addr_compare_masked"]}, {"name": "strmap_size", "calls": []}, {"name": "channel_listener_when_last_active", "calls": ["tor_assertion_failed_"]}, {"name": "config_count_options", "calls": []}, {"name": "buf_find_offset_of_char", "calls": []}, {"name": "assert_all_pending_dns_resolves_ok", "calls": ["cache_map_HT_START", "connection_in_array", "tor_assertion_failed_", "assert_connection_ok", "cache_map_HT_NEXT"]}, {"name": "tor_addr_from_sockaddr", "calls": ["tor_assertion_failed_", "tor_addr_make_unspec", "tor_addr_from_in6", "tor_addr_from_ipv4n", "tor_addr_make_af_unix"]}, {"name": "make_pending_resolve_cached", "calls": ["cache_map_HT_INSERT", "cache_map_HT_REMOVE", "tor_strdup_", "dns_get_expiry_ttl", "assert_resolve_ok", "set_expiry", "tor_memdup_", "log_fn_"]}, {"name": "geoip_entry_stats_term", "calls": ["geoip_reset_entry_stats"]}, {"name": "tor_tls_verify", "calls": ["try_to_extract_certs_from_tls", "check_no_tls_errors_", "crypto_new_pk_from_rsa_", "tls_log_errors", "log_fn_"]}, {"name": "rend_service_get_by_pk_digest", "calls": ["tor_memeq"]}, {"name": "control_event_circuit_purpose_changed", "calls": ["control_event_circuit_status_minor"]}, {"name": "exit_policy_is_general_exit", "calls": ["exit_policy_is_general_exit_helper"]}, {"name": "microdesc_cache_rebuild", "calls": ["smartlist_free", "should_rebuild_md_cache", "tor_mmap_file", "write_str_to_file", "escaped", "tor_fd_setpos", "tor_fd_getpos", "microdesc_map_HT_START", "tor_strndup_", "tor_munmap_file", "smartlist_add", "microdesc_cache_clean", "tor_assertion_failed_", "microdesc_wipe_body", "dump_microdescriptor", "microdesc_map_HT_NEXT", "smartlist_new", "finish_writing_to_file", "start_writing_to_file", "log_fn_"]}, {"name": "entry_is_live", "calls": ["get_options", "fascist_firewall_allows_node", "routerset_contains_node", "entry_is_time_to_retry", "tor_assertion_failed_", "node_is_a_configured_bridge", "node_get_purpose", "node_is_unreliable", "node_has_descriptor", "node_get_by_id"]}, {"name": "parse_rfc1123_time", "calls": ["tor_assertion_failed_", "tor_timegm", "tor_sscanf", "esc_for_log", "log_fn_"]}, {"name": "fp_pair_map_impl_HT_REMOVE", "calls": ["fp_pair_map_impl_HT_FIND_P_", "fp_pair_map_entry_hash"]}, {"name": "owning_controller_procmon_cb", "calls": ["lost_owning_controller"]}, {"name": "update_total_bandwidth_weights", "calls": ["guard_get_guardfraction_bandwidth", "tor_assertion_failed_", "log_fn_"]}, {"name": "cert_list_free", "calls": ["smartlist_free", "authority_cert_free", "dsmap_free"]}, {"name": "chanid_circid_entry_hash", "calls": []}, {"name": "channel_init_listener", "calls": ["channel_listener_timestamp_created", "tor_assertion_failed_"]}, {"name": "smartlist_get_most_frequent_string_", "calls": []}, {"name": "init_control_cookie_authentication", "calls": ["get_options", "init_cookie_authentication", "get_controller_cookie_file_name"]}, {"name": "strmap_iter_get", "calls": ["tor_assertion_failed_"]}, {"name": "get_unique_circ_id_by_chan", "calls": ["crypto_rand", "circuit_id_in_use_on_channel", "channel_dump_statistics", "circuit_id_when_marked_unusable_on_channel", "tor_assertion_failed_", "log_fn_", "rate_limit_log", "circuitmux_num_active_circuits", "circuitmux_num_circuits", "approx_time", "circuitmux_count_queued_destroy_cells"]}, {"name": "router_pick_directory_server", "calls": ["router_pick_directory_server_impl", "mark_all_dirservers_up", "tor_assertion_failed_", "log_fn_"]}, {"name": "connection_or_digest_is_known_relay", "calls": ["router_get_by_id_digest", "router_get_consensus_status_by_id"]}, {"name": "tor_timegm", "calls": ["n_leapdays", "log_fn_"]}, {"name": "dirind_is_anon", "calls": []}, {"name": "keypin_check", "calls": ["keypin_check_and_add_impl"]}, {"name": "router_parse_list_from_string", "calls": ["tor_memstr", "router_get_router_hash", "find_start_of_next_router_or_extrainfo", "extrainfo_parse_entry_from_string", "router_purpose_to_string", "router_get_extrainfo_hash", "router_describe", "router_get_routerlist", "tor_assertion_failed_", "tor_memdup_", "router_parse_entry_from_string", "smartlist_add", "log_fn_"]}, {"name": "directory_post_to_hs_dir", "calls": ["smartlist_add_all", "node_get_by_id", "safe_str_client", "base32_encode", "smartlist_add", "tor_memdup_", "smartlist_clear", "smartlist_contains_digest", "control_event_hs_descriptor_upload", "rend_data_client_create", "rend_data_free", "routerstatus_describe", "hid_serv_get_responsible_directories", "tor_dup_ip", "node_has_descriptor", "directory_initiate_command_routerstatus_rend", "smartlist_new", "smartlist_free", "log_fn_"]}, {"name": "append_cell_to_circuit_queue", "calls": ["cell_queue_append_packed_copy", "scheduler_channel_has_waiting_cells", "TO_OR_CIRCUIT", "cell_queues_check_size", "update_circuit_on_cmux_", "set_streams_blocked_on_circ", "log_fn_"]}, {"name": "strtok_helper", "calls": []}, {"name": "origin_circuit_new", "calls": ["circuit_build_times_update_last_circ", "init_circuit_base", "tor_malloc_zero_", "get_circuit_build_times_mutable", "crypto_rand_int"]}, {"name": "get_configured_ports", "calls": ["smartlist_new"]}, {"name": "initialize_periodic_events_cb", "calls": ["periodic_event_launch"]}, {"name": "rend_client_refetch_v2_renddesc", "calls": ["get_options", "rend_client_fetch_v2_desc", "tor_assertion_failed_", "rend_client_any_intro_points_usable", "safe_str_client", "rend_client_desc_trynow", "rend_cache_lookup_entry", "log_fn_"]}, {"name": "handle_control_authenticate", "calls": ["get_options", "smartlist_add_all", "tor_strdup_", "TOR_ISXDIGIT", "send_control_done", "tor_assertion_failed_", "smartlist_free", "decode_hashed_passwords", "smartlist_new", "decode_escaped_string", "tor_malloc_", "connection_write_str_to_buf", "connection_mark_for_close_", "connection_printf_to_buf", "base16_decode", "secret_to_key_rfc2440", "tor_memeq", "log_fn_"]}, {"name": "write_http_response_header_impl", "calls": ["strlcpy", "format_rfc1123_time", "tor_snprintf", "tor_assertion_failed_", "connection_write_to_buf", "is_local_addr"]}, {"name": "channel_idmap_HT_REMOVE", "calls": ["channel_idmap_hash", "channel_idmap_HT_FIND_P_"]}, {"name": "rep_hist_add_buffer_stats", "calls": ["smartlist_add", "tor_malloc_zero_", "smartlist_new"]}, {"name": "tor_mmap_file", "calls": ["tor_open_cloexec", "tor_malloc_zero_", "tor_assertion_failed_", "log_fn_"]}, {"name": "rep_hist_format_buffer_stats", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_sort", "smartlist_add_asprintf", "format_iso_time", "smartlist_join_strings", "tor_asprintf", "smartlist_new"]}, {"name": "connection_edge_process_resolved_cell", "calls": ["get_options", "smartlist_free", "safe_str_client", "EDGE_TO_ENTRY_CONN", "resolved_cell_parse", "tor_assertion_failed_", "connection_ap_handshake_socks_resolved", "tor_addr_is_internal_", "connection_ap_handshake_socks_got_resolved_cell", "fmt_addr_impl", "smartlist_del", "log_fn_", "smartlist_new", "address_ttl_free", "connection_mark_unattached_ap_"]}, {"name": "log_set_application_name", "calls": ["tor_strdup_"]}, {"name": "unix_socket_purpose_to_string", "calls": []}, {"name": "check_whether_dirport_reachable", "calls": ["get_options", "net_is_disabled"]}, {"name": "policies_free_all", "calls": ["policy_write_item", "policy_map_HT_NEXT", "policy_map_HT_CLEAR", "policy_map_HT_START", "addr_policy_list_free", "log_fn_"]}, {"name": "rend_cache_failure_intro_entry_free_", "calls": ["rend_cache_failure_intro_entry_free"]}, {"name": "strmap_entry_free", "calls": []}, {"name": "write_bytes_to_file", "calls": ["write_bytes_to_file_impl"]}, {"name": "channel_tls_start_listener", "calls": ["tor_malloc_zero_", "channel_init_listener", "channel_listener_register", "log_fn_"]}, {"name": "tor_threadlocal_get", "calls": []}, {"name": "crypto_pk_base64_encode", "calls": ["base64_encode_size", "memwipe", "tor_malloc_zero_", "base64_encode"]}, {"name": "geoip_ipv4_compare_entries_", "calls": []}, {"name": "onion_skin_TAP_server_handshake", "calls": ["get_options", "crypto_dh_compute_secret", "memwipe", "tor_malloc_", "crypto_dh_new", "crypto_dh_free", "crypto_pk_private_hybrid_decrypt", "crypto_dh_get_public", "note_crypto_pk_op", "log_fn_"]}, {"name": "format_local_iso_time", "calls": ["tor_localtime_r"]}, {"name": "n_leapdays", "calls": []}, {"name": "crypto_thread_cleanup", "calls": []}, {"name": "tor_open_cloexec", "calls": ["sandbox_intern_string", "log_fn_"]}, {"name": "channel_timestamp_client", "calls": ["tor_assertion_failed_"]}, {"name": "addr_policy_append_reject_addr", "calls": ["tor_addr_copy", "smartlist_add", "tor_assertion_failed_", "tor_addr_family", "addr_policy_get_canonical_entry", "fmt_addr_impl", "smartlist_new", "log_fn_"]}, {"name": "relay_lookup_conn", "calls": ["TO_ORIGIN_CIRCUIT", "connection_edge_is_rendezvous_stream", "TO_OR_CIRCUIT", "relay_header_unpack", "log_fn_"]}, {"name": "tor_addr_port_new", "calls": ["tor_addr_copy", "tor_malloc_zero_"]}, {"name": "bidimap_HT_REP_IS_BAD_", "calls": ["bidi_map_ent_hash"]}, {"name": "get_onion_key_set_at", "calls": []}, {"name": "remap_event_helper", "calls": ["tor_addr_to_str", "control_event_stream_status"]}, {"name": "rend_cache_entry_free", "calls": ["rend_cache_decrement_allocation", "rend_service_descriptor_free", "rend_cache_failure_remove", "rend_cache_entry_allocation"]}, {"name": "write_to_buf_zlib", "calls": ["CHUNK_WRITE_PTR", "buf_add_chunk_with_capacity", "CHUNK_REMAINING_CAPACITY", "tor_zlib_process"]}, {"name": "compare_certs_by_pubdates", "calls": []}, {"name": "bidimap_HT_FIND", "calls": ["bidi_map_ent_hash", "bidimap_HT_FIND_P_"]}, {"name": "dir_server_mode", "calls": ["router_has_bandwidth_to_be_dirserver", "server_mode"]}, {"name": "process_map_HT_REPLACE", "calls": ["process_map_entry_hash_", "process_map_HT_FIND_P_", "process_map_HT_GROW"]}, {"name": "extrainfo_free", "calls": ["tor_cert_free"]}, {"name": "var_cell_pack_header", "calls": ["set_uint8", "set_uint16", "set_uint32"]}, {"name": "transport_new", "calls": ["tor_addr_copy", "tor_malloc_zero_", "tor_strdup_"]}, {"name": "dirserv_cache_measured_bw", "calls": ["digestmap_new", "tor_assertion_failed_", "tor_malloc_", "digestmap_get", "digestmap_set"]}, {"name": "rend_service_escaped_dir", "calls": ["escaped"]}, {"name": "crypto_pk_key_is_private", "calls": ["tor_assertion_failed_"]}, {"name": "ed25519_keypair_from_curve25519_keypair", "calls": ["tor_assertion_failed_", "memwipe"]}, {"name": "channel_tls_close_method", "calls": ["connection_or_close_normally", "channel_tls_from_base", "tor_assertion_failed_", "channel_change_state", "log_fn_"]}, {"name": "num_rend_services", "calls": []}, {"name": "init_addrinfo", "calls": ["sandbox_add_addrinfo"]}, {"name": "parse_extended_hostname", "calls": ["strlcpy", "safe_str_client", "log_fn_", "rend_valid_service_id"]}, {"name": "tor_addr_to_in6", "calls": []}, {"name": "find_nth_double", "calls": ["tor_assertion_failed_"]}, {"name": "options_transition_requires_fresh_tls_context", "calls": ["opt_streq", "tor_assertion_failed_"]}, {"name": "rep_hist_note_bytes_written", "calls": ["add_obs"]}, {"name": "connection_should_read_from_linked_conn", "calls": ["buf_datalen"]}, {"name": "SSL_get_client_random", "calls": ["tor_assertion_failed_"]}, {"name": "rend_client_rendezvous_acked", "calls": ["connection_ap_attach_pending", "circuit_change_purpose", "pathbias_mark_use_success", "circuit_mark_for_close_", "log_fn_"]}, {"name": "directory_get_from_all_authorities", "calls": ["directory_initiate_command_routerstatus", "router_digest_is_me", "tor_assertion_failed_", "router_get_trusted_dir_servers"]}, {"name": "circuit_build_times_max", "calls": []}, {"name": "tor_calloc_", "calls": ["tor_malloc_zero_", "tor_assertion_failed_", "size_mul_check"]}, {"name": "edge_connection_new", "calls": ["tor_malloc_zero_", "tor_assertion_failed_", "connection_init"]}, {"name": "connection_connect_unix", "calls": ["strlcpy", "connection_connect_sockaddr", "tor_assertion_failed_", "escaped_safe_str_client", "log_fn_"]}, {"name": "rend_consider_services_intro_points", "calls": ["get_options", "smartlist_free", "crypto_pk_new", "safe_str_client", "crypto_rand_int_range", "extend_info_describe", "rend_intro_point_free", "node_describe", "smartlist_add", "tor_assertion_failed_", "tor_malloc_zero_", "crypto_pk_generate_key_with_bits", "extend_info_from_node", "rend_service_launch_establish_intro", "have_completed_a_circuit", "smartlist_clear", "router_choose_random_node", "smartlist_remove", "remove_invalid_intro_points", "smartlist_new", "log_fn_"]}, {"name": "rend_cache_purge", "calls": ["strmap_new", "log_fn_"]}, {"name": "crypto_cipher_encrypt_with_iv", "calls": ["tor_assertion_failed_", "crypto_cipher_free", "crypto_cipher_encrypt", "crypto_cipher_new_with_iv"]}, {"name": "networkstatus_vote_find_entry_idx", "calls": []}, {"name": "connection_edge_process_inbuf", "calls": ["conn_state_to_string", "connection_ap_supports_optimistic_data", "EDGE_TO_ENTRY_CONN", "tor_assertion_failed_", "connection_get_inbuf_len", "connection_edge_package_raw_inbuf", "connection_mark_for_close_", "connection_edge_end", "log_fn_", "connection_ap_process_natd", "connection_ap_handshake_process_socks"]}, {"name": "scan_double", "calls": ["digit_to_num", "TOR_ISDIGIT"]}, {"name": "channel_tls_listener_describe_transport_method", "calls": ["tor_assertion_failed_"]}, {"name": "real_uptime", "calls": []}, {"name": "rollback_log_changes", "calls": ["tor_mutex_release", "close_temp_logs", "tor_mutex_acquire"]}, {"name": "connection_write_to_buf_zlib", "calls": ["connection_write_to_buf_impl_"]}, {"name": "init_ext_or_cookie_authentication", "calls": ["get_options", "init_cookie_authentication", "get_ext_or_auth_cookie_file_name"]}, {"name": "WRA_WAS_REJECTED", "calls": []}, {"name": "circuit_build_times_default_num_xm_modes", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "reset_bandwidth_test", "calls": []}, {"name": "get_entry_guards", "calls": ["smartlist_new"]}, {"name": "geoip_get_country_by_addr", "calls": ["geoip_get_country_by_ipv4", "tor_addr_to_ipv4h", "geoip_get_country_by_ipv6", "tor_addr_family", "tor_addr_to_in6"]}, {"name": "var_cell_free", "calls": []}, {"name": "tor_addr_eq_ipv4h", "calls": ["tor_addr_to_ipv4h"]}, {"name": "rep_hist_note_connect_failed", "calls": ["mark_or_down", "get_or_history"]}, {"name": "extend_cell_format", "calls": ["tor_addr_to_ipv4n", "set_uint32", "check_extend_cell", "set_uint16"]}, {"name": "preferred_chunk_size", "calls": []}, {"name": "routerset_contains_node", "calls": ["routerset_contains_routerstatus", "routerset_contains_router"]}, {"name": "onion_pending_remove", "calls": ["cpuworker_cancel_circ_handshake", "onion_queue_entry_remove"]}, {"name": "hexdigest_to_digest", "calls": ["base16_decode"]}, {"name": "ed25519_public_from_base64", "calls": ["digest256_from_base64"]}, {"name": "enter_v3_handshake_with_cell", "calls": ["get_options", "connection_init_or_handshake_state", "connection_or_nonopen_was_started_here", "or_handshake_state_record_var_cell", "tor_assertion_failed_", "connection_or_block_renegotiation", "log_fn_", "connection_or_close_for_error"]}, {"name": "int_array_contains", "calls": []}, {"name": "compare_ptrs_", "calls": []}, {"name": "transport_resolve_conflicts", "calls": ["transport_get_by_name", "tor_addr_compare", "fmt_addrport", "smartlist_remove", "tor_strdup_", "transport_free", "log_fn_"]}, {"name": "chan_circid_map_HT_FIND_P_", "calls": ["chan_circid_entries_eq_"]}, {"name": "eimap_new", "calls": ["digestmap_new"]}, {"name": "smartlist_choose", "calls": ["crypto_rand_int"]}, {"name": "dsmap_get", "calls": ["digestmap_get"]}, {"name": "init_keys", "calls": ["get_options", "load_ed_keys", "router_get_my_descriptor", "router_initialize_tls_context", "router_get_trusteddirserver_by_digest", "router_write_fingerprint", "public_server_mode", "authdir_mode_handles_descs", "get_my_v3_authority_cert", "crypto_pk_new", "check_private_dir", "crypto_pk_dup_key", "authdir_mode", "options_get_datadir_fname2_suffix", "crypto_pk_free", "init_curve25519_keypair_from_file", "or_state_mark_dirty", "init_keys_common", "trusted_dir_server_new", "WRA_WAS_OUTDATED", "get_or_state", "trusted_dirs_load_certs_from_string", "set_onion_key", "dirserv_add_own_fingerprint", "dirserv_add_descriptor", "dirserv_load_fingerprint_file", "init_key_from_file", "crypto_pk_generate_key_with_bits", "authdir_mode_v3", "server_mode", "tor_mem_is_zero", "router_parse_entry_from_string", "router_get_advertised_or_port", "tor_memeq", "init_v3_authority_keys", "WRA_WAS_ADDED", "dir_server_add", "init_keys_client", "crypto_pk_get_digest", "set_client_identity_key", "get_server_identity_key", "router_get_advertised_dir_port", "set_server_identity_key", "file_status", "generate_ed_link_cert", "log_fn_"]}, {"name": "rep_hist_load_state", "calls": ["bw_arrays_init", "tor_strdup_", "tor_assertion_failed_", "rep_hist_load_bwhist_state_section"]}, {"name": "tor_tls_get_tlssecrets", "calls": ["tor_assertion_failed_", "SSL_SESSION_get_master_key", "SSL_get_client_random", "crypto_hmac_sha256", "memwipe", "tor_malloc_zero_", "SSL_get_server_random"]}, {"name": "base64_encode_nopad", "calls": ["base64_encode", "tor_assertion_failed_"]}, {"name": "circuit_build_times_new_consensus_params", "calls": ["circuit_build_times_disabled", "tor_assertion_failed_", "circuit_build_times_free_timeouts", "tor_calloc_", "circuit_build_times_recent_circuit_count", "log_fn_"]}, {"name": "crypto_pk_public_exponent_ok", "calls": ["tor_assertion_failed_"]}, {"name": "workqueue_entry_new", "calls": ["tor_malloc_zero_"]}, {"name": "digest256map_iter_next", "calls": ["tor_assertion_failed_", "digest256map_impl_HT_NEXT"]}, {"name": "eimap_iter_init", "calls": ["digestmap_iter_init"]}, {"name": "count_acceptable_nodes", "calls": ["node_has_descriptor"]}, {"name": "rep_hist_log_link_protocol_counts", "calls": ["log_fn_"]}, {"name": "routerlist_remove", "calls": ["get_options", "tor_digest_is_zero", "rep_hist_note_router_unreachable", "extrainfo_free", "tor_assertion_failed_", "smartlist_add", "router_dir_info_changed", "directory_caches_dir_info", "nodelist_remove_routerinfo", "signed_descriptor_from_routerinfo", "sdmap_set", "smartlist_del", "routerinfo_free", "sdmap_remove", "rimap_remove", "eimap_remove"]}, {"name": "circuit_build_times_quantile_cutoff", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "circuit_get_global_list", "calls": ["smartlist_new"]}, {"name": "chunk_grow", "calls": ["tor_assertion_failed_", "tor_realloc_"]}, {"name": "is_destroy_cell", "calls": ["packed_cell_is_destroy"]}, {"name": "rend_service_parse_intro_for_v3", "calls": ["get_uint16", "tor_malloc_", "tor_asprintf", "rend_service_parse_intro_for_v2"]}, {"name": "policies_parse_exit_policy_reject_private", "calls": ["free_interface_address6_list", "get_configured_ports", "get_interface_address6_list", "tor_assertion_failed_", "exit_policy_remove_redundancies", "addr_policy_append_reject_addr_list_filter", "addr_policy_append_reject_addr_filter"]}, {"name": "geoip_get_client_history", "calls": ["smartlist_free", "clientmap_HT_START", "strlcpy", "geoip_get_country_by_addr", "geoip_is_loaded", "smartlist_sort", "smartlist_add", "geoip_get_n_countries", "smartlist_add_asprintf", "tor_addr_family", "tor_malloc_", "tor_calloc_", "clientmap_HT_NEXT", "geoip_get_country_name", "smartlist_join_strings", "tor_assertion_failed_", "round_to_next_multiple_of", "smartlist_new"]}, {"name": "tor_cond_new", "calls": ["tor_cond_init", "tor_malloc_"]}, {"name": "update_certificate_downloads", "calls": ["authority_certs_fetch_missing"]}, {"name": "crypto_pk_new", "calls": ["tor_assertion_failed_", "crypto_new_pk_from_rsa_"]}, {"name": "circuit_build_times_min_circs_to_observe", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "get_or_history", "calls": ["tor_digest_is_zero", "tor_addr_make_unspec", "digestmap_new", "tor_malloc_zero_", "digestmap_get", "digestmap_set"]}, {"name": "authdir_type_to_string", "calls": ["tor_strdup_", "smartlist_add", "smartlist_new", "smartlist_free", "smartlist_join_strings"]}, {"name": "addressmap_clear_transient", "calls": ["addressmap_get_mappings"]}, {"name": "scheduler_init", "calls": ["tor_assertion_failed_", "tor_libevent_get_base", "approx_time", "smartlist_new", "log_fn_"]}, {"name": "ddmap_entry_free", "calls": []}, {"name": "print_usage", "calls": []}, {"name": "get_stream", "calls": ["tor_parse_uint64", "connection_get_by_global_id", "TO_ENTRY_CONN"]}, {"name": "pathbias_count_collapse", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "circuit_state_to_string", "entry_guards_changed", "circuit_purpose_to_string", "log_fn_"]}, {"name": "compare_dir_src_ents_by_authority_id_", "calls": ["get_voter"]}, {"name": "digestset_free", "calls": ["bitarray_free"]}, {"name": "compute_num_cpus_impl", "calls": ["log_fn_"]}, {"name": "edmap_HT_FIND_P_", "calls": ["keypin_ents_eq_ed"]}, {"name": "proxy_prepare_for_restart", "calls": ["tor_process_handle_destroy", "smartlist_clear", "transport_get_by_name", "tor_assertion_failed_", "sweep_transport_list", "get_pt_proxy_uri", "transport_free"]}, {"name": "TOR_ISSPACE", "calls": []}, {"name": "digestmap_set", "calls": ["digestmap_entry_hash", "tor_assertion_failed_", "tor_malloc_zero_", "digestmap_assign_key", "digestmap_assign_tmp_key", "digestmap_impl_HT_GROW", "digestmap_impl_HT_FIND_P_"]}, {"name": "choose_good_exit_server_general", "calls": ["get_options", "smartlist_free", "ap_stream_wants_exit_attention", "get_connection_array", "node_allows_single_hop_exits", "node_exit_policy_rejects_all", "choose_good_exit_server_general", "router_digest_is_me", "rep_hist_remove_predicted_ports", "routerset_contains_node", "nodelist_get_list", "node_has_descriptor", "node_describe", "smartlist_add", "TO_ENTRY_CONN", "node_get_purpose", "node_is_unreliable", "smartlist_clear", "circuit_get_unhandled_ports", "smartlist_new", "connection_ap_can_use_exit", "tor_calloc_", "node_sl_choose_by_bandwidth", "node_handles_some_port", "log_fn_"]}, {"name": "dumpmemusage", "calls": ["connection_dump_buffer_mem_stats", "tor_log", "tor_log_mallinfo", "dump_routerlist_mem_usage", "dump_dns_mem_usage", "dump_cell_pool_usage"]}, {"name": "ddmap_entry_hash", "calls": []}, {"name": "download_status_reset_by_sk_in_cl", "calls": ["dsmap_get", "tor_assertion_failed_", "tor_malloc_zero_", "download_status_reset", "dsmap_new", "dsmap_set"]}, {"name": "rend_service_free", "calls": ["smartlist_free", "rend_intro_point_free", "rend_service_descriptor_free", "rend_service_port_config_free", "crypto_pk_free", "rend_authorized_client_free", "replaycache_free"]}, {"name": "check_signature_token", "calls": ["crypto_pk_keysize", "dir_signing_key_is_trusted", "tor_assertion_failed_", "tor_malloc_", "crypto_pk_public_checksig", "tor_memeq", "log_fn_"]}, {"name": "router_get_by_extrainfo_digest", "calls": ["tor_assertion_failed_", "sdmap_get"]}, {"name": "connection_consider_empty_write_buckets", "calls": ["TO_OR_CONN", "connection_counts_as_relayed_traffic", "connection_stop_writing", "enable_control_logging", "log_fn_", "connection_is_rate_limited", "approx_time", "tor_assertion_failed_", "disable_control_logging"]}, {"name": "crypto_pk_base64_decode", "calls": ["crypto_pk_free", "crypto_pk_check_key", "crypto_log_errors", "memwipe", "tor_malloc_zero_", "base64_decode", "crypto_new_pk_from_rsa_", "log_fn_"]}, {"name": "smartlist_get_most_frequent_digest256", "calls": []}, {"name": "connection_or_about_to_close", "calls": ["channel_tls_to_base", "entry_guard_register_connect_status", "authdir_mode_tests_reachability", "connection_or_nonopen_was_started_here", "control_event_or_conn_status", "rep_hist_note_disconnect", "get_options", "control_event_bootstrap_problem", "tls_error_to_orconn_end_reason", "tor_digest_is_zero", "rep_hist_note_connect_failed", "channel_closed", "orconn_end_reason_to_control_string", "connection_or_note_state_when_broken", "rep_hist_note_connection_died"]}, {"name": "rotate_onion_key", "calls": ["get_options", "tor_mutex_release", "crypto_pk_free", "get_or_state", "tor_mutex_acquire", "or_state_mark_dirty", "options_get_datadir_fname2_suffix", "mark_my_descriptor_dirty", "crypto_pk_write_private_key_to_filename", "memwipe", "crypto_pk_generate_key_with_bits", "curve25519_keypair_write_to_file", "curve25519_keypair_generate", "crypto_pk_new", "file_status", "replace_file", "log_fn_"]}, {"name": "connection_exit_begin_resolve", "calls": ["connection_free", "assert_circuit_ok", "relay_header_unpack", "dns_resolve", "tor_strndup_", "edge_connection_new"]}, {"name": "networkstatus_vote_find_mutable_entry", "calls": ["smartlist_bsearch"]}, {"name": "crypto_expand_key_material_rfc5869_sha256", "calls": ["memwipe", "tor_assertion_failed_", "crypto_hmac_sha256"]}, {"name": "choose_random_dirguard", "calls": ["choose_random_entry_impl"]}, {"name": "directory_info_has_arrived", "calls": ["get_options", "router_have_minimum_dir_info", "update_extrainfo_downloads", "tor_log", "update_all_descriptor_downloads", "get_dir_info_status_string", "entry_guards_compute_status", "server_mode", "consider_testing_reachability", "directory_too_idle_to_fetch_descriptors", "any_predicted_circuits", "net_is_disabled", "have_completed_a_circuit", "directory_fetches_from_authorities"]}, {"name": "tor_addr_is_loopback", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_to_ipv4h", "tor_addr_to_in6"]}, {"name": "update_consensus_bootstrap_multiple_downloads", "calls": ["usable_consensus_flavor", "networkstatus_consensus_can_use_extra_fallbacks", "update_consensus_bootstrap_attempt_downloads", "check_consensus_waiting_for_certs", "networkstatus_consensus_can_use_multiple_directories"]}, {"name": "find_expiring_intro_point", "calls": ["tor_assertion_failed_", "crypto_pk_eq_keys"]}, {"name": "dns_launch_correctness_checks", "calls": ["get_options", "tor_libevent_get_base", "log_fn_", "dns_launch_wildcard_checks"]}, {"name": "channel_listener_change_state", "calls": ["channel_listener_state_can_transition", "smartlist_remove", "smartlist_add", "tor_assertion_failed_", "smartlist_new", "channel_listener_state_is_valid", "channel_listener_state_to_string", "log_fn_"]}, {"name": "crypto_log_errors", "calls": ["tor_log"]}, {"name": "find_element_starting_with", "calls": ["strcasecmpstart"]}, {"name": "write_escaped_data", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "pathbias_count_successful_close", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "circuit_state_to_string", "entry_guards_changed", "circuit_purpose_to_string", "log_fn_"]}, {"name": "we_fetch_microdescriptors", "calls": ["we_use_microdescriptors_for_circuits", "directory_caches_dir_info"]}, {"name": "options_validate_cb", "calls": ["options_validate"]}, {"name": "do_getpass", "calls": ["tor_assertion_failed_", "tor_malloc_zero_", "read_all", "memwipe", "tor_malloc_", "tor_getpass", "tor_memeq"]}, {"name": "get_first_listener_addrport_string", "calls": ["tor_addr_is_null", "tor_addr_family", "fmt_addr_impl", "router_get_active_listener_port_by_type_af", "tor_asprintf", "tor_addr_is_v4"]}, {"name": "rep_hist_reset_buffer_stats", "calls": ["smartlist_clear", "smartlist_new"]}, {"name": "routerlist_free", "calls": ["smartlist_free", "signed_descriptor_free", "router_dir_info_changed", "tor_munmap_file", "rimap_free", "routerinfo_free", "eimap_free", "sdmap_free", "log_fn_"]}, {"name": "have_capability_support", "calls": []}, {"name": "rend_service_launch_establish_intro", "calls": ["rend_service_intro_has_opened", "circuit_launch_by_extend_info", "tor_assertion_failed_", "extend_info_describe", "rend_data_service_create", "rep_hist_note_used_internal", "safe_str_client", "crypto_pk_dup_key", "tor_memeq", "log_fn_"]}, {"name": "should_time_request", "calls": ["tor_weak_random_range"]}, {"name": "router_get_networkstatus_v3_hashes", "calls": ["router_get_hashes_impl"]}, {"name": "circuit_build_times_get_xm", "calls": ["circuit_build_times_create_histogram", "circuit_build_times_default_num_xm_modes", "tor_assertion_failed_", "tor_calloc_", "log_fn_"]}, {"name": "connection_start_writing", "calls": ["tor_assertion_failed_", "connection_should_read_from_linked_conn", "connection_start_reading_from_linked_conn", "log_fn_"]}, {"name": "connection_edge_free_all", "calls": ["smartlist_free"]}, {"name": "handle_control_usefeature", "calls": ["smartlist_free", "smartlist_split_string", "send_control_done", "connection_printf_to_buf", "smartlist_new"]}, {"name": "do_list_fingerprint", "calls": ["get_options", "init_keys", "get_server_identity_key", "tor_assertion_failed_", "server_mode", "crypto_pk_get_fingerprint", "log_fn_"]}, {"name": "rep_hist_log_circuit_handshake_stats", "calls": ["log_fn_"]}, {"name": "smartlist_sort_digests256", "calls": ["smartlist_sort"]}, {"name": "config_assign", "calls": ["bitarray_free", "tor_strdup_", "tor_assertion_failed_", "config_count_options", "config_reset_line", "bitarray_init_zero", "config_mark_lists_fragile", "config_expand_abbrev", "config_assign_line"]}, {"name": "accounting_is_enabled", "calls": []}, {"name": "vote_routerstatus_find_microdesc_hash", "calls": ["strlcpy", "tor_snprintf", "crypto_digest_algorithm_get_name", "digest256_from_base64"]}, {"name": "smartlist_add_vasprintf", "calls": ["tor_vasprintf", "smartlist_add", "tor_assertion_failed_"]}, {"name": "eimap_remove", "calls": ["digestmap_remove"]}, {"name": "rep_hist_reset_desc_stats", "calls": ["rep_hist_desc_stats_term", "rep_hist_desc_stats_init"]}, {"name": "free_interface_address6_list", "calls": ["smartlist_free"]}, {"name": "note_client_request", "calls": []}, {"name": "normalize_data_directory", "calls": ["tor_strdup_", "expand_filename", "log_fn_"]}, {"name": "circuit_clear_rend_token", "calls": ["digestmap_get", "digestmap_remove", "log_fn_"]}, {"name": "socks_request_new", "calls": ["tor_malloc_zero_"]}, {"name": "dirserv_read_measured_bandwidths", "calls": ["dirserv_expire_measured_bw_cache", "measured_bw_line_apply", "smartlist_sort", "dirserv_cache_measured_bw", "escaped", "tor_parse_ulong", "tor_fopen_cloexec", "measured_bw_line_parse", "log_fn_"]}, {"name": "control_event_bootstrap", "calls": ["tor_snprintf", "bootstrap_status_to_string", "control_event_client_status", "tor_log"]}, {"name": "geoip_start_dirreq", "calls": ["get_options", "tor_gettimeofday", "tor_malloc_zero_", "dirreq_map_put_"]}, {"name": "entry_list_is_constrained", "calls": []}, {"name": "libevent_logging_callback", "calls": ["strlcpy", "log_fn_"]}, {"name": "get_default_conf_file", "calls": []}, {"name": "rend_get_descriptor_id_bytes", "calls": ["crypto_digest_add_bytes", "crypto_digest_new", "crypto_digest_free", "crypto_digest_get_digest"]}, {"name": "routerset_needs_geoip", "calls": []}, {"name": "tor_close_socket", "calls": ["socket_accounting_unlock", "tor_close_socket_simple", "socket_accounting_lock", "log_fn_"]}, {"name": "onion_skin_ntor_server_handshake", "calls": ["curve25519_secret_key_generate", "curve25519_public_key_generate", "safe_mem_is_zero", "memwipe", "h_tweak", "crypto_expand_key_material_rfc5869_sha256", "tor_assertion_failed_", "curve25519_handshake", "dimap_search", "tor_memeq"]}, {"name": "tor_tls_get_state_description", "calls": ["tor_snprintf", "strlcpy"]}, {"name": "router_set_status", "calls": ["node_is_me", "tor_assertion_failed_", "router_dir_info_changed", "router_get_trusted_dir_servers", "node_get_mutable_by_id", "router_get_fallback_dir_servers", "net_is_disabled", "tor_memeq", "log_fn_"]}, {"name": "tor_tls_get_num_server_handshakes", "calls": []}, {"name": "tor_rename", "calls": ["sandbox_intern_string", "log_fn_"]}, {"name": "sdmap_free", "calls": []}, {"name": "rep_hist_note_connection_died", "calls": ["mark_or_down", "get_or_history"]}, {"name": "cached_resolve_have_all_answers", "calls": []}, {"name": "dsmap_new", "calls": ["digestmap_new"]}, {"name": "cell_command_is_var_length", "calls": []}, {"name": "cache_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "dns_cancel_pending_resolve", "calls": ["circuit_detach_stream", "strlcpy", "cache_map_HT_REMOVE", "cache_map_HT_FIND", "tor_assertion_failed_", "assert_connection_ok", "circuit_get_by_edge_conn", "connection_free", "escaped_safe_str", "connection_edge_end", "log_fn_"]}, {"name": "channel_when_last_xmit", "calls": ["tor_assertion_failed_"]}, {"name": "directory_conn_is_self_reachability_test", "calls": ["router_digest_is_me", "strcmpstart", "tor_addr_eq_ipv4h", "router_get_my_routerinfo"]}, {"name": "socks4_response_code_to_string", "calls": []}, {"name": "channel_tls_get_overhead_estimate_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_", "log_fn_"]}, {"name": "get_scale_factor", "calls": []}, {"name": "get_bindaddr_from_transport_listen_line", "calls": ["smartlist_free", "smartlist_split_string", "tor_strdup_", "smartlist_new", "tor_addr_port_parse", "log_fn_"]}, {"name": "bytes_to_usage", "calls": ["tor_asprintf"]}, {"name": "connection_dir_bridge_routerdesc_failed", "calls": ["smartlist_free", "tor_assertion_failed_", "connection_dir_retry_bridges", "dir_split_resource_into_fingerprints", "strcmpstart", "smartlist_new"]}, {"name": "circuit_package_relay_cell", "calls": ["assert_circuit_ok", "append_cell_to_circuit_queue", "TO_OR_CIRCUIT", "relay_crypt_one_payload", "TO_ORIGIN_CIRCUIT", "tor_assertion_failed_", "relay_set_digest", "log_fn_"]}, {"name": "purge_hid_serv_from_last_hid_serv_requests", "calls": ["strmap_iter_get", "base32_encode", "strmap_iter_init", "tor_memeq", "strmap_iter_done", "strmap_iter_next_rmv", "strmap_iter_next", "get_last_hid_serv_requests"]}, {"name": "directory_permits_begindir_requests", "calls": ["dir_server_mode"]}, {"name": "var_cell_new", "calls": ["tor_malloc_zero_"]}, {"name": "geoip_dirreq_stats_init", "calls": []}, {"name": "cache_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "evdns_callback", "calls": ["tor_addr_make_unspec", "dns_found_answer", "tor_inet_ntop", "tor_addr_from_ipv4n", "safe_str", "tor_addr_from_in6", "answer_is_wildcarded", "tor_addr_to_str", "add_wildcarded_test_address", "esc_for_log", "escaped_safe_str", "is_test_address", "log_fn_"]}, {"name": "signed_descriptor_get_body", "calls": ["signed_descriptor_get_body_impl"]}, {"name": "entry_guard_free", "calls": []}, {"name": "sdmap_new", "calls": ["digestmap_new"]}, {"name": "tor_addr_parse", "calls": ["tor_assertion_failed_", "tor_addr_from_in6", "tor_strndup_", "tor_addr_from_ipv4n", "tor_inet_pton"]}, {"name": "digestmap_impl_HT_FIND", "calls": ["digestmap_entry_hash", "digestmap_impl_HT_FIND_P_"]}, {"name": "get_weighted_fractional_uptime", "calls": []}, {"name": "ext_or_cmd_free", "calls": []}, {"name": "set_onion_key", "calls": ["tor_mutex_release", "crypto_pk_free", "crypto_pk_eq_keys", "mark_my_descriptor_dirty", "tor_mutex_acquire"]}, {"name": "rend_decrypt_introduction_points", "calls": ["crypto_cipher_new", "crypto_cipher_free", "tor_assertion_failed_", "crypto_digest_free", "crypto_cipher_decrypt", "tor_malloc_", "crypto_digest_new", "tor_memeq", "fast_memcmpstart", "crypto_digest_add_bytes", "log_fn_", "tor_malloc_zero_", "crypto_digest_get_digest", "crypto_cipher_decrypt_with_iv"]}, {"name": "handle_control_protocolinfo", "calls": ["get_options", "smartlist_free", "smartlist_split_string", "make_path_absolute", "smartlist_add", "smartlist_join_strings", "escaped", "tor_parse_long", "connection_mark_for_close_", "esc_for_log", "connection_printf_to_buf", "smartlist_new", "get_controller_cookie_file_name"]}, {"name": "circuit_expire_building", "calls": ["get_options", "log_fn_ratelim_", "circuit_mark_for_close_", "get_circuit_build_close_time_ms", "circuit_build_times_count_timeout", "rend_service_relaunch_rendezvous", "circuit_purpose_to_string", "circuit_log_path", "control_event_circuit_status", "get_circuit_build_timeout_ms", "num_live_entry_guards", "circuit_change_purpose", "circuit_state_to_string", "circuit_build_times_count_close", "circuit_timeout_want_to_count_circ", "circuit_build_times_enough_to_compute", "tor_gettimeofday", "channel_state_to_string", "circuit_get_global_list", "TO_ORIGIN_CIRCUIT", "pathbias_count_timeout", "get_circuit_build_times", "tor_lround", "get_circuit_build_times_mutable", "circuit_build_times_set_timeout", "log_fn_"]}, {"name": "tor_x509_cert_new", "calls": ["crypto_pk_free", "tor_malloc_zero_", "crypto_digest_all", "tor_malloc_", "crypto_new_pk_from_rsa_", "crypto_pk_get_all_digests", "log_fn_"]}, {"name": "authority_cert_is_blacklisted", "calls": ["base16_encode"]}, {"name": "lookup_cached_dir_by_fp", "calls": ["tor_digest_is_zero", "strmap_get"]}, {"name": "realign_pointer", "calls": []}, {"name": "connection_read_to_buf", "calls": ["get_options", "tor_tls_get_pending_bytes", "buf_slack", "connection_buckets_decrement", "TO_OR_CONN", "connection_consider_empty_write_buckets", "connection_is_reading", "read_to_buf", "connection_bucket_read_limit", "circuit_get_by_edge_conn", "buf_datalen", "TO_EDGE_CONN", "approx_time", "move_buf_to_buf", "enable_control_logging", "tor_assertion_failed_", "connection_consider_empty_read_buckets", "read_to_buf_tls", "connection_start_reading", "connection_tls_continue_handshake", "TO_ORIGIN_CIRCUIT", "connection_start_writing", "tor_tls_err_to_string", "connection_stop_writing", "connection_is_writing", "tor_tls_get_n_raw_bytes", "disable_control_logging", "log_fn_"]}, {"name": "get_configured_bridge_by_routerinfo", "calls": ["get_configured_bridge_by_orports_digest", "smartlist_free", "router_get_all_orports"]}, {"name": "rend_client_introduction_acked", "calls": ["safe_str_client", "rend_client_report_intro_point_failure", "circuit_change_purpose", "tor_assertion_failed_", "pathbias_mark_use_success", "extend_info_describe", "rend_client_reextend_intro_circuit", "rend_client_close_other_intros", "circuit_get_ready_rend_circ_by_rend_data", "circuit_mark_for_close_", "log_fn_"]}, {"name": "networkstatus_getinfo_by_purpose", "calls": ["get_options", "smartlist_free", "router_purpose_from_string", "router_get_routerlist", "smartlist_add", "smartlist_join_strings", "authdir_mode_bridge", "dirserv_set_router_is_running", "set_routerstatus_from_routerinfo", "node_get_mutable_by_id", "networkstatus_getinfo_helper_single", "smartlist_new", "log_fn_"]}, {"name": "chan_circid_entry_hash_", "calls": []}, {"name": "tor_listen", "calls": ["log_fn_"]}, {"name": "channel_set_cell_handlers", "calls": ["tor_assertion_failed_", "channel_is_in_state", "log_fn_"]}, {"name": "decode_escaped_string", "calls": ["tor_assertion_failed_", "tor_malloc_", "get_escaped_string_length"]}, {"name": "rend_mid_introduce", "calls": ["get_options", "relay_send_command_from_edge_", "base32_encode", "safe_str", "circuit_mark_for_close_", "circuit_get_intro_point", "log_fn_"]}, {"name": "connection_printf_to_buf", "calls": ["tor_assertion_failed_", "connection_write_to_buf", "tor_vasprintf", "log_fn_"]}, {"name": "count_intro_point_circuits", "calls": ["TO_ORIGIN_CIRCUIT", "rend_cmp_service_ids", "circuit_get_global_list"]}, {"name": "tor_log_update_sigsafe_err_fds", "calls": ["tor_mutex_release", "int_array_contains", "tor_mutex_acquire"]}, {"name": "connection_ap_attach_pending", "calls": ["smartlist_free", "smartlist_contains", "conn_state_to_string", "smartlist_add", "tor_assertion_failed_", "connection_ap_handshake_attach_circuit", "connection_mark_unattached_ap_", "smartlist_new", "log_fn_"]}, {"name": "get_socks_args_by_bridge_addrport", "calls": ["get_configured_bridge_by_addr_port_digest"]}, {"name": "rep_hist_conn_stats_write", "calls": ["rep_hist_reset_conn_stats", "rep_hist_format_conn_stats", "write_to_data_subdir", "check_or_create_data_subdir"]}, {"name": "routerlist_remove_old_cached_routers_with_id", "calls": ["get_options", "routerlist_remove_old", "tor_assertion_failed_", "directory_caches_dir_info", "tor_calloc_", "digestset_contains", "tor_memeq"]}, {"name": "process_map_entry_hash_", "calls": []}, {"name": "geoip_remove_old_clients", "calls": []}, {"name": "circuit_max_queued_cell_age", "calls": ["CONST_TO_OR_CIRCUIT"]}, {"name": "policy_expand_unspec", "calls": ["smartlist_free", "addr_policy_free", "smartlist_add", "tor_addr_family", "tor_addr_from_ipv4n", "addr_policy_get_canonical_entry", "tor_addr_from_ipv6_bytes", "smartlist_new", "log_fn_"]}, {"name": "guardfraction_file_parse_guard_line", "calls": ["smartlist_free", "smartlist_split_string", "guardfraction_line_apply", "tor_assertion_failed_", "base16_decode", "tor_asprintf", "smartlist_new", "tor_parse_long"]}, {"name": "relay_crypt_one_payload", "calls": ["crypto_cipher_crypt_inplace", "log_fn_"]}, {"name": "cpuworkers_rotate_keyinfo", "calls": ["log_fn_"]}, {"name": "channel_listener_set_listener_fn", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "warn_too_many_conns", "calls": ["rate_limit_log", "control_event_general_status", "get_n_open_sockets", "approx_time", "log_fn_"]}, {"name": "write_configuration_file", "calls": ["options_dump", "read_file_to_str", "write_str_to_file", "file_status", "tor_rename", "strcmpstart", "tor_asprintf", "log_fn_"]}, {"name": "options_act_reversible", "calls": ["smartlist_free", "connection_mark_all_noncontrol_connections", "conn_type_to_string", "switch_id", "connection_close_immediate", "close_temp_logs", "init_libevent", "sandbox_is_active", "rollback_log_changes", "check_private_dir", "tor_log_update_sigsafe_err_fds", "parse_ports", "get_options_mutable", "mark_logs_temp", "tor_strdup_", "set_max_file_descriptors", "connection_mark_for_close_", "options_init_logs", "tor_asprintf", "add_callback_log", "we_are_hibernating", "tor_assertion_failed_", "control_initialize_event_queue", "tor_malloc_zero_", "consider_hibernation", "control_adjust_event_log_severity", "tor_mlockall", "retry_all_listeners", "start_daemon", "get_min_log_level", "scheduler_init", "log_fn_", "smartlist_new", "flush_log_messages_from_startup", "note_that_we_maybe_cant_complete_circuits"]}, {"name": "connection_ap_handshake_process_socks", "calls": ["get_options", "fetch_from_buf_socks", "tor_assertion_failed_", "connection_ap_handshake_socks_reply", "log_fn_", "connection_write_to_buf", "connection_ap_rewrite_and_attach_if_allowed", "control_event_stream_status", "connection_mark_unattached_ap_"]}, {"name": "crypto_rand_int_range", "calls": ["tor_assertion_failed_", "crypto_rand_int"]}, {"name": "double_digest_map_HT_NEXT_RMV", "calls": []}, {"name": "rep_hist_note_desc_served", "calls": ["digestmap_get", "digestmap_set"]}, {"name": "command_handle_incoming_channel", "calls": ["tor_assertion_failed_", "command_setup_channel"]}, {"name": "esc_for_log", "calls": ["tor_assertion_failed_", "tor_strdup_", "tor_snprintf", "tor_malloc_", "TOR_ISPRINT"]}, {"name": "format_time_interval", "calls": ["tor_snprintf"]}, {"name": "get_secret_id_part_bytes", "calls": ["crypto_digest_add_bytes", "crypto_digest_new", "crypto_digest_free", "crypto_digest_get_digest"]}, {"name": "rend_compute_v2_desc_id", "calls": ["get_secret_id_part_bytes", "safe_str_client", "rend_get_descriptor_id_bytes", "safe_str", "get_time_period", "base32_decode", "log_fn_"]}, {"name": "channel_when_last_active", "calls": ["tor_assertion_failed_"]}, {"name": "buf_get_oldest_chunk_timestamp", "calls": []}, {"name": "client_likes_consensus", "calls": ["get_options", "smartlist_free", "escaped", "dir_split_resource_into_fingerprints", "base16_decode", "smartlist_new", "tor_memeq", "log_fn_"]}, {"name": "control_adjust_event_log_severity", "calls": ["change_callback_log_severity", "event_to_log_severity"]}, {"name": "replace_file", "calls": ["tor_rename"]}, {"name": "entries_retry_helper", "calls": ["router_set_status", "node_is_a_configured_bridge", "node_get_purpose", "node_has_descriptor", "node_get_by_id", "smartlist_new", "connection_or_set_bad_connections", "log_fn_"]}, {"name": "memarea_strdup", "calls": ["memarea_memdup"]}, {"name": "rend_services_add_filenames_to_lists", "calls": ["smartlist_add", "rend_service_add_filenames_to_list", "tor_strdup_"]}, {"name": "bridge_resolve_conflicts", "calls": ["bridge_has_digest", "tor_digest_is_zero", "strcmp_opt", "hex_str", "tor_addr_compare", "fmt_addrport", "tor_asprintf", "log_fn_"]}, {"name": "tor_check_libevent_header_compatibility", "calls": ["tor_log", "tor_decode_libevent_version", "le_versions_compatibility", "log_fn_"]}, {"name": "cell_queue_append", "calls": []}, {"name": "rep_hist_get_weighted_time_known", "calls": ["get_total_weighted_time", "get_or_history"]}, {"name": "tor_strstrip", "calls": []}, {"name": "memwipe", "calls": ["tor_assertion_failed_"]}, {"name": "learned_router_identity", "calls": ["tor_digest_is_zero", "tor_asprintf", "hex_str", "find_transport_name_by_bridge_addrport", "fmt_addrport", "get_configured_bridge_by_addr_port_digest", "log_fn_"]}, {"name": "nodelist_map_HT_INSERT", "calls": ["nodelist_map_HT_GROW", "node_id_hash"]}, {"name": "rsamap_HT_FIND", "calls": ["rsamap_HT_FIND_P_", "keypin_ent_hash_rsa"]}, {"name": "geoip_format_entry_stats", "calls": ["geoip_get_client_history", "tor_assertion_failed_", "format_iso_time", "tor_asprintf"]}, {"name": "digest256map_assign_tmp_key", "calls": []}, {"name": "circuit_clear_isolation", "calls": ["memwipe", "tor_addr_make_unspec", "log_fn_"]}, {"name": "crypto_dh_new", "calls": ["init_dh_param", "crypto_log_errors", "tor_assertion_failed_", "tor_malloc_zero_"]}, {"name": "connection_dump_buffer_mem_stats", "calls": ["get_connection_array", "buf_allocation", "buf_datalen", "conn_type_to_string", "tor_log"]}, {"name": "parse_log_level", "calls": []}, {"name": "circuitmux_num_active_circuits", "calls": ["tor_assertion_failed_"]}, {"name": "rep_hist_format_hs_stats", "calls": ["digestmap_size", "format_iso_time", "add_laplace_noise", "tor_asprintf", "round_int64_to_next_multiple_of", "crypto_rand_double"]}, {"name": "has_dns_init_failed", "calls": []}, {"name": "channel_listener_free_list", "calls": ["channel_listener_unregister", "tor_assertion_failed_", "channel_listener_state_to_string", "log_fn_"]}, {"name": "crypto_pk_write_public_key_to_string", "calls": ["crypto_pk_write_key_to_string_impl"]}, {"name": "control_event_general_status", "calls": ["control_event_status"]}, {"name": "smartlist_contains_digest", "calls": ["tor_memeq"]}, {"name": "tor_libevent_get_header_version_str", "calls": []}, {"name": "fetch_from_buf_line", "calls": ["buf_find_offset_of_char", "fetch_from_buf"]}, {"name": "extend_info_get_description", "calls": ["format_node_description"]}, {"name": "rep_hist_hs_stats_term", "calls": ["rep_hist_reset_hs_stats"]}, {"name": "tor_getpass", "calls": ["tor_assertion_failed_"]}, {"name": "evaluate_evp_for_aes", "calls": ["log_fn_"]}, {"name": "get_escaped_string_length", "calls": []}, {"name": "tor_inet_pton", "calls": ["TOR_ISDIGIT", "TOR_ISXDIGIT", "tor_assertion_failed_", "tor_inet_aton", "tor_sscanf"]}, {"name": "rend_service_desc_has_uploaded", "calls": ["safe_str_client", "tor_assertion_failed_", "rend_service_get_by_service_id", "find_intro_circuit", "smartlist_del", "circuit_mark_for_close_", "rend_intro_point_free", "log_fn_"]}, {"name": "authority_cert_get_by_digests", "calls": ["digestmap_get", "tor_memeq"]}, {"name": "guards_get_lifetime", "calls": ["get_options", "networkstatus_get_param"]}, {"name": "router_purpose_from_string", "calls": []}, {"name": "connection_or_set_identity_digest", "calls": ["channel_tls_to_base", "tor_digest_is_zero", "channel_set_identity_digest", "connection_or_remove_from_identity_map", "tor_assertion_failed_", "channel_clear_identity_digest", "digestmap_new", "digestmap_set", "tor_memeq"]}, {"name": "sigsys_debugging", "calls": ["get_syscall_name", "tor_log_get_sigsafe_err_fds", "clean_backtrace", "tor_log_err_sigsafe"]}, {"name": "rend_client_introcirc_has_opened", "calls": ["connection_ap_attach_pending", "tor_assertion_failed_", "log_fn_"]}, {"name": "connection_stop_reading", "calls": ["connection_stop_reading_from_linked_conn", "tor_assertion_failed_", "log_fn_"]}, {"name": "addr_policy_covers", "calls": ["tor_addr_family", "tor_addr_compare_masked"]}, {"name": "tor_strndup_", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "connection_or_process_cells_from_inbuf", "calls": ["channel_tls_to_base", "channel_timestamp_active", "var_cell_free", "connection_fetch_from_buf", "connection_fetch_var_cell_from_buf", "channel_tls_handle_var_cell", "tor_tls_get_pending_bytes", "connection_get_inbuf_len", "get_circuit_build_times_mutable", "get_cell_network_size", "cell_unpack", "circuit_build_times_network_is_live", "channel_tls_handle_cell", "log_fn_"]}, {"name": "memarea_assert_ok", "calls": ["realign_pointer", "get_uint32", "tor_assertion_failed_"]}, {"name": "parse_dir_fallback_line", "calls": ["tor_addr_port_parse", "smartlist_free", "smartlist_split_string", "fallback_dir_server_new", "tor_addr_parse", "smartlist_add", "dir_server_add", "tor_addr_family", "strcmpstart", "escaped", "strcasecmpstart", "tor_digest_is_zero", "tor_parse_double", "tor_addr_port_split", "base16_decode", "smartlist_new", "tor_parse_long", "log_fn_"]}, {"name": "crypto_read_tagged_contents_from_file", "calls": ["tor_strndup_", "read_file_to_str", "memwipe", "tor_mem_is_zero", "strcmpstart", "strcmpend"]}, {"name": "addressmap_free_all", "calls": []}, {"name": "circuit_build_times_shuffle_and_store_array", "calls": ["circuit_build_times_add_time", "crypto_rand_int", "log_fn_"]}, {"name": "channel_tls_write_var_cell_method", "calls": ["channel_tls_from_base", "connection_or_write_var_cell_to_buf", "tor_assertion_failed_", "log_fn_"]}, {"name": "rep_hist_note_connect_succeeded", "calls": ["get_or_history", "mark_or_up"]}, {"name": "nodelist_free_all", "calls": ["smartlist_free", "node_free", "nodelist_map_HT_CLEAR"]}, {"name": "tor_memdup_nulterm_", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "dir_conn_purpose_to_string", "calls": ["log_fn_"]}, {"name": "curve25519_keypair_read_from_file", "calls": ["curve25519_public_key_generate", "crypto_read_tagged_contents_from_file", "tor_memeq", "memwipe"]}, {"name": "channel_listener_count_accepted", "calls": ["tor_assertion_failed_"]}, {"name": "evdns_err_is_transient", "calls": []}, {"name": "geoip_reset_entry_stats", "calls": ["client_history_clear"]}, {"name": "networkstatus_get_bw_weight", "calls": ["networkstatus_get_latest_consensus", "log_fn_", "networkstatus_get_weight_scale_param", "get_net_param_from_list"]}, {"name": "control_event_conf_changed", "calls": ["smartlist_free", "smartlist_add_asprintf", "smartlist_join_strings", "send_control_event", "smartlist_new"]}, {"name": "policies_log_first_redundant_entry", "calls": ["policy_write_item", "tor_assertion_failed_", "tor_addr_family", "log_fn_"]}, {"name": "TOR_ISPRINT", "calls": []}, {"name": "rep_hist_reset_hs_stats", "calls": ["hs_stats_new", "digestmap_new"]}, {"name": "pathbias_get_scale_threshold", "calls": ["networkstatus_get_param"]}, {"name": "node_get_pref_ipv6_orport", "calls": ["tor_addr_copy", "tor_assertion_failed_"]}, {"name": "curve25519_set_impl_params", "calls": []}, {"name": "TOR_ISDIGIT", "calls": []}, {"name": "rep_hist_get_predicted_internal", "calls": ["get_options"]}, {"name": "connection_dir_list_by_purpose_resource_and_state", "calls": ["strcmp_opt", "get_connection_array", "smartlist_add", "TO_DIR_CONN", "smartlist_new"]}, {"name": "circuit_get_best", "calls": ["tor_gettimeofday", "circuit_is_acceptable", "tor_assertion_failed_", "circuit_is_better", "circuit_get_global_list", "TO_ORIGIN_CIRCUIT", "log_fn_"]}, {"name": "crypto_get_rsa_padding_overhead", "calls": ["tor_assertion_failed_"]}, {"name": "tor_tls_is_server", "calls": ["tor_assertion_failed_"]}, {"name": "dircollator_add_routerstatus", "calls": ["double_digest_map_HT_INSERT", "tor_mem_is_zero", "ddmap_entry_set_digests", "tor_assertion_failed_", "digestmap_get", "tor_calloc_", "digestmap_set", "double_digest_map_HT_FIND", "ddmap_entry_new"]}, {"name": "dir_microdesc_download_failed", "calls": ["get_options", "networkstatus_get_latest_consensus_by_flavor", "router_get_mutable_consensus_status_by_descriptor_digest", "download_status_increment_failure", "digest256_to_base64", "directory_fetches_from_authorities"]}, {"name": "packed_cell_copy", "calls": ["cell_pack", "packed_cell_new"]}, {"name": "circuit_log_path", "calls": ["tor_log", "circuit_list_path"]}, {"name": "rend_id_is_in_interval", "calls": ["tor_memcmp", "tor_assertion_failed_"]}, {"name": "authdir_config_new", "calls": ["strmap_new", "tor_malloc_zero_", "digestmap_new"]}, {"name": "decide_if_publishable_server", "calls": ["get_options", "server_mode", "router_get_advertised_or_port", "check_whether_dirport_reachable", "authdir_mode", "check_whether_orport_reachable"]}, {"name": "dump_cell_pool_usage", "calls": ["TO_OR_CIRCUIT", "circuit_get_global_list", "tor_log"]}, {"name": "format_win_cmdline_argument", "calls": ["smartlist_add", "tor_malloc_zero_", "smartlist_free", "smartlist_new"]}, {"name": "single_conn_free_bytes", "calls": ["buf_allocation", "TO_DIR_CONN", "buf_clear", "tor_zlib_state_size", "tor_zlib_free"]}, {"name": "control_event_circuit_cell_stats", "calls": ["get_options", "format_cell_stats", "sum_up_cell_stats_by_command", "tor_malloc_", "circuit_get_global_list", "send_control_event"]}, {"name": "rend_cache_failure_intro_entry_free", "calls": []}, {"name": "smartlist_pqueue_remove", "calls": ["tor_assertion_failed_"]}, {"name": "pathbias_check_close", "calls": ["pathbias_should_count", "pathbias_count_collapse", "pathbias_count_successful_close", "circuit_state_to_string", "pathbias_count_use_success", "pathbias_count_use_failed", "pathbias_send_usable_probe", "log_fn_"]}, {"name": "getinfo_helper_policies", "calls": ["get_options", "policies_parse_exit_policy_reject_private", "smartlist_free", "policies_copy_addr_to_smartlist", "router_get_my_routerinfo", "router_dump_exit_policy_to_string", "tor_strdup_", "smartlist_add_asprintf", "addr_policy_list_free", "policy_dump_to_string", "policies_copy_ipv4h_to_smartlist", "smartlist_join_strings", "strcmpstart", "policies_copy_outbound_addresses_to_smartlist", "smartlist_new"]}, {"name": "channel_tls_free_all", "calls": ["channel_listener_unregister", "tor_assertion_failed_", "log_fn_"]}, {"name": "memarea_alloc_zero", "calls": ["memarea_alloc"]}, {"name": "extend_info_describe", "calls": ["extend_info_get_description"]}, {"name": "validate_data_directory", "calls": ["tor_assertion_failed_", "normalize_data_directory", "log_fn_"]}, {"name": "flush_chunk", "calls": ["tor_assertion_failed_", "buf_remove_from_front", "log_fn_"]}, {"name": "channel_init", "calls": ["tor_assertion_failed_", "channel_timestamp_created"]}, {"name": "circuitmux_alloc", "calls": ["cell_queue_init", "tor_malloc_zero_", "chanid_circid_muxinfo_map_HT_INIT"]}, {"name": "hex_digest_nickname_matches", "calls": ["hex_digest_nickname_decode", "tor_memeq"]}, {"name": "send_control_event", "calls": ["send_control_event_impl"]}, {"name": "chanid_circid_muxinfo_map_HT_INIT", "calls": []}, {"name": "geoip_note_ns_response", "calls": ["get_options", "tor_assertion_failed_"]}, {"name": "router_reload_router_list", "calls": ["router_reload_router_list_impl", "router_get_routerlist"]}, {"name": "get_list_of_ports_to_forward", "calls": ["get_options", "smartlist_free", "get_transport_proxy_ports", "smartlist_add_asprintf", "smartlist_add_all", "router_get_advertised_or_port", "router_get_advertised_dir_port", "smartlist_new"]}, {"name": "clientmap_HT_INIT", "calls": []}, {"name": "circuit_find_to_cannibalize", "calls": ["get_options", "nodes_in_same_family", "tor_assertion_failed_", "circuit_get_global_list", "routerset_contains_extendinfo", "TO_ORIGIN_CIRCUIT", "node_get_by_id", "tor_memeq", "log_fn_"]}, {"name": "microdesc_average_size", "calls": ["get_microdesc_cache"]}, {"name": "digestmap_new", "calls": ["tor_malloc_", "digestmap_impl_HT_INIT"]}, {"name": "connection_state_is_connecting", "calls": ["tor_assertion_failed_"]}, {"name": "connection_edge_about_to_close", "calls": ["log_fn_"]}, {"name": "add_transport_to_proxy", "calls": ["smartlist_add", "tor_assertion_failed_", "tor_strdup_", "smartlist_contains_string"]}, {"name": "rend_mid_establish_intro", "calls": ["get_options", "crypto_pk_asn1_decode", "relay_send_command_from_edge_", "crypto_pk_free", "base32_encode", "circuit_change_purpose", "safe_str", "crypto_pk_public_checksig_digest", "crypto_pk_get_digest", "get_uint16", "note_crypto_pk_op", "crypto_digest", "circuit_set_intro_point_digest", "circuit_mark_for_close_", "circuit_get_intro_point", "tor_memeq", "log_fn_"]}, {"name": "router_is_active", "calls": ["get_options"]}, {"name": "circuit_reset_failure_count", "calls": []}, {"name": "dns_init", "calls": ["get_options", "init_cache_map", "configure_nameservers", "server_mode"]}, {"name": "num_live_entry_guards", "calls": ["entry_is_live"]}, {"name": "get_effective_bwburst", "calls": []}, {"name": "port_cfg_new", "calls": ["tor_malloc_zero_", "tor_assertion_failed_"]}, {"name": "router_get_advertised_bandwidth", "calls": []}, {"name": "crypto_digest512", "calls": ["tor_assertion_failed_"]}, {"name": "directory_remove_invalid", "calls": ["routerlist_assert_ok", "smartlist_free", "routerlist_remove", "router_get_routerlist", "smartlist_add_all", "nodelist_get_list", "dirserv_router_get_status", "log_fn_", "smartlist_new", "router_get_description"]}, {"name": "get_current_curve25519_keypair", "calls": []}, {"name": "router_rebuild_descriptor", "calls": ["get_options", "extrainfo_free", "router_pick_published_address", "router_get_advertised_or_port", "routerinfo_free", "control_event_my_descriptor_changed", "router_build_fresh_descriptor", "log_fn_"]}, {"name": "channel_listener_state_to_string", "calls": []}, {"name": "crypto_random_hostname", "calls": ["crypto_rand", "strlcpy", "crypto_rand_int_range", "base32_encode", "tor_malloc_"]}, {"name": "strmap_impl_HT_REP_IS_BAD_", "calls": ["strmap_entry_hash"]}, {"name": "tor_gzip_compress", "calls": ["is_compression_bomb", "tor_assertion_failed_", "get_memlevel", "method_bits", "tor_realloc_", "tor_malloc_zero_", "tor_malloc_", "is_gzip_supported", "log_fn_"]}, {"name": "configure_nameservers", "calls": ["tor_strdup_", "tor_libevent_get_base", "get_options", "mark_my_descriptor_dirty", "log_fn_", "dns_servers_relaunch_checks", "sandbox_intern_string"]}, {"name": "dirreqmap_HT_FIND_P_", "calls": ["dirreq_map_ent_eq"]}, {"name": "list_pending_fpsk_downloads", "calls": ["smartlist_free", "get_connection_array", "TO_DIR_CONN", "tor_assertion_failed_", "fp_pair_map_set", "dir_split_resource_into_fingerprint_pairs", "strcmpstart", "smartlist_new"]}, {"name": "addr_port_lookup", "calls": ["tor_strdup_", "tor_assertion_failed_", "escaped", "tor_strndup_", "esc_for_log", "tor_lookup_hostname", "tor_parse_long", "log_fn_"]}, {"name": "dirvote_publish_consensus", "calls": ["networkstatus_get_flavor_name", "tor_assertion_failed_", "networkstatus_check_consensus_signature", "networkstatus_set_current_consensus", "log_fn_"]}, {"name": "count_pending_general_client_circuits", "calls": ["circuit_get_global_list"]}, {"name": "networkstatus_consensus_is_downloading_usable_flavor", "calls": ["connection_dir_count_by_purpose_and_resource", "usable_consensus_flavor", "networkstatus_get_flavor_name", "connection_dir_count_by_purpose_resource_and_state"]}, {"name": "size_mul_check", "calls": []}, {"name": "command_process_relay_cell", "calls": ["get_options", "circuit_receive_relay_cell", "circuit_get_by_circid_channel", "rep_hist_seen_new_rp_cell", "safe_str", "TO_OR_CIRCUIT", "circuit_log_path", "channel_timestamp_client", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "log_fn_"]}, {"name": "channel_tls_update_marks", "calls": ["channel_tls_to_base", "channel_mark_remote", "tor_assertion_failed_", "channel_mark_local", "is_local_addr", "channel_is_local", "log_fn_"]}, {"name": "tor_passwd_free", "calls": []}, {"name": "channel_dump_statistics", "calls": ["tor_digest_is_zero", "circuitmux_num_active_circuits", "circuitmux_num_circuits", "tor_strdup_", "safe_str", "channel_is_incoming", "chan_cell_queue_len", "hex_str", "tor_log", "tor_assertion_failed_", "channel_state_to_string", "channel_is_local", "channel_is_client", "tor_dup_addr", "channel_is_bad_for_new_circs"]}, {"name": "digestset_add", "calls": ["bitarray_set"]}, {"name": "geoip_get_country", "calls": ["strmap_get_lc"]}, {"name": "connection_or_set_canonical", "calls": ["crypto_rand_int"]}, {"name": "rend_client_report_intro_point_failure", "calls": ["rend_cache_intro_failure_note", "rend_client_refetch_v2_renddesc", "connection_ap_mark_as_non_pending_circuit", "TO_ENTRY_CONN", "connection_get_by_type_state_rendquery", "tor_memeq", "rend_client_any_intro_points_usable", "smartlist_del", "rend_intro_point_free", "rend_cache_lookup_entry", "escaped_safe_str_client", "log_fn_"]}, {"name": "control_event_bandwidth_used", "calls": ["send_control_event"]}, {"name": "update_microdesc_downloads", "calls": ["get_options", "list_pending_microdesc_downloads", "networkstatus_get_reasonably_live_consensus", "get_microdesc_cache", "we_fetch_microdescriptors", "digest256map_new", "smartlist_free", "launch_descriptor_downloads", "should_delay_dir_fetches", "directory_too_idle_to_fetch_descriptors", "microdesc_list_missing_digest256"]}, {"name": "crypto_cipher_free", "calls": ["aes_cipher_free", "tor_assertion_failed_", "memwipe"]}, {"name": "connection_or_write_cell_to_buf", "calls": ["channel_tls_to_base", "channel_timestamp_active", "connection_write_to_buf", "tor_assertion_failed_", "get_cell_network_size", "cell_pack", "or_handshake_state_record_cell"]}, {"name": "routerset_refresh_countries", "calls": ["geoip_get_country", "bitarray_set", "tor_assertion_failed_", "geoip_get_n_countries", "geoip_is_loaded", "bitarray_init_zero", "bitarray_free", "log_fn_"]}, {"name": "count_usable_descriptors", "calls": ["microdesc_cache_lookup_by_digest256", "router_get_by_descriptor_digest", "smartlist_add", "routerset_contains_routerstatus", "client_would_use_router", "node_get_by_id", "log_fn_"]}, {"name": "authdir_mode_handles_descs", "calls": ["authdir_mode_any_nonhidserv", "authdir_mode_any_main"]}, {"name": "tor_lockfile_unlock", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "assert_resolve_ok", "calls": ["tor_assertion_failed_", "tor_strisnonupper"]}, {"name": "handle_control_saveconf", "calls": ["options_save_current", "connection_write_str_to_buf", "send_control_done"]}, {"name": "routerset_is_empty", "calls": []}, {"name": "update_microdescs_from_networkstatus", "calls": ["get_microdesc_cache", "tor_assertion_failed_", "networkstatus_get_reasonably_live_consensus", "microdesc_cache_lookup_by_digest256"]}, {"name": "rep_hist_load_bwhist_state_section", "calls": ["tor_parse_uint64", "add_obs", "log_fn_"]}, {"name": "_cmp_int32_t", "calls": []}, {"name": "options_dump", "calls": ["log_fn_"]}, {"name": "fp_pair_map_isempty", "calls": ["tor_assertion_failed_"]}, {"name": "connection_tls_finish_handshake", "calls": ["connection_or_send_versions", "connection_init_or_handshake_state", "tor_tls_used_v1_handshake", "connection_or_nonopen_was_started_here", "connection_or_init_conn_from_address", "rep_hist_note_negotiated_link_proto", "tor_assertion_failed_", "connection_or_check_valid_tls_handshake", "connection_or_set_state_open", "connection_or_change_state", "tor_tls_block_renegotiation", "tor_tls_get_ciphersuite_name", "get_circuit_build_times_mutable", "circuit_build_times_network_is_live", "safe_str_client", "log_fn_"]}, {"name": "get_parent_directory", "calls": ["tor_assertion_failed_"]}, {"name": "networkstatus_check_weights", "calls": ["log_fn_"]}, {"name": "authdir_policy_valid_address", "calls": ["get_options", "addr_is_in_cc_list", "addr_policy_permits_address"]}, {"name": "nodelist_get_list", "calls": ["init_nodelist"]}, {"name": "rend_service_parse_port_config", "calls": ["rend_service_port_config_new", "smartlist_free", "tor_addr_copy", "tor_strdup_", "escaped", "config_parse_unix_port", "smartlist_split_string", "tor_asprintf", "tor_addr_port_lookup", "smartlist_new", "tor_parse_long", "tor_addr_from_ipv4n"]}, {"name": "update_circuit_on_cmux_", "calls": ["circuitmux_attached_circuit_direction", "circuitmux_is_circuit_attached", "tor_assertion_failed_", "TO_OR_CIRCUIT", "log_fn_"]}, {"name": "tor_tls_context_init", "calls": ["tor_tls_context_init_one", "tor_assertion_failed_", "check_no_tls_errors_", "tor_tls_context_decref", "tls_log_errors", "tor_tls_context_incref"]}, {"name": "router_orport_found_reachable", "calls": ["get_options", "router_get_my_routerinfo", "tor_dup_ip", "reschedule_descriptor_update_check", "check_whether_dirport_reachable", "mark_my_descriptor_dirty", "control_event_server_status", "log_fn_"]}, {"name": "tor_get_exit_code", "calls": ["clear_waitpid_callback", "log_fn_"]}, {"name": "fast_handshake_state_free", "calls": ["memwipe"]}, {"name": "tor_open_socket_nonblocking", "calls": ["tor_open_socket_with_extensions"]}, {"name": "socks_request_free", "calls": ["memwipe"]}, {"name": "alloc_chunk", "calls": ["get_uint32", "realign_pointer", "tor_assertion_failed_", "tor_malloc_", "set_uint32"]}, {"name": "rend_encoded_v2_service_descriptor_free", "calls": []}, {"name": "authdir_mode_any_main", "calls": []}, {"name": "connection_bucket_init", "calls": ["get_options"]}, {"name": "control_event_hs_descriptor_receive_end", "calls": ["tor_asprintf", "base32_encode", "get_desc_id_from_query", "rend_auth_type_to_string", "send_control_event", "node_describe_longname_by_id", "rend_hsaddress_str_or_unknown", "log_fn_"]}, {"name": "dirreqmap_HT_REPLACE", "calls": ["dirreqmap_HT_GROW", "dirreqmap_HT_FIND_P_", "dirreq_map_ent_hash"]}, {"name": "llvm.memmove.p0i8.p0i8.i64", "calls": []}, {"name": "update_router_have_minimum_dir_info", "calls": ["get_options", "networkstatus_get_reasonably_live_consensus", "compute_frac_paths_available", "strlcpy", "control_event_client_status", "networkstatus_get_latest_consensus", "get_frac_paths_needed_for_circs", "usable_consensus_flavor", "tor_log", "tor_snprintf", "directory_too_idle_to_fetch_descriptors", "control_event_bootstrap", "note_that_we_maybe_cant_complete_circuits", "log_fn_"]}, {"name": "http_set_address_origin", "calls": ["tor_addr_is_internal_", "tor_addr_parse", "tor_strdup_", "escaped", "http_get_header", "log_fn_"]}, {"name": "circuit_mark_all_unused_circs", "calls": ["circuit_mark_for_close_", "circuit_get_global_list"]}, {"name": "tor_addr_parse_mask_ports", "calls": ["tor_addr_make_unspec", "tor_assertion_failed_", "tor_strdup_", "parse_port_range", "tor_addr_family", "tor_addr_from_in6", "escaped", "tor_addr_is_v4", "tor_addr_from_ipv4n", "tor_inet_pton", "tor_addr_from_ipv6_bytes", "addr_mask_get_bits", "log_fn_"]}, {"name": "chan_circid_map_HT_REP_IS_BAD_", "calls": ["chan_circid_entry_hash_"]}, {"name": "destination_from_socket", "calls": ["tor_addr_to_str", "tor_addr_from_sockaddr", "log_fn_"]}, {"name": "digestmap_iter_init", "calls": ["digestmap_impl_HT_START", "tor_assertion_failed_"]}, {"name": "find_rp_for_intro", "calls": ["extend_info_dup", "tor_strdup_", "node_get_by_nickname", "extend_info_from_node", "tor_asprintf", "escaped_safe_str_client"]}, {"name": "parse_env_error", "calls": ["log_fn_"]}, {"name": "rend_process_relay_cell", "calls": ["get_options", "rend_mid_establish_rendezvous", "rend_mid_rendezvous", "rend_client_introduction_acked", "TO_OR_CIRCUIT", "rend_client_receive_rendezvous", "rend_service_receive_introduction", "rend_client_rendezvous_acked", "rend_mid_introduce", "rend_service_intro_established", "rend_mid_establish_intro", "TO_ORIGIN_CIRCUIT", "log_fn_"]}, {"name": "tor_read_all_handle", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "tor_addr_is_multicast", "calls": ["tor_addr_to_ipv4h", "tor_addr_family", "tor_addr_to_in6"]}, {"name": "rend_client_get_random_intro", "calls": ["get_options", "safe_str_client", "rend_client_any_intro_points_usable", "log_fn_", "rend_cache_lookup_entry", "rend_client_get_random_intro_impl"]}, {"name": "tor_connect_socket", "calls": []}, {"name": "microdesc_map_HT_CLEAR", "calls": ["microdesc_map_HT_INIT", "tor_free_"]}, {"name": "domain_to_string", "calls": ["tor_log2", "tor_snprintf", "strlcpy"]}, {"name": "digest256map_impl_HT_FIND_P_", "calls": ["digest256map_entries_eq"]}, {"name": "rend_cache_failure_entry_free_", "calls": ["rend_cache_failure_entry_free"]}, {"name": "ed25519_keypair_generate", "calls": []}, {"name": "nodelist_drop_node", "calls": ["smartlist_del", "tor_assertion_failed_", "nodelist_map_HT_REMOVE"]}, {"name": "warn_nonlocal_client_ports", "calls": ["tor_addr_is_internal_", "fmt_addrport", "tor_addr_is_loopback", "log_fn_"]}, {"name": "is_gzip_supported", "calls": ["strcmpstart"]}, {"name": "connection_ap_can_use_exit", "calls": ["get_options", "compare_tor_addr_to_node_policy", "routerset_contains_node", "tor_assertion_failed_", "node_exit_policy_rejects_all", "tor_memeq", "node_get_by_nickname", "tor_addr_parse", "tor_addr_make_null"]}, {"name": "digestmap_size", "calls": []}, {"name": "read_ni", "calls": []}, {"name": "connection_handle_listener_read", "calls": ["get_options", "conn_type_to_string", "TO_LISTENER_CONN", "tor_addr_make_unspec", "set_constrained_socket_buffers", "dir_policy_permits_address", "make_socket_reuseable", "connection_init_accepted_conn", "tor_strdup_", "tor_close_socket", "connection_add_impl", "connection_mark_for_close_", "fmt_addr_impl", "check_sockaddr", "tor_addr_from_sockaddr", "socks_policy_permits_address", "tor_assertion_failed_", "warn_too_many_conns", "connection_free", "check_sockaddr_family_match", "tor_dup_addr", "tor_addr_copy", "connection_new", "tor_accept_socket_nonblocking", "log_fn_"]}, {"name": "connection_control_process_inbuf", "calls": ["is_valid_initial_command", "TOR_ISSPACE", "handle_control_setcircuitpurpose", "handle_control_setevents", "handle_control_mapaddress", "handle_control_loadconf", "connection_fetch_from_buf_line", "handle_control_getinfo", "connection_printf_to_buf", "handle_control_saveconf", "TO_OR_CONN", "strlcpy", "memwipe", "handle_control_authchallenge", "connection_stop_reading", "handle_control_redirectstream", "handle_control_dropguards", "connection_write_to_buf", "handle_control_postdescriptor", "set_uint16", "connection_write_str_to_buf", "connection_mark_for_close_", "handle_control_closecircuit", "handle_control_hsfetch", "handle_control_signal", "handle_control_add_onion", "handle_control_closestream", "handle_control_resolve", "tor_assertion_failed_", "handle_control_setconf", "handle_control_protocolinfo", "peek_connection_has_control0_command", "handle_control_attachstream", "handle_control_takeownership", "tor_memeq", "handle_control_extendcircuit", "connection_mark_for_close_internal_", "handle_control_usefeature", "handle_control_del_onion", "log_fn_", "tor_malloc_", "tor_realloc_", "handle_control_getconf", "handle_control_authenticate", "handle_control_hspost", "handle_control_resetconf", "connection_or_close_for_error"]}, {"name": "node_get_by_nickname", "calls": ["smartlist_free", "base16_encode", "networkstatus_nickname_is_unnamed", "node_get_by_hex_id", "networkstatus_get_router_digest_by_nickname", "smartlist_new", "escaped", "node_get_nickname", "node_get_by_id", "smartlist_add", "log_fn_"]}, {"name": "proxy_needs_restart", "calls": ["strcmp_opt", "tor_assertion_failed_", "smartlist_contains_string", "get_pt_proxy_uri"]}, {"name": "is_legal_nickname_or_hexdigest", "calls": ["is_legal_hexdigest", "is_legal_nickname"]}, {"name": "detached_get_signatures", "calls": ["strmap_set", "smartlist_new", "strmap_get"]}, {"name": "crypto_strongest_rand_syscall", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "connection_or_mark_bad_for_new_circs", "calls": ["channel_tls_to_base", "tor_assertion_failed_", "channel_mark_bad_for_new_circs"]}, {"name": "channel_tls_handle_var_cell", "calls": ["channel_tls_to_base", "get_options", "conn_state_to_string", "channel_tls_process_auth_challenge_cell", "or_handshake_state_record_var_cell", "channel_tls_process_authenticate_cell", "tor_assertion_failed_", "command_allowed_before_handshake", "enter_v3_handshake_with_cell", "channel_tls_process_certs_cell", "channel_state_to_string", "channel_tls_process_versions_cell", "log_fn_", "connection_or_close_for_error"]}, {"name": "accounting_set_wakeup_time", "calls": ["crypto_rand", "get_options", "get_uint32", "init_keys", "server_identity_key_is_set", "format_local_iso_time", "tor_assertion_failed_", "crypto_digest_free", "format_iso_time", "crypto_pk_get_digest", "get_server_identity_key", "crypto_digest_new", "crypto_digest_add_bytes", "accounting_get_interval_length", "crypto_digest_get_digest", "log_fn_"]}, {"name": "monitor_owning_controller_process", "calls": ["tor_process_monitor_new", "tor_strdup_", "tor_process_monitor_free", "tor_assertion_failed_", "tor_cleanup", "tor_libevent_get_base", "log_fn_"]}, {"name": "sb_stat64", "calls": ["log_fn_"]}, {"name": "connection_ap_handshake_attach_chosen_circuit", "calls": ["consider_recording_trackhost", "connection_ap_handshake_send_begin", "pathbias_count_use_attempt", "tor_assertion_failed_", "link_apconn_to_circ", "connection_ap_handshake_send_resolve", "approx_time"]}, {"name": "router_upload_dir_desc_to_dirservers", "calls": ["get_options", "router_get_my_routerinfo", "tor_malloc_", "directory_post_to_dirservers", "log_fn_", "router_get_my_extrainfo"]}, {"name": "get_cell_network_size", "calls": []}, {"name": "parse_cmethod_line", "calls": ["smartlist_free", "smartlist_split_string", "tor_addr_parse", "smartlist_add", "tor_assertion_failed_", "transport_new", "tor_addr_port_split", "string_is_C_identifier", "smartlist_new", "log_fn_"]}, {"name": "addressmap_address_should_automap", "calls": ["strcasecmpend"]}, {"name": "find_start_of_next_microdesc", "calls": ["strcmpstart", "eat_whitespace_eos"]}, {"name": "sock_alert", "calls": ["send_ni"]}, {"name": "register_proxy", "calls": ["register_server_proxy", "register_client_proxy"]}, {"name": "ns_detached_signatures_free", "calls": ["strmap_iter_get", "smartlist_free", "strmap_iter_init", "document_signature_free", "strmap_iter_next", "strmap_iter_done"]}, {"name": "rend_service_receive_introduction", "calls": ["get_options", "circuit_launch_by_extend_info", "crypto_dh_generate_public", "crypto_dh_compute_secret", "escaped", "find_intro_point", "circuit_mark_for_close_", "safe_str_client", "tor_strdup_", "extend_info_free", "rend_service_decrypt_intro", "extend_info_describe", "crypto_dh_new", "rend_data_service_create", "find_expiring_intro_point", "rend_service_requires_uptime", "rend_service_get_by_pk_digest", "rend_service_validate_intro_late", "replaycache_add_test_and_elapsed", "replaycache_new", "rend_service_free_intro", "tor_assertion_failed_", "circuit_init_cpath_crypto", "rep_hist_note_used_internal", "find_rp_for_intro", "tor_asprintf", "base16_encode", "base32_encode", "tor_malloc_zero_", "memwipe", "routerset_contains_extendinfo", "crypto_dh_free", "rend_check_authorization", "rend_service_begin_parse_intro", "log_fn_"]}, {"name": "sandbox_cfg_new", "calls": []}, {"name": "connection_fetch_ext_or_cmd_from_buf", "calls": ["fetch_ext_or_command_from_buf"]}, {"name": "clock_skew_warning", "calls": ["tor_strdup_", "control_event_general_status", "format_time_interval", "tor_asprintf", "log_fn_"]}, {"name": "smartlist_sort_strings", "calls": ["smartlist_sort"]}, {"name": "get_desc_id_from_query", "calls": ["tor_digest_is_zero", "tor_memcmp"]}, {"name": "choose_array_element_by_weight", "calls": ["tor_assertion_failed_", "crypto_rand_uint64", "crypto_rand_int"]}, {"name": "event_to_log_severity", "calls": []}, {"name": "crypto_global_cleanup", "calls": ["tor_mutex_free"]}, {"name": "crypto_set_tls_dh_prime", "calls": ["tor_assertion_failed_"]}, {"name": "cpath_is_on_circuit", "calls": []}, {"name": "connection_read_https_proxy_response", "calls": ["parse_http_response", "tor_strdup_", "escaped", "fetch_from_buf_http", "log_fn_"]}, {"name": "write_stats_file_callback", "calls": ["rep_hist_desc_stats_write", "rep_hist_hs_stats_write", "rep_hist_conn_stats_write", "rep_hist_exit_stats_write", "geoip_entry_stats_write", "geoip_dirreq_stats_write", "safe_timer_diff", "rep_hist_buffer_stats_write"]}, {"name": "channel_more_to_flush", "calls": ["circuitmux_num_cells", "tor_assertion_failed_"]}, {"name": "bridge_has_digest", "calls": ["tor_digest_is_zero", "tor_memeq"]}, {"name": "digestmap_impl_HT_FIND_P_", "calls": ["digestmap_entries_eq"]}, {"name": "add_file_log", "calls": ["tor_mutex_release", "add_stream_log_impl", "tor_mutex_acquire", "tor_open_cloexec", "delete_log", "tor_fd_seekend", "get_min_log_level", "log_tor_version"]}, {"name": "connection_dir_would_close_consensus_conn_helper", "calls": ["get_options", "networkstatus_consensus_is_boostrapping", "networkstatus_consensus_has_excess_connections", "networkstatus_consensus_is_downloading_usable_flavor", "networkstatus_consensus_can_use_multiple_directories"]}, {"name": "config_new", "calls": ["tor_malloc_zero_", "tor_assertion_failed_"]}, {"name": "circuit_get_cpath_len", "calls": []}, {"name": "clientmap_HT_NEXT_RMV", "calls": []}, {"name": "dirserv_add_descriptor", "calls": ["get_options", "smartlist_free", "dirserv_should_launch_reachability_test", "smartlist_add", "keypin_check_and_add", "router_add_to_routerlist", "WRA_WAS_ADDED", "router_describe", "keypin_check_lone_rsa", "router_get_mutable_by_digest", "router_is_me", "tor_strndup_", "routerinfo_free", "control_event_or_authdir_new_descriptor", "routerlist_descriptors_added", "tor_strdup_", "WRA_WAS_REJECTED", "smartlist_new", "router_differences_are_cosmetic", "log_fn_"]}, {"name": "circuit_testing_failed", "calls": ["get_options", "check_whether_orport_reachable", "server_mode", "log_fn_"]}, {"name": "dirreqmap_HT_NEXT_RMV", "calls": []}, {"name": "channel_state_can_transition", "calls": []}, {"name": "routerinfo_free", "calls": ["smartlist_free", "crypto_pk_free", "short_policy_free", "addr_policy_list_free", "tor_cert_free"]}, {"name": "channel_mark_circid_usable", "calls": ["chan_circid_map_HT_REMOVE", "log_fn_"]}, {"name": "set_uint8", "calls": []}, {"name": "bridge_get_advertised_bandwidth_bounded", "calls": []}, {"name": "adjust_exit_policy_from_exitpolicy_failure", "calls": ["node_describe", "node_exit_policy_is_exact", "tor_addr_parse", "tor_addr_family", "addr_policy_append_reject_addr", "policies_set_node_exitpolicy_to_reject_all", "log_fn_"]}, {"name": "nodelist_refresh_countries", "calls": ["nodelist_get_list", "node_set_country"]}, {"name": "client_dns_set_addressmap_impl", "calls": ["dns_clip_ttl", "tor_assertion_failed_", "addressmap_register", "tor_asprintf"]}, {"name": "routerlist_remove_old", "calls": ["tor_digest_is_zero", "extrainfo_free", "tor_assertion_failed_", "desc_get_store", "signed_descriptor_free", "smartlist_del", "sdmap_remove", "eimap_remove"]}, {"name": "find_single_ipv6_orport", "calls": ["tor_addr_copy", "tor_assertion_failed_", "tor_addr_parse_mask_ports"]}, {"name": "rend_cache_failure_entry_free", "calls": []}, {"name": "sweep_transport_list", "calls": ["smartlist_del", "transport_free", "smartlist_new"]}, {"name": "WRA_WAS_ADDED", "calls": []}, {"name": "channel_write_var_cell", "calls": ["var_cell_free", "channel_is_in_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "node_get_declared_family", "calls": []}, {"name": "add_an_entry_guard", "calls": ["get_options", "log_entry_guards", "entry_guard_get_by_id_digest", "strlcpy", "control_event_guard_deferred", "control_event_guard", "node_is_dir", "node_get_nickname", "smartlist_add", "smartlist_insert", "node_is_a_configured_bridge", "tor_malloc_zero_", "choose_good_entry_server", "router_pick_directory_server", "tor_strdup_", "node_get_by_id", "crypto_rand_time_range", "node_describe", "log_fn_"]}, {"name": "circuit_resume_edge_reading_helper", "calls": ["TO_OR_CIRCUIT", "circuit_consider_stop_edge_reading", "connection_get_inbuf_len", "connection_edge_package_raw_inbuf", "connection_start_reading", "connection_mark_for_close_", "tor_weak_random_range"]}, {"name": "config_parse_commandline", "calls": ["tor_strdup_", "config_free_lines", "tor_malloc_zero_", "config_expand_abbrev", "log_fn_"]}, {"name": "policies_copy_ipv4h_to_smartlist", "calls": ["policies_copy_addr_to_smartlist", "tor_addr_from_ipv4n"]}, {"name": "crypto_digest_algorithm_parse_name", "calls": []}, {"name": "handle_control_closecircuit", "calls": ["smartlist_free", "getargs_helper", "send_control_done", "connection_printf_to_buf", "circuit_mark_for_close_", "get_circ", "log_fn_"]}, {"name": "rend_cache_increment_allocation", "calls": ["log_fn_"]}, {"name": "control_event_stream_status", "calls": ["write_stream_target_to_buf", "tor_asprintf", "strlcpy", "tor_snprintf", "tor_assertion_failed_", "circuit_get_by_edge_conn", "TO_ORIGIN_CIRCUIT", "send_control_event", "stream_end_reason_to_control_string", "log_fn_"]}, {"name": "cmp_single_addr_policy", "calls": ["tor_addr_compare"]}, {"name": "node_get_prim_orport", "calls": ["tor_assertion_failed_", "tor_addr_from_ipv4n"]}, {"name": "hex_decode_digit_", "calls": []}, {"name": "router_find_exact_exit_enclave", "calls": ["get_options", "tor_inet_aton", "routerset_contains_node", "node_get_prim_addr_ipv4h", "nodelist_get_list", "compare_tor_addr_to_node_policy", "tor_addr_from_ipv4n"]}, {"name": "getaddrinfo_cache_HT_INSERT", "calls": ["getaddrinfo_cache_HT_GROW", "cached_getaddrinfo_item_hash"]}, {"name": "circuitmux_is_circuit_attached", "calls": ["circuitmux_find_map_entry"]}, {"name": "circuit_end_reason_to_control_string", "calls": ["log_fn_"]}, {"name": "router_get_my_descriptor", "calls": ["router_get_my_routerinfo", "tor_assertion_failed_", "signed_descriptor_get_body", "log_fn_"]}, {"name": "crypto_dh_generate_public", "calls": ["crypto_log_errors", "tor_check_dh_key", "log_fn_"]}, {"name": "node_addrs_changed", "calls": []}, {"name": "config_get_assigned_option", "calls": ["config_lines_dup", "smartlist_free", "routerset_to_string", "config_find_option", "tor_strdup_", "smartlist_join_strings", "tor_assertion_failed_", "smartlist_add_asprintf", "format_iso_time", "config_value_needs_escape", "tor_malloc_", "esc_for_log", "tor_asprintf", "tor_malloc_zero_", "smartlist_new", "log_fn_"]}, {"name": "onionskin_answer", "calls": ["get_options", "get_uint32", "router_orport_found_reachable", "append_cell_to_circuit_queue", "tor_malloc_zero_", "circuit_init_cpath_crypto", "created_cell_format", "channel_is_outgoing", "log_fn_", "channel_is_local", "circuit_set_state"]}, {"name": "chunk_copy", "calls": ["tor_memdup_"]}, {"name": "rend_desc_v2_is_parsable", "calls": ["rend_parse_v2_service_descriptor", "rend_service_descriptor_free"]}, {"name": "get_options_for_server_transport", "calls": ["get_options", "get_options_from_transport_options_line"]}, {"name": "dirserv_estimate_data_size", "calls": ["lookup_cached_dir_by_fp", "tor_assertion_failed_", "router_get_my_routerinfo"]}, {"name": "parse_port_config", "calls": ["smartlist_free", "tor_addr_make_unspec", "tor_addr_family", "escaped", "warn_nonlocal_controller_ports", "tor_strdup_", "tor_strndup_", "tor_addr_port_lookup", "strcasecmpend", "smartlist_split_string", "smartlist_add", "tor_assertion_failed_", "port_cfg_new", "smartlist_clear", "tor_addr_copy", "tor_addr_parse", "strcasecmpstart", "conn_listener_type_supports_af_unix", "warn_nonlocal_ext_orports", "warn_nonlocal_client_ports", "smartlist_new", "config_parse_unix_port", "tor_parse_long", "log_fn_"]}, {"name": "pending_log_message_new", "calls": ["tor_malloc_", "tor_strdup_"]}, {"name": "tor_tls_context_init_one", "calls": ["tor_tls_context_decref", "tor_tls_context_new"]}, {"name": "install_bt_handler", "calls": ["tor_mutex_init", "log_fn_"]}, {"name": "digest_to_base64", "calls": ["base64_encode"]}, {"name": "routerset_contains_router", "calls": ["routerset_contains", "tor_addr_from_ipv4n"]}, {"name": "circuit_get_intro_point", "calls": ["circuit_get_by_rend_token_and_purpose"]}, {"name": "channel_free_list", "calls": ["channel_is_in_state", "tor_assertion_failed_", "smartlist_del", "channel_state_to_string", "channel_unregister", "log_fn_"]}, {"name": "stream_end_reason_to_string", "calls": ["get_options", "log_fn_"]}, {"name": "get_last_resolved_addr", "calls": []}, {"name": "rend_service_requires_uptime", "calls": ["get_options", "smartlist_contains_int_as_string"]}, {"name": "fmt_addr32", "calls": ["tor_inet_ntoa"]}, {"name": "microdesc_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "cache_map_HT_REP_IS_BAD_", "calls": ["cached_resolve_hash"]}, {"name": "hibernate_begin", "calls": ["get_accounting_bytes", "get_options", "or_state_mark_dirty", "accounting_record_bandwidth_usage", "get_or_state", "connection_mark_all_noncontrol_listeners", "tor_cleanup", "log_fn_"]}, {"name": "control_event_guard_deferred", "calls": []}, {"name": "tor_tls_peer_has_cert", "calls": ["tls_log_errors"]}, {"name": "directory_too_idle_to_fetch_descriptors", "calls": ["directory_caches_dir_info", "rep_hist_circbuilding_dormant"]}, {"name": "make_specifier", "calls": ["crypto_rand", "secret_to_key_spec_len"]}, {"name": "chan_circid_map_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "channel_flush_cells", "calls": []}, {"name": "we_want_to_fetch_flavor", "calls": ["usable_consensus_flavor", "authdir_mode_v3", "directory_caches_dir_info"]}, {"name": "log_level_to_string", "calls": ["sev_to_string"]}, {"name": "connection_edge_consider_sending_sendme", "calls": ["connection_outbuf_too_full", "connection_edge_send_command", "circuit_get_by_edge_conn", "log_fn_"]}, {"name": "circuit_timeout_want_to_count_circ", "calls": []}, {"name": "fp_pair_map_impl_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "bidimap_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "assert_cpath_layer_ok", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "router_add_extrainfo_to_routerlist", "calls": ["WRA_WAS_ADDED", "signed_desc_append_to_journal", "extrainfo_insert", "router_get_routerlist"]}, {"name": "register_server_proxy", "calls": ["fmt_addrport", "tor_assertion_failed_", "save_transport_to_state", "control_event_transport_launched", "log_fn_"]}, {"name": "command_setup_channel", "calls": ["channel_set_cell_handlers", "tor_assertion_failed_"]}, {"name": "pipe_drain", "calls": ["read_ni"]}, {"name": "router_get_my_extrainfo", "calls": ["get_options", "router_rebuild_descriptor", "server_mode"]}, {"name": "eimap_get", "calls": ["digestmap_get"]}, {"name": "listener_connection_new", "calls": ["tor_malloc_zero_", "connection_init"]}, {"name": "EDGE_TO_ENTRY_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "connection_dir_list_by_purpose_and_resource", "calls": ["strcmp_opt", "get_connection_array", "smartlist_add", "TO_DIR_CONN", "smartlist_new"]}, {"name": "connection_stop_writing", "calls": ["connection_stop_reading_from_linked_conn", "tor_assertion_failed_", "log_fn_"]}, {"name": "dirserv_get_routerdesc_fingerprints", "calls": ["router_get_my_routerinfo", "get_signed_descriptor_by_fp", "extrainfo_get_by_descriptor_digest", "router_get_by_descriptor_digest", "router_get_routerlist", "smartlist_add", "tor_memdup_", "dir_split_resource_into_fingerprints", "smartlist_del", "strcmpstart"]}, {"name": "get_circuit_build_times_mutable", "calls": []}, {"name": "circuit_build_times_network_check_changed", "calls": ["circuit_build_times_get_initial_timeout", "cbt_control_event_buildtimeout_set", "circuit_build_times_reset", "tor_lround", "circuit_build_times_max_timeouts", "log_fn_"]}, {"name": "connection_or_block_renegotiation", "calls": ["tor_tls_set_renegotiate_callback", "tor_tls_block_renegotiation"]}, {"name": "policy_map_HT_INIT", "calls": []}, {"name": "check_authority_cert_callback", "calls": ["v3_authority_check_key_expiry"]}, {"name": "get_pt_proxy_uri", "calls": ["get_options", "tor_addr_to_str", "tor_asprintf"]}, {"name": "curve25519_keypair_generate", "calls": ["curve25519_secret_key_generate", "curve25519_public_key_generate"]}, {"name": "circuit_build_times_recent_circuit_count", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "compare_orports_", "calls": ["tor_addr_compare"]}, {"name": "advertised_server_mode", "calls": []}, {"name": "dsmap_set", "calls": ["digestmap_set"]}, {"name": "warn_if_option_path_is_relative", "calls": ["path_is_relative", "make_path_absolute", "log_fn_"]}, {"name": "circuit_build_times_initial_timeout", "calls": ["get_options", "networkstatus_get_param", "circuit_build_times_min_timeout", "log_fn_"]}, {"name": "entry_guard_get_by_id_digest", "calls": ["tor_memeq"]}, {"name": "pathbias_get_notice_rate", "calls": ["networkstatus_get_param"]}, {"name": "tor_mutex_free", "calls": ["tor_mutex_uninit"]}, {"name": "esc_for_log_len", "calls": ["tor_strndup_", "esc_for_log"]}, {"name": "tor_addr_make_unspec", "calls": []}, {"name": "tor_tls_server_got_renegotiate", "calls": []}, {"name": "compute_routerstatus_consensus", "calls": ["smartlist_free", "fmt_addrport", "tor_addr_port_new", "tor_assertion_failed_", "smartlist_add", "smartlist_sort", "smartlist_sort_digests256", "smartlist_new", "tor_addr_is_null", "compare_vote_rs", "tor_memdup_", "vote_routerstatus_find_microdesc_hash", "smartlist_get_most_frequent_digest256", "log_fn_"]}, {"name": "node_set_country", "calls": ["geoip_get_country_by_addr", "tor_addr_from_ipv4n"]}, {"name": "pathbias_measure_close_rate", "calls": ["get_circuit_build_close_time_ms", "get_options", "pathbias_get_notice_rate", "hex_str", "pathbias_get_dropguards", "entry_guards_changed", "pathbias_get_extreme_rate", "pathbias_get_warn_rate", "pathbias_get_close_success_count", "pathbias_get_min_circs", "pathbias_get_use_success_count", "approx_time", "tor_lround", "log_fn_"]}, {"name": "format_networkstatus_vote", "calls": ["smartlist_free", "networkstatus_vote_free", "networkstatus_parse_vote_from_string", "router_get_dirobj_signature", "validate_recommended_package_line", "dirserv_get_flag_thresholds_line", "tor_strdup_", "smartlist_add_asprintf", "crypto_digest_smartlist", "tor_strndup_", "smartlist_join_strings", "tor_asprintf", "fmt_addr32", "tor_digest_is_zero", "smartlist_add", "tor_assertion_failed_", "note_crypto_pk_op", "make_consensus_method_list", "routerstatus_format_entry", "base16_encode", "format_iso_time", "crypto_pk_get_fingerprint", "smartlist_new", "log_fn_"]}, {"name": "periodic_event_launch", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "parse_virtual_addr_network", "calls": ["tor_addr_copy", "tor_asprintf", "tor_addr_family", "tor_addr_parse_mask_ports"]}, {"name": "systemd_watchdog_callback", "calls": []}, {"name": "log_credential_status", "calls": ["smartlist_free", "smartlist_add_asprintf", "tor_calloc_", "smartlist_join_strings", "tor_reallocarray_", "smartlist_new", "log_fn_"]}, {"name": "_cmp_long", "calls": []}, {"name": "curve25519_public_key_generate", "calls": ["curve25519_basepoint_impl"]}, {"name": "digest256map_new", "calls": ["digest256map_impl_HT_INIT", "tor_malloc_"]}, {"name": "process_map_HT_REMOVE", "calls": ["process_map_HT_FIND_P_", "process_map_entry_hash_"]}, {"name": "rep_hist_dump_stats", "calls": ["get_options", "node_get_by_id", "strlcpy", "base16_encode", "digestmap_iter_next", "rep_history_clean", "digestmap_iter_get", "get_stability", "tor_log", "tor_snprintf", "digestmap_isempty", "digestmap_iter_done", "update_or_history", "node_get_nickname", "digestmap_iter_init"]}, {"name": "got_libevent_error", "calls": ["log_fn_"]}, {"name": "extended_cell_parse", "calls": ["get_uint16", "check_extended_cell"]}, {"name": "choose_random_entry", "calls": ["choose_random_entry_impl"]}, {"name": "channel_is_client", "calls": ["tor_assertion_failed_"]}, {"name": "consensus_method_is_supported", "calls": []}, {"name": "crypto_digest_dup", "calls": ["tor_memdup_", "crypto_digest_alloc_bytes", "tor_assertion_failed_"]}, {"name": "geoip_change_dirreq_state", "calls": ["get_options", "tor_gettimeofday", "dirreq_map_get_"]}, {"name": "workerthread_new", "calls": ["spawn_func", "tor_malloc_zero_", "log_fn_"]}, {"name": "onion_append_to_cpath", "calls": []}, {"name": "networkstatus_note_certs_arrived", "calls": ["networkstatus_get_flavor_name", "networkstatus_set_current_consensus", "networkstatus_check_consensus_signature"]}, {"name": "ntor_key_map_free", "calls": []}, {"name": "routerset_new", "calls": ["strmap_new", "tor_malloc_zero_", "digestmap_new", "smartlist_new"]}, {"name": "node_is_usable", "calls": []}, {"name": "guardfraction_file_parse_inputs_line", "calls": ["smartlist_free", "smartlist_split_string", "tor_assertion_failed_", "tor_asprintf", "smartlist_new", "tor_parse_long"]}, {"name": "circuit_build_times_timeout_rate", "calls": []}, {"name": "tor_x509_cert_get_der", "calls": ["tor_assertion_failed_"]}, {"name": "strmap_iter_next_rmv", "calls": ["tor_assertion_failed_", "strmap_entry_free", "strmap_impl_HT_NEXT_RMV"]}, {"name": "extend_cell_parse", "calls": ["get_uint32", "get_uint16", "tor_addr_make_unspec", "parse_create2_payload", "tor_addr_from_ipv4n", "check_extend_cell", "tor_addr_from_ipv6_bytes", "tor_memeq"]}, {"name": "bandwidth_weight_rule_to_string", "calls": []}, {"name": "connection_ext_or_auth_process_inbuf", "calls": ["connection_ext_or_auth_neg_auth_type", "connection_ext_or_auth_handle_client_nonce", "connection_ext_or_auth_handle_client_hash", "log_fn_"]}, {"name": "circuit_free_cpath_node", "calls": ["onion_handshake_state_release", "crypto_cipher_free", "extend_info_free", "crypto_digest_free", "memwipe", "crypto_dh_free"]}, {"name": "init_connection_lists", "calls": ["smartlist_new"]}, {"name": "packed_cell_mem_cost", "calls": []}, {"name": "dirserv_get_status_impl", "calls": ["authdir_policy_permits_address", "authdir_policy_badexit_address", "digestmap_size", "authdir_config_new", "digestmap_get", "strmap_size", "authdir_policy_valid_address", "tor_version_as_new_as", "fmt_addr32", "log_fn_"]}, {"name": "microdesc_map_HT_INSERT", "calls": ["microdesc_hash_", "microdesc_map_HT_GROW"]}, {"name": "num_ntors_per_tap", "calls": ["networkstatus_get_param"]}, {"name": "control_event_hs_descriptor_received", "calls": ["control_event_hs_descriptor_receive_end", "log_fn_"]}, {"name": "replaycache_add_and_test", "calls": ["replaycache_add_and_test_internal"]}, {"name": "strmap_iter_init", "calls": ["strmap_impl_HT_START", "tor_assertion_failed_"]}, {"name": "chan_circid_map_HT_INSERT", "calls": ["chan_circid_entry_hash_", "chan_circid_map_HT_GROW"]}, {"name": "dns_servers_relaunch_checks", "calls": ["get_options", "dns_reset_correctness_checks", "tor_assertion_failed_", "server_mode", "periodic_event_reschedule"]}, {"name": "crypto_dh_get_public", "calls": ["tor_assertion_failed_", "crypto_dh_generate_public", "log_fn_"]}, {"name": "curve25519_basepoint_spot_check", "calls": ["curve25519_basepoint_impl"]}, {"name": "threadpool_new", "calls": ["tor_mutex_init_nonrecursive", "tor_mutex_uninit", "tor_cond_init", "tor_malloc_zero_", "tor_cond_uninit"]}, {"name": "routerset_is_list", "calls": []}, {"name": "channel_mark_incoming", "calls": ["tor_assertion_failed_"]}, {"name": "replyqueue_new", "calls": ["tor_malloc_zero_", "alert_sockets_create", "tor_mutex_init"]}, {"name": "config_parse_units", "calls": ["tor_parse_double", "tor_assertion_failed_", "tor_parse_uint64", "eat_whitespace", "log_fn_"]}, {"name": "circuit_free", "calls": ["get_options", "rend_data_free", "circuit_set_n_circid_chan", "crypto_cipher_free", "circuit_clear_rend_token", "crypto_pk_free", "smartlist_del", "rep_hist_buffer_stats_add_circ", "cpath_ref_decref", "extend_info_free", "circuit_set_p_circid_chan", "circuit_clear_cpath", "cell_queue_clear", "tor_assertion_failed_", "crypto_digest_free", "circuit_free_cpath_node", "TO_ORIGIN_CIRCUIT", "TO_OR_CIRCUIT", "memwipe", "addr_policy_list_free"]}, {"name": "sb_fcntl64", "calls": []}, {"name": "connection_stop_reading_from_linked_conn", "calls": ["smartlist_contains", "tor_assertion_failed_", "smartlist_remove"]}, {"name": "bidimap_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "control_event_hs_descriptor_content", "calls": ["write_escaped_data", "node_describe_longname_by_id", "send_control_event", "rend_hsaddress_str_or_unknown", "log_fn_"]}, {"name": "rep_hist_note_dir_bytes_written", "calls": ["add_obs"]}, {"name": "tv_udiff", "calls": ["log_fn_"]}, {"name": "workqueue_entry_cancel", "calls": ["tor_mutex_release", "workqueue_entry_free", "tor_mutex_acquire"]}, {"name": "channel_idmap_eq", "calls": ["tor_memeq"]}, {"name": "check_expired_networkstatus_callback", "calls": ["router_have_minimum_dir_info", "router_dir_info_changed", "networkstatus_get_latest_consensus"]}, {"name": "notify_control_networkstatus_changed", "calls": ["control_event_is_interesting", "smartlist_add", "smartlist_free", "tor_memcmp", "routerstatus_has_changed", "control_event_newconsensus", "control_event_networkstatus_changed", "smartlist_new"]}, {"name": "geoip_get_country_name", "calls": []}, {"name": "compare_routerinfo_by_ip_and_bw_", "calls": ["dirserv_get_bandwidth_for_router_kb", "node_get_by_id", "router_digest_is_trusted_dir_type"]}, {"name": "channel_count_xmitted", "calls": ["tor_assertion_failed_"]}, {"name": "strmap_set_lc", "calls": ["strmap_set", "tor_strdup_", "tor_strlower"]}, {"name": "global_write_bucket_low", "calls": ["get_options", "connection_is_rate_limited", "authdir_mode"]}, {"name": "router_get_my_routerinfo", "calls": ["get_options", "router_rebuild_descriptor", "server_mode"]}, {"name": "validate_dir_servers", "calls": ["parse_dir_authority_line", "parse_dir_fallback_line", "config_lines_eq", "log_fn_"]}, {"name": "pathbias_get_dropguards", "calls": ["networkstatus_get_param"]}, {"name": "connection_ap_handshake_socks_resolved", "calls": ["client_dns_set_addressmap", "get_uint32", "tell_controller_about_resolved_result", "dnsserv_resolved", "client_dns_set_reverse_addressmap", "connection_ap_handshake_socks_reply", "tor_strndup_", "set_uint16", "tor_addr_from_ipv4n", "tor_addr_from_ipv6_bytes", "tor_addr_is_null"]}, {"name": "transport_is_needed", "calls": []}, {"name": "tor_get_avail_disk_space", "calls": []}, {"name": "handle_control_postdescriptor", "calls": ["router_load_single_router", "router_purpose_from_string", "smartlist_split_string", "strcasecmpstart", "tor_assertion_failed_", "smartlist_free", "tor_memdup_nulterm_", "read_escaped_data", "send_control_done", "connection_printf_to_buf", "smartlist_new"]}, {"name": "get_interface_addresses_ifaddrs", "calls": ["ifaddrs_to_smartlist", "log_fn_"]}, {"name": "create_cell_init", "calls": []}, {"name": "tor_tls_log_one_error", "calls": ["tor_log"]}, {"name": "smartlist_add", "calls": ["smartlist_ensure_capacity"]}, {"name": "tor_inet_aton", "calls": ["tor_sscanf"]}, {"name": "rend_service_validate_intro_late", "calls": ["tor_strdup_", "tor_asprintf"]}, {"name": "router_has_addr", "calls": ["tor_addr_compare", "tor_addr_eq_ipv4h"]}, {"name": "networkstatus_consensus_is_boostrapping", "calls": ["networkstatus_get_reasonably_live_consensus", "usable_consensus_flavor"]}, {"name": "fallback_dir_server_new", "calls": ["dir_server_new"]}, {"name": "socket_accounting_lock", "calls": ["tor_mutex_new", "tor_mutex_acquire"]}, {"name": "connection_dir_download_cert_failed", "calls": ["smartlist_free", "tor_assertion_failed_", "dir_split_resource_into_fingerprint_pairs", "dir_split_resource_into_fingerprints", "authority_cert_dl_failed", "update_certificate_downloads", "strcmpstart", "smartlist_new", "log_fn_"]}, {"name": "tor_terminate_process", "calls": []}, {"name": "always_accept_verify_cb", "calls": []}, {"name": "tor_cond_signal_all", "calls": []}, {"name": "list_pending_downloads", "calls": ["smartlist_free", "get_connection_array", "TO_DIR_CONN", "tor_assertion_failed_", "dir_split_resource_into_fingerprints", "digestmap_set", "strcmpstart", "smartlist_new", "digest256map_set"]}, {"name": "networkstatus_consensus_download_failed", "calls": ["get_options", "dir_server_mode", "update_consensus_networkstatus_downloads", "tor_assertion_failed_", "download_status_increment_failure", "networkstatus_parse_flavor_name"]}, {"name": "geoip_reset_dirreq_stats", "calls": ["clientmap_entry_free", "clientmap_HT_START", "clientmap_HT_NEXT_RMV", "dirreqmap_HT_START", "dirreqmap_HT_NEXT_RMV", "clientmap_HT_NEXT"]}, {"name": "free_cached_dir_", "calls": ["cached_dir_decref"]}, {"name": "extend_info_from_node", "calls": ["node_get_pref_orport", "log_fn_", "fmt_addrport", "node_get_prim_orport", "extend_info_new"]}, {"name": "find_nth_uint32", "calls": ["tor_assertion_failed_"]}, {"name": "choose_random_entry_impl", "calls": ["get_options", "populate_live_entry_guards", "smartlist_clear", "add_an_entry_guard", "entry_guards_changed", "smartlist_free", "pick_entry_guards", "entry_guards_set_from_config", "decide_num_guards", "smartlist_choose", "build_state_get_exit_node", "entry_list_is_constrained", "node_sl_choose_by_bandwidth", "smartlist_new"]}, {"name": "chunk_new_with_alloc_size", "calls": ["tor_malloc_"]}, {"name": "compare_digest_to_routerstatus_entry", "calls": ["tor_memcmp"]}, {"name": "control_event_is_interesting", "calls": []}, {"name": "crypto_pk_get_evp_pkey_", "calls": ["tor_assertion_failed_"]}, {"name": "tor_sockaddr_to_str", "calls": ["tor_addr_from_sockaddr", "tor_asprintf", "tor_addr_to_str", "tor_strdup_"]}, {"name": "tor_make_rsa_ed25519_crosscert", "calls": ["crypto_pk_keysize", "crypto_pk_private_sign", "tor_malloc_zero_", "tor_assertion_failed_"]}, {"name": "connection_dirserv_add_microdescs_to_outbuf", "calls": ["smartlist_free", "smartlist_pop_last", "microdesc_cache_lookup_by_digest256", "get_microdesc_cache", "connection_write_to_buf", "connection_get_outbuf_len", "connection_write_to_buf_zlib", "tor_zlib_free"]}, {"name": "string_is_key_value", "calls": ["tor_log", "tor_assertion_failed_", "escaped"]}, {"name": "connection_bucket_round_robin", "calls": []}, {"name": "rend_service_dump_stats", "calls": ["find_intro_circuit", "tor_log", "circuit_state_to_string", "safe_str_client"]}, {"name": "rend_service_get_by_service_id", "calls": ["tor_assertion_failed_", "tor_memeq"]}, {"name": "digest256_from_base64", "calls": ["base64_decode"]}, {"name": "prot_strings_helper", "calls": ["strmap_set", "strmap_get", "log_fn_"]}, {"name": "clean_caches_callback", "calls": ["rend_cache_clean", "microdesc_cache_rebuild", "rep_history_clean", "rend_cache_clean_v2_descs_as_dir"]}, {"name": "circuitmux_notify_xmit_destroy", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "config_reset_line", "calls": ["config_reset", "tor_assertion_failed_", "config_find_option"]}, {"name": "onion_next_task", "calls": ["tor_assertion_failed_", "decide_next_handshake_type", "onion_queue_entry_remove", "log_fn_"]}, {"name": "finish_daemon", "calls": ["start_daemon", "tor_open_cloexec", "log_fn_"]}, {"name": "circuit_get_streams_max_data_age", "calls": ["conn_get_buffer_age"]}, {"name": "tor_parse_long", "calls": []}, {"name": "bw_array_free", "calls": []}, {"name": "channel_listener_unregister", "calls": ["tor_assertion_failed_", "smartlist_remove"]}, {"name": "ap_stream_wants_exit_attention", "calls": ["TO_EDGE_CONN", "connection_edge_is_rendezvous_stream", "TO_ENTRY_CONN", "circuit_stream_is_being_handled"]}, {"name": "crypto_pk_num_bits", "calls": ["tor_assertion_failed_"]}, {"name": "spawn_exit", "calls": []}, {"name": "routerlist_descriptors_added", "calls": ["dirserv_single_reachability_test", "tor_assertion_failed_", "learned_bridge_descriptor", "control_event_descriptors_changed", "approx_time"]}, {"name": "compute_num_cpus", "calls": ["compute_num_cpus_impl", "tor_assertion_failed_", "log_fn_"]}, {"name": "digestmap_remove", "calls": ["digestmap_assign_tmp_key", "digestmap_entry_free", "tor_assertion_failed_", "digestmap_impl_HT_REMOVE"]}, {"name": "reschedule_directory_downloads", "calls": ["tor_assertion_failed_", "periodic_event_reschedule"]}, {"name": "smartlist_string_remove", "calls": ["tor_assertion_failed_"]}, {"name": "refresh_all_country_info", "calls": ["get_options", "nodelist_refresh_countries", "routerset_refresh_countries"]}, {"name": "tor_addr_is_v4", "calls": ["tor_assertion_failed_", "tor_addr_family", "tor_addr_to_in6"]}, {"name": "rep_hist_hs_stats_init", "calls": ["hs_stats_new"]}, {"name": "config_lines_dup", "calls": ["tor_malloc_zero_", "tor_strdup_"]}, {"name": "send_resolved_hostname_cell", "calls": ["connection_edge_send_command", "tor_assertion_failed_", "set_uint32", "dns_clip_ttl"]}, {"name": "options_init_from_torrc", "calls": ["get_options", "config_line_find", "tor_libevent_get_header_version_str", "escaped", "get_options_mutable", "load_torrc_from_stdin", "tor_strdup_", "options_init_from_string", "list_torrc_options", "config_parse_commandline", "load_torrc_from_disk", "crypto_openssl_get_version_str", "tor_libevent_get_version_str", "tor_zlib_get_header_version_str", "crypto_openssl_get_header_version_str", "tor_parse_long", "tor_zlib_get_version_str", "get_version", "print_usage", "log_fn_"]}, {"name": "pt_stringify_socks_args", "calls": ["smartlist_free", "smartlist_add", "tor_assertion_failed_", "smartlist_join_strings", "tor_escape_str_for_pt_args", "smartlist_new"]}, {"name": "tor_zlib_get_total_allocation", "calls": []}, {"name": "routerset_parse", "calls": ["is_legal_hexdigest", "smartlist_split_string", "router_parse_addr_policy_item_from_string", "routerset_get_countryname", "policy_expand_unspec", "smartlist_add", "routerset_refresh_countries", "smartlist_new", "strmap_set_lc", "is_legal_nickname", "smartlist_add_all", "digestmap_set", "smartlist_del", "base16_decode", "smartlist_free", "log_fn_"]}, {"name": "find_all_exitpolicy", "calls": ["smartlist_add", "smartlist_new"]}, {"name": "tor_inet_ntoa", "calls": ["tor_snprintf"]}, {"name": "tor_libevent_initialize", "calls": ["tor_assertion_failed_", "tor_libevent_get_method", "log_fn_"]}, {"name": "networkstatus_get_router_digest_by_nickname", "calls": ["strmap_get_lc"]}, {"name": "router_get_advertised_or_port_by_af", "calls": ["router_get_active_listener_port_by_type_af", "get_first_advertised_port_by_type_af"]}, {"name": "scan_signed", "calls": ["scan_unsigned"]}, {"name": "circuit_about_to_free", "calls": ["circuit_clear_cell_queue", "circuit_set_p_circid_chan", "safe_str_client", "smartlist_remove", "circuit_set_n_circid_chan", "rend_client_report_intro_point_failure", "channel_send_destroy", "onion_pending_remove", "channel_is_in_state", "TO_OR_CIRCUIT", "circuit_rep_hist_note_result", "connection_edge_destroy", "circuit_build_failed", "connection_mark_for_close_", "tor_assertion_failed_", "TO_ORIGIN_CIRCUIT", "control_event_circuit_status", "build_state_get_exit_nickname", "log_fn_"]}, {"name": "sdmap_set", "calls": ["digestmap_set"]}, {"name": "routerset_equal", "calls": ["tor_assertion_failed_", "routerset_is_empty"]}, {"name": "dir_split_resource_into_fingerprints", "calls": ["smartlist_free", "smartlist_uniq_digests256", "smartlist_split_string", "smartlist_del_keeporder", "smartlist_sort_strings", "smartlist_sort_digests256", "smartlist_uniq_digests", "escaped", "tor_malloc_zero_", "base64_decode", "smartlist_add_all", "tor_assertion_failed_", "base16_decode", "smartlist_uniq_strings", "smartlist_new", "smartlist_sort_digests", "log_fn_"]}, {"name": "tor_threads_init", "calls": ["tor_assertion_failed_", "set_main_thread"]}, {"name": "channel_is_outgoing", "calls": ["tor_assertion_failed_"]}, {"name": "tor_cert_free", "calls": ["memwipe"]}, {"name": "tor_inet_ntop", "calls": ["tor_inet_ntoa", "tor_snprintf", "strlcpy"]}, {"name": "rotate_x509_certificate_callback", "calls": ["tor_assertion_failed_", "router_initialize_tls_context", "log_fn_"]}, {"name": "clientmap_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "rend_service_load_auth_keys", "calls": ["start_writing_to_stdio_file", "tor_snprintf", "read_file_to_str", "escaped", "crypto_pk_new", "crypto_pk_dup_key", "base64_encode", "crypto_pk_write_private_key_to_string", "crypto_pk_free", "strmap_size", "rend_get_service_id", "crypto_rand", "crypto_pk_check_key", "strmap_new", "crypto_pk_generate_key_with_bits", "rend_parse_client_keys", "abort_writing_to_file", "strmap_get", "memwipe", "finish_writing_to_file", "log_fn_"]}, {"name": "routerset_contains", "calls": ["strmap_get_lc", "digestmap_get", "bitarray_is_set", "geoip_get_country_by_addr", "compare_tor_addr_to_addr_policy"]}, {"name": "write_bytes_to_new_file", "calls": ["write_bytes_to_file_impl"]}, {"name": "remove_bt_handler", "calls": ["tor_mutex_uninit"]}, {"name": "check_create_cell", "calls": []}, {"name": "authdir_mode_bridge", "calls": ["authdir_mode"]}, {"name": "client_history_clear", "calls": ["clientmap_entry_free", "clientmap_HT_START", "clientmap_HT_NEXT", "clientmap_HT_NEXT_RMV"]}, {"name": "get_uname", "calls": ["strlcpy"]}, {"name": "get_master_identity_key", "calls": []}, {"name": "circuit_build_times_network_check_live", "calls": []}, {"name": "get_effective_bwrate", "calls": []}, {"name": "tor_addr_port_lookup", "calls": ["tor_addr_lookup", "tor_addr_copy", "tor_strdup_", "tor_assertion_failed_", "tor_strndup_", "eat_whitespace", "tor_parse_long"]}, {"name": "abort_writing_to_file", "calls": ["finish_writing_to_file_impl"]}, {"name": "TO_OR_CIRCUIT", "calls": ["tor_assertion_failed_"]}, {"name": "command_allowed_before_handshake", "calls": []}, {"name": "tor_parse_uint64", "calls": []}, {"name": "update_or_history", "calls": ["tor_assertion_failed_"]}, {"name": "install_syscall_filter", "calls": ["add_noparam_filter", "prot_strings", "log_fn_"]}, {"name": "assert_connection_edge_not_dns_pending", "calls": ["cache_map_HT_FIND", "tor_assertion_failed_", "strlcpy"]}, {"name": "try_load_engine", "calls": []}, {"name": "find_torrc_filename", "calls": ["tor_strdup_", "get_default_conf_file", "file_status", "make_path_absolute", "expand_filename", "log_fn_"]}, {"name": "advance_obs", "calls": ["commit_max"]}, {"name": "rend_hsdir_routers_changed", "calls": []}, {"name": "rend_encrypt_v2_intro_points_stealth", "calls": ["crypto_cipher_encrypt_with_iv", "tor_assertion_failed_", "tor_malloc_zero_", "log_fn_"]}, {"name": "directory_pick_generic_dirserver", "calls": ["get_options", "dir_conn_purpose_to_string", "should_use_directory_guards", "router_pick_directory_server", "choose_random_dirguard", "router_pick_fallback_dirserver", "log_fn_"]}, {"name": "channel_mark_outgoing", "calls": ["tor_assertion_failed_"]}, {"name": "build_socks_resolve_request", "calls": ["tor_addr_parse", "tor_assertion_failed_", "tor_addr_family", "tor_malloc_", "set_uint16", "set_uint32", "tor_addr_to_ipv4n", "tor_addr_to_in6", "log_fn_"]}, {"name": "find_nth_int32", "calls": ["tor_assertion_failed_"]}, {"name": "control_event_transport_launched", "calls": ["send_control_event", "fmt_addr_impl"]}, {"name": "rend_service_intro_has_opened", "calls": ["get_options", "rend_data_free", "crypto_pk_asn1_encode", "find_intro_point", "circuit_mark_for_close_", "count_intro_point_circuits", "crypto_pk_free", "crypto_pk_private_sign_digest", "set_uint16", "rend_intro_point_free", "rend_service_get_by_pk_digest", "circuit_change_purpose", "tor_assertion_failed_", "note_crypto_pk_op", "crypto_digest", "smartlist_remove", "base32_encode", "pathbias_count_use_attempt", "circuit_has_opened", "memwipe", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "net_is_disabled", "calls": ["get_options", "we_are_hibernating"]}, {"name": "routerset_contains_bridge", "calls": ["routerset_contains_extendinfo", "tor_assertion_failed_", "extend_info_free", "extend_info_new"]}, {"name": "pathbias_scale_close_rates", "calls": ["get_options", "pathbias_get_scale_ratio", "hex_str", "entry_guards_changed", "pathbias_get_scale_threshold", "pathbias_count_circs_in_states", "log_fn_"]}, {"name": "circuit_list_path_for_controller", "calls": ["circuit_list_path_impl"]}, {"name": "policies_exit_policy_append_reject_star", "calls": ["append_exit_policy_string"]}, {"name": "connection_buckets_decrement", "calls": ["TO_OR_CONN", "get_options", "conn_state_to_string", "connection_counts_as_relayed_traffic", "conn_type_to_string", "tor_gettimeofday_cached", "connection_buckets_note_empty_ts", "connection_is_rate_limited", "record_num_bytes_transferred_impl", "log_fn_"]}, {"name": "addressmap_have_mapping", "calls": ["strmap_get_lc"]}, {"name": "escaped", "calls": ["esc_for_log"]}, {"name": "connection_connect", "calls": ["get_options", "connection_connect_sockaddr", "tor_addr_is_null", "tor_assertion_failed_", "tor_addr_family", "tor_addr_to_sockaddr", "tor_addr_is_loopback", "fmt_addr_impl", "escaped_safe_str_client", "log_fn_"]}, {"name": "desc_get_store", "calls": []}, {"name": "router_digest_is_fallback_dir", "calls": ["router_get_fallback_dirserver_by_digest"]}, {"name": "bitarray_init_zero", "calls": ["tor_calloc_"]}, {"name": "router_compare_to_my_exit_policy", "calls": ["router_get_my_routerinfo", "tor_addr_is_null", "compare_tor_addr_to_addr_policy", "tor_addr_family"]}, {"name": "free_execve_args", "calls": ["tor_free_"]}, {"name": "onion_next_hop_in_cpath", "calls": []}, {"name": "pathbias_should_count", "calls": ["get_options", "rate_limit_log", "pathbias_state_to_string", "circuit_state_to_string", "circuit_purpose_to_string", "approx_time", "log_fn_"]}, {"name": "handle_methods_done", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "rsamap_HT_NEXT_RMV", "calls": []}, {"name": "tor_localtime_r", "calls": ["correct_tm"]}, {"name": "reschedule_descriptor_update_check", "calls": ["tor_assertion_failed_", "periodic_event_reschedule"]}, {"name": "secret_to_key_derivekey", "calls": ["secret_to_key_get_type", "secret_to_key_compute_key"]}, {"name": "keypin_ents_eq_rsa", "calls": ["tor_memeq"]}, {"name": "tor_reallocarray_", "calls": ["tor_realloc_", "tor_assertion_failed_", "size_mul_check"]}, {"name": "tor_tls_create_certificate", "calls": ["tor_x509_name_new", "tor_tls_init", "tls_log_errors", "crypto_rand_time_range", "crypto_rand", "tor_assertion_failed_", "crypto_pk_get_evp_pkey_"]}, {"name": "node_get_platform", "calls": []}, {"name": "frac_nodes_with_descriptors", "calls": ["node_has_descriptor", "compute_weighted_bandwidths"]}, {"name": "tor_tls_get_by_ssl", "calls": ["tor_assertion_failed_"]}, {"name": "msec_since_midnight", "calls": []}, {"name": "set_log_severity_config", "calls": ["tor_assertion_failed_"]}, {"name": "clear_broken_connection_map", "calls": []}, {"name": "smartlist_strings_eq", "calls": []}, {"name": "llvm.memcpy.p0i8.p0i8.i64", "calls": []}, {"name": "log_accounting", "calls": ["get_accounting_bytes", "accounting_get_end_time", "format_local_iso_time", "bytes_to_usage", "get_or_state", "secs_to_uptime", "log_fn_"]}, {"name": "router_get_dirobj_signature", "calls": ["crypto_pk_keysize", "strlcpy", "crypto_pk_private_sign", "tor_malloc_", "base64_encode", "strlcat", "log_fn_"]}, {"name": "rend_client_any_intro_points_usable", "calls": ["get_options", "extend_info_free", "rend_client_get_random_intro_impl"]}, {"name": "rep_hist_have_measured_enough_stability", "calls": []}, {"name": "get_cert_list", "calls": ["digestmap_new", "tor_malloc_zero_", "smartlist_new", "digestmap_get", "digestmap_set", "dsmap_new"]}, {"name": "rep_hist_get_stability", "calls": ["get_stability", "get_or_history"]}, {"name": "dns_found_answer", "calls": ["make_pending_resolve_cached", "strlcpy", "tor_assertion_failed_", "cache_map_HT_FIND", "log_fn_", "assert_resolve_ok", "inform_pending_connections", "escaped_safe_str", "cached_resolve_have_all_answers", "is_test_address", "cached_resolve_add_answer"]}, {"name": "channel_get_cell_queue_entry_size", "calls": ["get_cell_network_size", "tor_assertion_failed_", "get_var_cell_header_size"]}, {"name": "authdir_mode_v3", "calls": ["authdir_mode"]}, {"name": "channel_listener_close_for_error", "calls": ["channel_listener_change_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "channel_idmap_HT_CLEAR", "calls": ["tor_free_", "channel_idmap_HT_INIT"]}, {"name": "bidimap_HT_FIND_P_", "calls": ["bidi_map_ent_eq"]}, {"name": "node_get_published_on", "calls": []}, {"name": "rep_hist_desc_stats_init", "calls": ["digestmap_new", "log_fn_"]}, {"name": "warn_nonlocal_ext_orports", "calls": ["tor_addr_is_internal_", "fmt_addrport", "log_fn_"]}, {"name": "chunk_repack", "calls": []}, {"name": "conns_compare_by_buffer_age_", "calls": ["conn_get_buffer_age"]}, {"name": "log_failed_proxy_connection", "calls": ["proxy_type_to_string", "fmt_addrport", "get_proxy_addrport", "log_fn_"]}, {"name": "circuits_can_use_ntor", "calls": ["get_options", "networkstatus_get_param"]}, {"name": "connection_or_get_by_ext_or_id", "calls": ["digestmap_get"]}, {"name": "warn_if_last_router_excluded", "calls": ["get_options", "extend_info_describe", "routerset_contains_extendinfo", "circuit_log_path", "circuit_purpose_to_string", "log_fn_"]}, {"name": "pathbias_state_to_string", "calls": []}, {"name": "list_single_server_status", "calls": ["strlcpy", "base16_encode", "tor_strdup_", "tor_assertion_failed_", "node_get_by_id"]}, {"name": "rsamap_HT_INIT", "calls": []}, {"name": "strmap_set", "calls": ["strmap_assign_tmp_key", "tor_assertion_failed_", "strmap_entry_hash", "strmap_impl_HT_FIND_P_", "tor_malloc_zero_", "strmap_assign_key", "strmap_impl_HT_GROW"]}, {"name": "digestmap_impl_HT_NEXT_RMV", "calls": []}, {"name": "policy_map_HT_REMOVE", "calls": ["policy_map_HT_FIND_P_", "policy_hash"]}, {"name": "tor_memstr", "calls": ["tor_memmem"]}, {"name": "channel_write_cell", "calls": ["channel_is_in_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "compute_frac_paths_available", "calls": ["smartlist_free", "frac_nodes_with_descriptors", "smartlist_add", "count_usable_descriptors", "node_exit_policy_rejects_all", "authdir_mode_v3", "smartlist_del", "node_has_descriptor", "router_have_consensus_path", "tor_asprintf", "smartlist_new", "log_fn_"]}, {"name": "crypto_init_siphash_key", "calls": ["crypto_rand"]}, {"name": "rend_cache_failure_entry_new", "calls": ["tor_malloc_", "digestmap_new"]}, {"name": "smartlist_pos", "calls": []}, {"name": "detect_compression_method", "calls": ["get_uint16"]}, {"name": "circuit_send_next_onion_skin", "calls": ["get_options", "circuit_build_times_network_check_live", "circuit_build_times_disabled", "tor_addr_make_unspec", "circuit_rep_hist_note_result", "onion_next_hop_in_cpath", "get_circuit_build_times_mutable", "control_event_bootstrap", "circuit_mark_for_close_", "circuit_pick_extend_handshake", "inform_testing_reachability", "get_circuit_build_close_time_ms", "control_event_client_status", "pathbias_count_build_success", "circuit_deliver_create_cell", "check_whether_orport_reachable", "circuit_build_times_network_circ_success", "circuit_purpose_to_string", "tv_mdiff", "circuit_reset_failure_count", "onion_skin_create", "clear_broken_connection_map", "node_describe", "tor_assertion_failed_", "circuit_timeout_want_to_count_circ", "tor_addr_family", "tor_gettimeofday", "consider_testing_reachability", "extend_cell_format", "node_get_by_id", "have_completed_a_circuit", "should_use_create_fast_for_circuit", "relay_send_command_from_edge_", "note_request", "server_mode", "get_circuit_build_times", "circuit_has_opened", "tor_addr_copy", "circuit_build_times_add_time", "circuit_build_times_set_timeout", "log_fn_", "note_that_we_completed_a_circuit", "circuit_pick_create_handshake", "circuit_set_state"]}, {"name": "directory_send_command", "calls": ["get_options", "smartlist_free", "strlcpy", "format_rfc1123_time", "tor_assertion_failed_", "tor_strdup_", "router_get_descriptor_gen_reason", "directory_get_consensus_url", "smartlist_add_asprintf", "connection_write_to_buf", "alloc_http_authenticator", "smartlist_join_strings", "tor_snprintf", "tor_asprintf", "smartlist_new", "log_fn_"]}, {"name": "control_event_circuit_status_minor", "calls": ["circuit_purpose_to_controller_string", "tor_snprintf", "tor_assertion_failed_", "format_iso_time_nospace_usec", "circuit_purpose_to_controller_hs_state_string", "send_control_event", "circuit_describe_status_for_controller", "log_fn_"]}, {"name": "channel_tls_process_certs_cell", "calls": ["get_options", "connection_or_send_netinfo", "tor_x509_cert_decode", "router_digest_is_trusted_dir_type", "channel_tls_to_base", "tor_tls_cert_is_valid", "crypto_pk_free", "safe_str", "connection_or_client_learned_peer_id", "tor_assertion_failed_", "channel_set_circid_type", "tor_x509_cert_get_id_digests", "tor_x509_cert_free", "public_server_mode", "tor_tls_cert_get_key", "connection_or_close_for_error", "tor_tls_cert_matches_key", "log_fn_"]}, {"name": "tor_log_get_sigsafe_err_fds", "calls": []}, {"name": "fetch_v2_desc_by_addr", "calls": ["tor_assertion_failed_", "purge_hid_serv_from_last_hid_serv_requests", "memwipe", "rend_compute_v2_desc_id", "tor_memcmp", "fetch_v2_desc_by_descid", "crypto_rand_int", "log_fn_"]}, {"name": "activate_signal", "calls": []}, {"name": "handle_control_hspost", "calls": ["rend_parse_v2_service_descriptor", "smartlist_free", "rend_encoded_v2_service_descriptor_free", "rend_service_descriptor_free", "node_get_by_hex_id", "smartlist_add", "tor_strndup_", "tor_malloc_zero_", "strcasecmpstart", "read_escaped_data", "send_control_done", "directory_post_to_hs_dir", "rend_get_service_id", "connection_printf_to_buf", "smartlist_split_string", "smartlist_new"]}, {"name": "tor_threadlocal_destroy", "calls": []}, {"name": "handle_control_authchallenge", "calls": ["crypto_rand", "base16_encode", "strcasecmpstart", "tor_assertion_failed_", "crypto_hmac_sha256", "decode_escaped_string", "tor_malloc_zero_", "connection_write_str_to_buf", "connection_mark_for_close_", "connection_printf_to_buf", "base16_decode"]}, {"name": "tor_strupper", "calls": []}, {"name": "control_event_stream_bandwidth_used", "calls": ["get_connection_array", "TO_EDGE_CONN", "send_control_event"]}, {"name": "dirvote_add_signatures", "calls": ["tor_strdup_", "smartlist_add", "smartlist_new", "dirvote_add_signatures_to_all_pending_consensuses", "log_fn_"]}, {"name": "crypto_digest256_new", "calls": ["tor_assertion_failed_", "crypto_digest_alloc_bytes", "tor_malloc_"]}, {"name": "routerinfo_incompatible_with_extrainfo", "calls": ["tor_assertion_failed_", "tor_mem_is_zero", "crypto_pk_public_checksig", "tor_cert_opt_eq", "tor_memeq"]}, {"name": "bidimap_HT_INSERT", "calls": ["bidimap_HT_GROW", "bidi_map_ent_hash"]}, {"name": "connection_add_impl", "calls": ["conn_type_to_string", "smartlist_add", "tor_assertion_failed_", "tor_libevent_get_base", "TO_EDGE_CONN", "log_fn_"]}, {"name": "tor_tls_block_renegotiation", "calls": []}, {"name": "router_append_dirobj_signature", "calls": ["router_get_dirobj_signature", "log_fn_"]}, {"name": "rep_hist_buffer_stats_write", "calls": ["circuit_get_global_list", "rep_hist_format_buffer_stats", "check_or_create_data_subdir", "rep_hist_reset_buffer_stats", "write_to_data_subdir", "rep_hist_buffer_stats_add_circ"]}, {"name": "parse_socks4a_resolve_response", "calls": ["get_uint32", "strcasecmpend", "onion_warning", "get_uint16", "tor_assertion_failed_", "tor_addr_from_ipv4n", "log_fn_"]}, {"name": "policies_copy_outbound_addresses_to_smartlist", "calls": ["policies_copy_addr_to_smartlist"]}, {"name": "dirserv_free_all", "calls": ["dirserv_clear_measured_bw_cache", "dirserv_free_fingerprint_list"]}, {"name": "connection_dir_request_failed", "calls": ["get_options", "directory_conn_is_self_reachability_test", "connection_dir_download_cert_failed", "connection_dir_bridge_routerdesc_failed", "networkstatus_consensus_download_failed", "router_set_status", "entry_list_is_constrained", "log_fn_", "connection_dir_download_routerdesc_failed"]}, {"name": "node_is_named", "calls": ["node_get_nickname", "networkstatus_get_router_digest_by_nickname", "tor_memeq"]}, {"name": "crypto_pk_asn1_decode", "calls": ["tor_malloc_", "crypto_log_errors", "crypto_new_pk_from_rsa_"]}, {"name": "smartlist_shuffle", "calls": ["smartlist_swap", "crypto_rand_int"]}, {"name": "tor_mutex_uninit", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "node_get_verbose_nickname_by_id", "calls": ["node_get_by_id", "node_get_verbose_nickname", "base16_encode"]}, {"name": "handle_control_closestream", "calls": ["get_stream", "smartlist_free", "send_control_done", "tor_parse_ulong", "getargs_helper", "connection_printf_to_buf", "connection_mark_unattached_ap_"]}, {"name": "free_or_history", "calls": []}, {"name": "get_dir_info_status_string", "calls": []}, {"name": "pt_kickstart_proxy", "calls": ["transport_get_by_name", "managed_proxy_create", "get_managed_proxy_by_argv_and_type", "add_transport_to_proxy", "free_execve_args"]}, {"name": "get_microdesc_cache_noload", "calls": ["get_options", "tor_malloc_zero_", "microdesc_map_HT_INIT", "options_get_datadir_fname2_suffix"]}, {"name": "sdmap_to_digestmap", "calls": []}, {"name": "keypin_ents_eq_ed", "calls": ["tor_memeq"]}, {"name": "router_get_advertised_bandwidth_capped", "calls": []}, {"name": "tor_mutex_new", "calls": ["tor_malloc_zero_", "tor_mutex_init"]}, {"name": "secret_to_key_spec_len", "calls": []}, {"name": "rep_hist_note_circuit_handshake_requested", "calls": []}, {"name": "cpuworker_log_onionskin_overhead", "calls": ["get_overhead_for_onionskins", "log_fn_"]}, {"name": "client_dns_clear_failures", "calls": ["strmap_get"]}, {"name": "register_client_proxy", "calls": ["tor_assertion_failed_", "transport_copy", "control_event_transport_launched", "transport_add", "transport_free", "log_fn_"]}, {"name": "policies_parse_exit_policy_internal", "calls": ["append_exit_policy_string", "policies_log_first_redundant_entry", "parse_addr_policy", "exit_policy_remove_redundancies", "policies_parse_exit_policy_reject_private"]}, {"name": "dns_randfn_", "calls": ["crypto_rand"]}, {"name": "networkstatus_get_weight_scale_param", "calls": ["networkstatus_get_param"]}, {"name": "add_laplace_noise", "calls": ["sample_laplace_distribution", "tor_assertion_failed_"]}, {"name": "tokenize_string", "calls": ["eat_whitespace_eos", "smartlist_add", "tor_assertion_failed_", "token_clear", "get_next_token", "log_fn_"]}, {"name": "routerset_contains_extendinfo", "calls": ["routerset_contains"]}, {"name": "dirserv_get_bandwidth_for_router_kb", "calls": ["dirserv_query_measured_bw_cache_kb", "router_get_advertised_bandwidth"]}, {"name": "node_has_curve25519_onion_key", "calls": []}, {"name": "policy_summary_create", "calls": ["smartlist_add", "tor_malloc_zero_", "smartlist_new"]}, {"name": "circuit_build_times_set_timeout", "calls": ["circuit_build_times_initial_timeout", "cbt_control_event_buildtimeout_set", "circuit_build_times_min_timeout", "tor_lround", "circuit_build_times_disabled", "circuit_build_times_timeout_rate", "circuit_build_times_set_timeout_worker", "log_fn_"]}, {"name": "secret_to_key_check", "calls": ["secret_to_key_compute_key", "secret_to_key_key_len", "secret_to_key_get_type", "tor_assertion_failed_", "memwipe", "secret_to_key_spec_len", "tor_memeq"]}, {"name": "compute_desc_id", "calls": ["tor_assertion_failed_", "rend_compute_v2_desc_id"]}, {"name": "routerlist_reparse_old", "calls": ["router_parse_entry_from_string", "signed_descriptor_get_annotations", "routerlist_remove_old"]}, {"name": "tor_tls_set_logged_address", "calls": ["tor_strdup_", "tor_assertion_failed_"]}, {"name": "nodes_in_same_family", "calls": ["get_options", "node_in_nickname_smartlist", "routerset_contains_node", "addrs_in_same_network_family", "node_get_declared_family", "node_get_addr"]}, {"name": "flush_chunk_tls", "calls": ["buf_remove_from_front", "tor_assertion_failed_", "tor_tls_get_forced_write_size", "tor_tls_write", "log_fn_"]}, {"name": "parse_log_domain", "calls": []}, {"name": "circuitmux_find_map_entry", "calls": ["tor_assertion_failed_", "chanid_circid_muxinfo_map_HT_FIND", "TO_OR_CIRCUIT"]}, {"name": "double_digest_map_HT_FIND_P_", "calls": ["ddmap_entry_eq"]}, {"name": "sb__sysctl", "calls": ["log_fn_"]}, {"name": "fp_pair_map_set", "calls": ["fp_pair_map_impl_HT_FIND", "tor_assertion_failed_", "tor_malloc_zero_", "fp_pair_map_impl_HT_INSERT"]}, {"name": "onion_append_hop", "calls": ["onion_append_to_cpath", "tor_malloc_zero_", "extend_info_dup", "circuit_initial_package_window"]}, {"name": "connection_unregister_events", "calls": ["dnsserv_close_listener", "log_fn_"]}, {"name": "strmap_iter_done", "calls": []}, {"name": "get_string_from_pipe", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "parse_http_time", "calls": ["tor_assertion_failed_", "tor_sscanf"]}, {"name": "cell_queue_entry_dup", "calls": ["tor_malloc_", "tor_assertion_failed_"]}, {"name": "TO_EWMA_POL_CIRC_DATA", "calls": ["tor_assertion_failed_"]}, {"name": "policy_summary_split", "calls": ["smartlist_insert", "policy_summary_item_split"]}, {"name": "sb_openat", "calls": ["log_fn_"]}, {"name": "tor_strdup_", "calls": ["tor_assertion_failed_", "log_fn_"]}, {"name": "create_managed_proxy_environment", "calls": ["get_options", "smartlist_free", "get_bindaddr_for_server_proxy", "tor_strdup_", "smartlist_add", "smartlist_add_asprintf", "get_current_process_environment_variables", "process_environment_make", "get_ext_or_auth_cookie_file_name", "get_first_listener_addrport_string", "options_get_datadir_fname2_suffix", "smartlist_join_strings", "get_transport_options_for_server_proxy", "smartlist_new"]}, {"name": "geoip_add_entry", "calls": ["tor_addr_compare", "strlcpy", "smartlist_add", "tor_assertion_failed_", "tor_addr_family", "strmap_set_lc", "strmap_get_lc", "tor_addr_to_ipv4h", "tor_strlower", "tor_malloc_zero_", "tor_addr_to_in6"]}, {"name": "handle_control_dropguards", "calls": ["remove_all_entry_guards", "smartlist_free", "smartlist_split_string", "send_control_done", "connection_printf_to_buf", "smartlist_new"]}, {"name": "intro_point_accepted_intro_count", "calls": []}, {"name": "tor_get_thread_id", "calls": []}, {"name": "proxy_mode", "calls": ["get_configured_ports"]}, {"name": "dump_distinct_digest_count", "calls": []}, {"name": "curve25519_public_from_base64", "calls": ["base64_decode", "digest256_from_base64"]}, {"name": "edmap_HT_CLEAR", "calls": ["tor_free_", "edmap_HT_INIT"]}, {"name": "handle_control_add_onion", "calls": ["smartlist_free", "smartlist_split_string", "tor_assertion_failed_", "rend_service_port_config_free", "rend_service_parse_port_config", "strcasecmpstart", "smartlist_new", "escaped", "memwipe", "getargs_helper", "add_onion_helper_keyarg", "connection_printf_to_buf", "tor_asprintf", "rend_service_add_ephemeral", "smartlist_add", "tor_parse_long", "connection_write_str_to_buf"]}, {"name": "CONST_TO_ORIGIN_CIRCUIT", "calls": ["tor_assertion_failed_"]}, {"name": "router_free_all", "calls": ["smartlist_free", "crypto_pk_free", "extrainfo_free", "authority_cert_free", "memwipe", "routerinfo_free", "tor_mutex_free"]}, {"name": "create_cell_format", "calls": ["create_cell_format_impl"]}, {"name": "handle_control_resolve", "calls": ["smartlist_free", "find_element_starting_with", "dnsserv_launch_request", "smartlist_add", "send_control_done", "is_keyval_pair", "control_event_address_mapped", "smartlist_split_string", "smartlist_new", "log_fn_"]}, {"name": "load_identity_key", "calls": ["crypto_log_errors", "abort_writing_to_file", "file_status", "start_writing_to_stdio_file", "generate_key", "finish_writing_to_file", "log_fn_"]}, {"name": "scheduler_channel_doesnt_want_writes", "calls": ["smartlist_pqueue_remove", "tor_assertion_failed_", "log_fn_"]}, {"name": "memarea_clear", "calls": ["chunk_free_unchecked"]}, {"name": "onion_skin_ntor_client_handshake", "calls": ["tor_assertion_failed_", "safe_mem_is_zero", "memwipe", "h_tweak", "crypto_expand_key_material_rfc5869_sha256", "curve25519_handshake", "tor_memeq", "log_fn_"]}, {"name": "ddmap_entry_new", "calls": ["tor_malloc_zero_"]}, {"name": "keypin_add_or_replace_entry_in_map", "calls": ["edmap_HT_FIND", "keypin_add_entry_to_map", "tor_assertion_failed_", "edmap_HT_REMOVE", "rsamap_HT_REMOVE", "rsamap_HT_FIND"]}, {"name": "smartlist_clear", "calls": []}, {"name": "addressmap_rewrite_reverse", "calls": ["strlcpy", "tor_addr_parse", "tor_strdup_", "strmap_get", "tor_asprintf", "escaped_safe_str_client", "log_fn_"]}, {"name": "update_consensus_networkstatus_fetch_time", "calls": ["get_options", "we_want_to_fetch_flavor", "update_consensus_networkstatus_fetch_time_impl"]}, {"name": "get_digest", "calls": ["crypto_pk_get_digest", "crypto_new_pk_from_rsa_", "crypto_pk_free"]}, {"name": "microdesc_map_HT_FIND", "calls": ["microdesc_hash_", "microdesc_map_HT_FIND_P_"]}, {"name": "keypin_ent_hash_rsa", "calls": []}, {"name": "crypto_digest_new", "calls": ["crypto_digest_alloc_bytes", "tor_malloc_"]}, {"name": "config_parse_memunit", "calls": ["config_parse_units"]}, {"name": "build_state_get_exit_node", "calls": ["node_get_by_id"]}, {"name": "tor_strisnonupper", "calls": ["TOR_ISUPPER"]}, {"name": "connection_or_client_used", "calls": ["channel_tls_to_base", "tor_assertion_failed_", "channel_when_last_client"]}, {"name": "fetch_v2_desc_by_descid", "calls": ["directory_get_from_hs_dir", "tor_assertion_failed_"]}, {"name": "router_addr_is_trusted_dir", "calls": []}, {"name": "scheduler_channel_wants_writes", "calls": ["tor_assertion_failed_", "scheduler_retrigger", "log_fn_"]}, {"name": "consider_publishable_server", "calls": ["get_options", "server_mode", "router_upload_dir_desc_to_dirservers", "set_server_advertised", "decide_if_publishable_server", "router_rebuild_descriptor"]}, {"name": "pathbias_send_usable_probe", "calls": ["crypto_rand", "tor_gettimeofday", "circuit_change_purpose", "channel_is_in_state", "tor_assertion_failed_", "tor_dup_ip", "get_unique_stream_id_by_circ", "TO_ORIGIN_CIRCUIT", "tor_snprintf", "relay_send_command_from_edge_", "log_fn_"]}, {"name": "exit_function", "calls": []}, {"name": "fast_onionskin_create", "calls": ["crypto_rand", "tor_malloc_"]}, {"name": "get_bw_samples", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_add_asprintf", "smartlist_join_strings", "smartlist_new"]}, {"name": "hostname_in_track_host_exits", "calls": ["strcasecmpend"]}, {"name": "cache_map_HT_FIND", "calls": ["cached_resolve_hash", "cache_map_HT_FIND_P_"]}, {"name": "crypto_digest_all", "calls": ["crypto_digest256", "tor_assertion_failed_", "crypto_digest512", "crypto_digest"]}, {"name": "cell_queues_check_size", "calls": ["get_options", "cell_queues_get_total_allocation", "tor_zlib_get_total_allocation", "circuits_handle_oom", "rend_cache_get_total_allocation", "buf_get_total_allocation", "approx_time", "rend_cache_clean_v2_descs_as_dir"]}, {"name": "connection_get_outbuf_len", "calls": ["buf_datalen"]}, {"name": "tor_fd_setpos", "calls": []}, {"name": "circuit_build_times_count_timeout", "calls": ["circuit_build_times_get_initial_timeout", "circuit_build_times_disabled", "circuit_build_times_network_timeout", "circuit_build_times_network_check_changed"]}, {"name": "fetch_var_cell_from_buf", "calls": ["cell_command_is_var_length", "get_uint32", "peek_from_buf", "get_uint16", "get_var_cell_header_size", "get_circ_id_size", "var_cell_new", "buf_remove_from_front"]}, {"name": "dir_policy_permits_address", "calls": ["addr_policy_permits_tor_addr"]}, {"name": "tor_version_same_series", "calls": ["tor_assertion_failed_"]}, {"name": "change_callback_log_severity", "calls": ["get_min_log_level", "tor_mutex_release", "tor_mutex_acquire", "set_log_severity_config"]}, {"name": "fp_pair_map_iter_done", "calls": []}, {"name": "crypto_pk_free", "calls": ["tor_assertion_failed_"]}, {"name": "routerset_get_countryname", "calls": ["tor_strndup_", "tor_strlower"]}, {"name": "rend_encrypt_v2_intro_points_basic", "calls": ["crypto_rand", "smartlist_free", "crypto_cipher_encrypt_with_iv", "crypto_cipher_new", "tor_assertion_failed_", "crypto_cipher_free", "crypto_cipher_encrypt", "crypto_digest_free", "smartlist_new", "tor_malloc_zero_", "crypto_digest_new", "smartlist_sort_digests", "crypto_digest_add_bytes", "smartlist_add", "crypto_digest_get_digest", "log_fn_"]}, {"name": "tor_mlockall", "calls": ["tor_set_max_memlock", "log_fn_"]}, {"name": "flush_buf_tls", "calls": ["check_no_tls_errors_", "tor_assertion_failed_", "flush_chunk_tls"]}, {"name": "routers_update_all_from_networkstatus", "calls": ["get_options", "networkstatus_get_reasonably_live_consensus", "routers_update_status_from_consensus_networkstatus", "router_get_routerlist", "control_event_general_status", "tor_version_is_obsolete", "server_mode", "signed_descs_update_status_from_consensus_networkstatus", "log_fn_"]}, {"name": "marked_circuit_free_cells", "calls": ["cell_queue_clear", "TO_OR_CIRCUIT", "log_fn_"]}, {"name": "get_total_weighted_time", "calls": []}, {"name": "remove_dead_entry_guards", "calls": ["log_entry_guards", "smartlist_del_keeporder", "base16_encode", "control_event_guard", "format_local_iso_time", "log_fn_", "entry_guard_free"]}, {"name": "TO_EDGE_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "mark_my_descriptor_dirty_if_too_old", "calls": ["networkstatus_get_live_consensus", "networkstatus_vote_find_entry", "mark_my_descriptor_dirty"]}, {"name": "networkstatus_getinfo_helper_single", "calls": ["routerstatus_format_entry"]}, {"name": "check_descriptor_bandwidth_changed", "calls": ["we_are_hibernating", "mark_my_descriptor_dirty", "rep_hist_bandwidth_assess", "log_fn_"]}, {"name": "crypto_digest_add_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "connection_ap_warn_and_unmark_if_pending_circ", "calls": ["smartlist_contains", "connection_ap_mark_as_non_pending_circuit", "log_fn_"]}, {"name": "tor_memmem", "calls": ["tor_assertion_failed_"]}, {"name": "router_get_extrainfo_hash", "calls": ["router_get_hash_impl"]}, {"name": "circuit_build_times_max_timeouts", "calls": ["get_options", "networkstatus_get_param", "log_fn_"]}, {"name": "connection_or_update_token_buckets_helper", "calls": ["networkstatus_get_param", "connection_or_digest_is_known_relay"]}, {"name": "downrate_stability_callback", "calls": ["safe_timer_diff", "rep_hist_downrate_old_runs"]}, {"name": "connection_tls_continue_handshake", "calls": ["connection_start_writing", "tor_tls_set_renegotiate_callback", "tor_tls_err_to_string", "connection_stop_writing", "tor_tls_is_server", "tor_assertion_failed_", "connection_tls_finish_handshake", "connection_or_change_state", "check_no_tls_errors_", "connection_or_launch_v3_or_handshake", "connection_start_reading", "tor_tls_handshake", "tor_tls_used_v1_handshake", "log_fn_"]}, {"name": "circuit_get_cpath_hop", "calls": []}, {"name": "any_predicted_circuits", "calls": ["get_options"]}, {"name": "should_make_new_ed_keys", "calls": ["tor_tls_get_my_certs", "tor_x509_cert_get_cert_digests"]}, {"name": "port_cfg_free", "calls": []}, {"name": "digestmap_impl_HT_CLEAR", "calls": ["digestmap_impl_HT_INIT", "tor_free_"]}, {"name": "router_get_prim_orport", "calls": ["tor_assertion_failed_", "tor_addr_from_ipv4n"]}, {"name": "check_descriptor_callback", "calls": ["consider_publishable_server", "mark_my_descriptor_dirty_if_too_old", "check_descriptor_bandwidth_changed", "routerlist_remove_old_routers", "check_descriptor_ipaddress_changed"]}, {"name": "cpuworker_onion_handshake_replyfn", "calls": ["memwipe", "queue_pending_tasks", "tor_assertion_failed_", "tor_gettimeofday", "onionskin_answer", "circuit_mark_for_close_", "log_fn_"]}, {"name": "sb_flock", "calls": []}, {"name": "microdesc_map_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "node_get_nickname", "calls": ["tor_assertion_failed_"]}, {"name": "tor_zlib_get_header_version_str", "calls": []}, {"name": "set_client_identity_key", "calls": ["crypto_pk_free"]}, {"name": "third_quartile_uint32", "calls": ["find_nth_uint32"]}, {"name": "fp_pair_map_remove", "calls": ["tor_assertion_failed_", "fp_pair_map_impl_HT_REMOVE"]}, {"name": "circuit_describe_status_for_controller", "calls": ["smartlist_free", "circuit_purpose_to_controller_string", "esc_for_log_len", "circuit_list_path_for_controller", "smartlist_add", "format_iso_time_nospace_usec", "smartlist_add_asprintf", "smartlist_join_strings", "circuit_purpose_to_controller_hs_state_string", "smartlist_new"]}, {"name": "keypin_parse_journal_line", "calls": ["tor_malloc_zero_", "base64_decode"]}, {"name": "rend_valid_service_id", "calls": []}, {"name": "tor_lround", "calls": []}, {"name": "rend_client_get_random_intro_impl", "calls": ["get_options", "tor_digest_is_zero", "smartlist_free", "routerset_contains_extendinfo", "extend_info_dup", "node_get_by_hex_id", "extend_info_free", "smartlist_add_all", "extend_info_describe", "smartlist_del", "extend_info_from_node", "node_get_by_id", "tor_assertion_failed_", "smartlist_new", "crypto_rand_int", "log_fn_"]}, {"name": "channel_listener_dump_statistics", "calls": ["tor_log", "tor_assertion_failed_", "channel_listener_state_to_string"]}, {"name": "circuit_build_times_get_initial_timeout", "calls": ["get_options", "circuit_build_times_initial_timeout", "circuit_build_times_min_timeout", "log_fn_"]}, {"name": "tor_x509_cert_decode", "calls": ["tor_assertion_failed_", "tor_x509_cert_free", "check_no_tls_errors_", "tls_log_errors", "tor_x509_cert_new"]}, {"name": "or_state_validate_cb", "calls": ["or_state_validate"]}, {"name": "networkstatus_vote_find_entry", "calls": ["networkstatus_vote_find_mutable_entry"]}, {"name": "buf_free", "calls": ["buf_clear"]}, {"name": "append_cell_stats_by_command", "calls": ["smartlist_free", "smartlist_add_asprintf", "smartlist_join_strings", "cell_command_to_string", "smartlist_new"]}, {"name": "prot_strings", "calls": ["strmap_new", "prot_strings_helper", "log_fn_"]}, {"name": "teardown_periodic_events", "calls": ["periodic_event_destroy"]}, {"name": "validate_transport_socks_arguments", "calls": ["string_is_key_value", "tor_assertion_failed_", "pt_stringify_socks_args", "log_fn_"]}, {"name": "router_load_routers_from_string", "calls": ["smartlist_free", "router_add_to_routerlist", "router_rebuild_store", "smartlist_string_remove", "routerlist_assert_ok", "routers_update_status_from_consensus_networkstatus", "smartlist_contains_string", "smartlist_join_strings", "hex_str", "download_status_mark_impossible", "smartlist_add", "routerinfo_free", "routerlist_descriptors_added", "router_get_dl_status_by_descriptor_digest", "smartlist_clear", "base16_encode", "WRA_NEVER_DOWNLOADABLE", "WRA_WAS_ADDED", "smartlist_new", "router_parse_list_from_string", "log_fn_"]}, {"name": "get_voter", "calls": ["tor_assertion_failed_"]}, {"name": "digest256map_impl_HT_CLEAR", "calls": ["digest256map_impl_HT_INIT", "tor_free_"]}, {"name": "circuit_handle_first_hop", "calls": ["get_options", "fmt_addrport", "extend_info_dup", "onion_next_hop_in_cpath", "channel_connect_for_circuit", "circuit_send_next_onion_skin", "tor_addr_is_internal_", "extend_info_describe", "control_event_bootstrap", "safe_str_client", "tor_assertion_failed_", "channel_get_for_extend", "log_fn_"]}, {"name": "tor_gettimeofday_cached", "calls": ["tor_gettimeofday"]}, {"name": "extrainfo_get_by_descriptor_digest", "calls": ["eimap_get", "tor_assertion_failed_"]}, {"name": "rend_data_client_create", "calls": ["rend_data_free", "strlcpy", "tor_assertion_failed_", "tor_malloc_zero_", "compute_desc_id", "smartlist_new"]}, {"name": "cache_map_HT_INIT", "calls": []}, {"name": "tor_addr_hostname_is_local", "calls": ["strcasecmpend"]}, {"name": "dns_insert_cache_entry", "calls": ["cache_map_HT_INSERT"]}, {"name": "connection_or_send_versions", "calls": ["var_cell_free", "tor_assertion_failed_", "set_uint16", "var_cell_new", "connection_or_write_var_cell_to_buf"]}, {"name": "cached_getaddrinfo_item_free", "calls": []}, {"name": "scheduler_compare_channels", "calls": ["tor_assertion_failed_", "circuitmux_get_policy"]}, {"name": "fast_server_handshake", "calls": ["crypto_rand", "memwipe", "crypto_expand_key_material_TAP", "tor_malloc_"]}, {"name": "control_initialize_event_queue", "calls": ["tor_threadlocal_init", "tor_assertion_failed_", "tor_libevent_get_base", "tor_mutex_new", "smartlist_new"]}, {"name": "memarea_strndup", "calls": ["tor_assertion_failed_", "memarea_alloc"]}, {"name": "geoip_entry_stats_init", "calls": []}, {"name": "config_find_option_mutable", "calls": ["log_fn_"]}, {"name": "parse_version", "calls": ["log_fn_"]}, {"name": "sandbox_getaddrinfo", "calls": ["getaddrinfo_cache_HT_INSERT", "getaddrinfo_cache_HT_FIND", "tor_strdup_", "tor_malloc_zero_", "sandbox_is_active", "log_fn_"]}, {"name": "config_get_lines", "calls": ["tor_strdup_", "tor_malloc_zero_", "parse_config_line_from_str_verbose", "config_free_lines", "log_fn_"]}, {"name": "router_get_all_orports", "calls": ["tor_addr_copy", "smartlist_add", "tor_assertion_failed_", "tor_addr_is_null", "tor_malloc_", "tor_addr_from_ipv4n", "smartlist_new"]}, {"name": "dnsserv_configure_listener", "calls": ["tor_assertion_failed_", "tor_libevent_get_base", "TO_LISTENER_CONN"]}, {"name": "median_int32", "calls": ["find_nth_int32"]}, {"name": "tor_vsnprintf", "calls": []}, {"name": "circuit_get_by_circid_channel_impl", "calls": ["chan_circid_map_HT_FIND", "log_fn_"]}, {"name": "channel_mark_circid_unusable", "calls": ["chan_circid_map_HT_FIND", "approx_time", "tor_malloc_zero_", "chan_circid_map_HT_INSERT", "log_fn_"]}, {"name": "scale_active_circuits", "calls": ["tor_assertion_failed_", "get_scale_factor"]}, {"name": "pt_free_all", "calls": ["clear_transport_list", "smartlist_del", "smartlist_free", "managed_proxy_destroy"]}, {"name": "created_cell_parse", "calls": ["get_uint16", "check_created_cell"]}, {"name": "tor_tls_get_error", "calls": ["tor_log", "tor_errno_to_tls_error", "tls_log_errors"]}, {"name": "connection_ap_rescan_and_attach_pending", "calls": ["connection_ap_attach_pending", "smartlist_contains", "connection_ap_mark_as_pending_circuit_", "get_connection_array", "tor_assertion_failed_", "TO_ENTRY_CONN", "smartlist_new", "log_fn_"]}, {"name": "get_overhead_for_onionskins", "calls": []}, {"name": "find_start_of_next_routerstatus", "calls": ["tor_memstr"]}, {"name": "cache_failure_intro_add", "calls": ["rend_cache_failure_intro_entry_free", "rend_cache_failure_intro_entry_new", "rend_cache_failure_entry_new", "strmap_get_lc", "digestmap_set", "strmap_set_lc"]}, {"name": "strmap_isempty", "calls": []}, {"name": "directory_fetches_from_authorities", "calls": ["router_get_my_routerinfo", "dir_server_mode", "router_pick_published_address", "should_refuse_unknown_exits", "server_mode", "router_my_exit_policy_is_reject_star", "advertised_server_mode"]}, {"name": "periodic_event_setup", "calls": ["tor_assertion_failed_", "tor_libevent_get_base", "log_fn_"]}, {"name": "tor_gettimeofday_cache_clear", "calls": []}, {"name": "nodelist_map_HT_NEXT_RMV", "calls": []}, {"name": "ewma_free_circ_data", "calls": ["TO_EWMA_POL_CIRC_DATA", "tor_assertion_failed_"]}, {"name": "circuit_build_times_disabled", "calls": ["get_options", "did_last_state_file_write_fail", "networkstatus_get_param"]}, {"name": "pathbias_count_build_attempt", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "rate_limit_log", "pathbias_state_to_string", "circuit_state_to_string", "entry_guard_inc_circ_attempt_count", "pathbias_is_new_circ_attempt", "circuit_purpose_to_string", "approx_time", "log_fn_"]}, {"name": "transport_add_from_config", "calls": ["transport_new", "transport_add", "fmt_addrport", "transport_free", "log_fn_"]}, {"name": "have_enough_path_info", "calls": ["router_have_consensus_path"]}, {"name": "control_connection_new", "calls": ["tor_malloc_zero_", "connection_init"]}, {"name": "dirreqmap_HT_REP_IS_BAD_", "calls": ["dirreq_map_ent_hash"]}, {"name": "connection_dir_close_extra_consensus_conns", "calls": ["smartlist_free", "networkstatus_consensus_is_boostrapping", "connection_dir_list_by_purpose_and_resource", "tor_assertion_failed_", "networkstatus_get_flavor_name", "connection_dir_count_by_purpose_and_resource", "connection_close_immediate", "connection_dir_would_close_consensus_conn_helper", "connection_dir_count_by_purpose_resource_and_state", "router_digest_is_trusted_dir_type", "connection_mark_for_close_", "usable_consensus_flavor", "log_fn_"]}, {"name": "edmap_HT_REP_IS_BAD_", "calls": ["keypin_ent_hash_ed"]}, {"name": "do_main_loop", "calls": ["get_options", "run_main_loop_until_done", "control_event_bootstrap", "tor_libevent_get_base", "keypin_open_journal", "connection_bucket_init", "router_reload_router_list", "router_reload_consensus_networkstatus", "cpu_init", "client_identity_key_is_set", "directory_info_has_arrived", "options_get_datadir_fname2_suffix", "keypin_load_journal", "dns_init", "init_keys", "tor_assertion_failed_", "authdir_mode_v3", "server_mode", "initialize_periodic_events", "trusted_dirs_reload_certs", "handle_signals", "periodic_timer_new", "log_fn_"]}, {"name": "authdir_mode", "calls": []}, {"name": "dup_onion_keys", "calls": ["tor_mutex_release", "tor_assertion_failed_", "crypto_pk_copy_full", "tor_mutex_acquire"]}, {"name": "signed_descriptor_from_routerinfo", "calls": ["routerinfo_free", "tor_assertion_failed_", "tor_malloc_zero_"]}, {"name": "cbt_control_event_buildtimeout_set", "calls": ["circuit_build_times_close_rate", "circuit_build_times_timeout_rate", "circuit_build_times_quantile_cutoff", "tor_asprintf", "control_event_buildtimeout_set"]}, {"name": "cpath_ref_decref", "calls": ["circuit_free_cpath_node"]}, {"name": "control_event_client_status", "calls": ["control_event_status"]}, {"name": "pathbias_count_build_success", "calls": ["pathbias_should_count", "entry_guard_get_by_id_digest", "rate_limit_log", "hex_str", "pathbias_state_to_string", "circuit_state_to_string", "entry_guards_changed", "circuit_purpose_to_string", "approx_time", "log_fn_"]}, {"name": "client_check_address_changed", "calls": ["smartlist_clear", "tor_addr_compare", "tor_addr_copy", "reset_last_resolved_addr", "smartlist_add", "tor_addr_family", "tor_malloc_zero_", "ip_address_changed", "tor_memdup_", "tor_addr_from_sockaddr", "get_interface_address6", "smartlist_new", "log_fn_"]}, {"name": "format_node_description", "calls": ["strlcpy", "base16_encode", "tor_inet_ntoa", "tor_addr_to_str"]}, {"name": "connection_bucket_should_increase", "calls": ["tor_assertion_failed_"]}, {"name": "format_bridge_stats_controller", "calls": ["tor_asprintf", "geoip_get_client_history", "format_iso_time"]}, {"name": "double_digest_map_HT_INSERT", "calls": ["ddmap_entry_hash", "double_digest_map_HT_GROW"]}, {"name": "tor_cert_sign_impl", "calls": ["tor_cert_parse", "tor_mem_is_zero", "tor_assertion_failed_", "tor_malloc_", "tor_cert_free", "tor_cert_checksig", "log_fn_"]}, {"name": "tor_check_port_forwarding", "calls": ["tor_process_handle_destroy", "handle_fw_helper_output", "tor_assertion_failed_", "log_from_pipe", "tor_calloc_", "tor_free_", "tor_process_get_pid", "tor_spawn_background", "log_fn_"]}, {"name": "circuit_list_path_impl", "calls": ["node_is_named", "node_get_verbose_nickname", "strlcpy", "base16_encode", "tor_strdup_", "node_get_nickname", "smartlist_add", "tor_assertion_failed_", "smartlist_add_asprintf", "smartlist_new", "tor_malloc_", "is_legal_nickname", "smartlist_join_strings", "node_get_by_id", "build_state_get_exit_nickname", "smartlist_free"]}, {"name": "sandbox_cfg_allow_rename", "calls": ["new_element2", "log_fn_"]}, {"name": "rend_service_parse_intro_for_v0_or_v1", "calls": ["is_legal_nickname_or_hexdigest", "is_legal_nickname", "tor_asprintf"]}, {"name": "reset_last_resolved_addr", "calls": []}, {"name": "digest256map_impl_HT_INIT", "calls": []}, {"name": "rend_client_cancel_descriptor_fetches", "calls": ["safe_str", "get_connection_array", "TO_DIR_CONN", "connection_mark_for_close_", "log_fn_"]}, {"name": "crypto_pk_keysize", "calls": ["tor_assertion_failed_"]}, {"name": "microdesc_free_", "calls": ["smartlist_free", "crypto_pk_free", "microdesc_map_HT_REP_IS_BAD_", "microdesc_map_HT_FIND", "get_microdesc_cache_noload", "nodelist_get_list", "short_policy_free", "microdesc_map_HT_REMOVE", "log_fn_"]}, {"name": "rend_service_load_all_keys", "calls": ["rend_service_load_keys", "log_fn_"]}, {"name": "remove_file_if_very_old", "calls": ["format_local_iso_time", "sandbox_intern_string", "log_fn_"]}, {"name": "strmap_new", "calls": ["tor_malloc_", "strmap_impl_HT_INIT"]}, {"name": "purpose_needs_anonymity", "calls": ["get_options"]}, {"name": "ewma_notify_xmit_cells", "calls": ["TO_EWMA_POL_CIRC_DATA", "pop_first_cell_ewma", "cell_ewma_tick_from_timeval", "scale_active_circuits", "tor_gettimeofday_cached", "TO_EWMA_POL_DATA", "add_cell_ewma", "tor_assertion_failed_"]}, {"name": "dirvote_fetch_missing_votes", "calls": ["smartlist_free", "dirvote_get_vote", "base16_encode", "smartlist_add", "router_get_trusted_dir_servers", "tor_malloc_", "smartlist_join_strings", "directory_get_from_all_authorities", "smartlist_new", "log_fn_"]}, {"name": "channel_tls_process_versions_cell", "calls": ["connection_or_send_versions", "get_options", "connection_or_send_netinfo", "safe_str_client", "get_uint16", "tor_assertion_failed_", "public_server_mode", "rep_hist_note_negotiated_link_proto", "connection_or_send_auth_challenge_cell", "is_or_protocol_version_known", "connection_or_nonopen_was_started_here", "fmt_addr_impl", "connection_or_send_certs_cell", "log_fn_", "connection_or_close_for_error"]}, {"name": "compare_known_tor_addr_to_addr_policy_noport", "calls": ["tor_addr_compare_masked", "log_fn_"]}, {"name": "curve25519_public_to_base64", "calls": ["base64_encode"]}, {"name": "circuit_get_by_global_id", "calls": ["TO_ORIGIN_CIRCUIT", "circuit_get_global_list"]}, {"name": "networkstatus_add_detached_signatures", "calls": ["authority_cert_get_by_digests", "networkstatus_get_voter_by_id", "document_signature_dup", "networkstatus_check_document_signature", "base16_encode", "tor_log", "smartlist_add", "networkstatus_get_flavor_name", "tor_assertion_failed_", "crypto_digest_algorithm_get_name", "document_signature_free", "strmap_get", "tor_mem_is_zero", "voter_get_sig_by_algorithm", "smartlist_remove", "log_fn_"]}, {"name": "hibernate_soft_limit_reached", "calls": ["get_accounting_bytes", "get_options"]}, {"name": "alert_sockets_close", "calls": ["tor_close_socket"]}, {"name": "write_encrypted_secret_key", "calls": ["get_options", "do_getpass", "memwipe", "crypto_write_tagged_contents_to_file", "crypto_pwbox", "log_fn_"]}, {"name": "handle_proxy_line", "calls": ["parse_proxy_error", "parse_smethod_line", "parse_method_error", "tor_assertion_failed_", "parse_cmethod_line", "tor_sscanf", "handle_methods_done", "parse_version", "strcmpstart", "parse_env_error", "log_fn_"]}, {"name": "sb_epoll_ctl", "calls": []}, {"name": "trusted_dirs_load_certs_from_string", "calls": ["get_options", "networkstatus_note_certs_arrived", "hex_str", "tor_dup_ip", "authority_cert_free", "get_cert_list", "trusted_dirs_flush_certs_to_disk", "authority_cert_parse_from_string", "directory_caches_unknown_auth_certs", "authority_cert_dl_failed", "trusteddirserver_get_by_v3_auth_digest", "already_have_cert", "authdir_mode", "smartlist_add", "log_fn_"]}, {"name": "connection_ap_mark_as_pending_circuit_", "calls": ["smartlist_contains", "smartlist_add", "tor_assertion_failed_", "smartlist_new", "log_backtrace", "log_fn_"]}, {"name": "rep_hist_get_weighted_fractional_uptime", "calls": ["get_or_history", "get_weighted_fractional_uptime"]}, {"name": "periodic_event_reschedule", "calls": ["periodic_event_set_interval"]}, {"name": "dns_get_cache_entry", "calls": ["cache_map_HT_FIND"]}, {"name": "circuit_initial_package_window", "calls": ["networkstatus_get_param"]}, {"name": "compare_int_", "calls": []}, {"name": "fp_pair_map_impl_HT_REP_IS_BAD_", "calls": ["fp_pair_map_entry_hash"]}, {"name": "crypto_cipher_new", "calls": ["crypto_cipher_new_with_iv"]}, {"name": "get_transport_bindaddr_from_config", "calls": ["get_options", "get_bindaddr_from_transport_listen_line"]}, {"name": "connection_write_str_to_buf", "calls": ["connection_write_to_buf"]}, {"name": "compare_unknown_tor_addr_to_addr_policy", "calls": ["log_fn_"]}, {"name": "router_rebuild_store", "calls": ["get_options", "smartlist_free", "tor_mmap_file", "eimap_iter_done", "smartlist_sort", "router_should_rebuild_store", "write_str_to_file", "eimap_isempty", "options_get_datadir_fname2_suffix", "write_chunks_to_file", "tor_munmap_file", "eimap_iter_get", "signed_descriptor_get_body_impl", "eimap_iter_next", "smartlist_add", "tor_malloc_", "replace_file", "signed_descriptor_get_body", "eimap_iter_init", "routerlist_remove_old_routers", "smartlist_new", "log_fn_"]}, {"name": "crypto_global_init", "calls": ["log_engine", "crypto_seed_rng", "crypto_early_init", "crypto_force_rand_ssleay", "evaluate_ctr_for_aes", "try_load_engine", "evaluate_evp_for_aes", "log_fn_"]}, {"name": "format_helper_exit_status", "calls": ["format_hex_number_sigsafe"]}, {"name": "check_no_tls_errors_", "calls": ["tls_log_errors", "log_fn_"]}, {"name": "close_temp_logs", "calls": ["get_min_log_level", "tor_mutex_release", "tor_mutex_acquire", "close_log", "log_free"]}, {"name": "circuit_unlink_all_from_channel", "calls": ["smartlist_free", "circuit_set_n_circid_chan", "channel_unlink_all_circuits", "TO_OR_CIRCUIT", "circuit_set_p_circid_chan", "circuit_mark_for_close_", "smartlist_new", "log_fn_"]}, {"name": "short_policy_is_reject_star", "calls": ["tor_assertion_failed_"]}, {"name": "orconn_end_reason_to_control_string", "calls": ["log_fn_"]}, {"name": "tor_version_parse", "calls": ["strlcpy", "strcasecmpstart", "tor_assertion_failed_", "memwipe", "eat_whitespace", "base16_decode", "find_whitespace", "strcmpstart"]}, {"name": "circuit_detach_stream", "calls": ["EDGE_TO_ENTRY_CONN", "TO_OR_CIRCUIT", "tor_assertion_failed_", "TO_ORIGIN_CIRCUIT", "log_fn_"]}, {"name": "addressmap_register", "calls": ["safe_str_client", "strmap_remove", "addressmap_virtaddress_remove", "addressmap_ent_remove", "tor_assertion_failed_", "tor_malloc_zero_", "address_is_in_virtual_range", "control_event_address_mapped", "strmap_get", "strmap_set", "log_fn_"]}, {"name": "addr_policy_free", "calls": ["tor_assertion_failed_", "policy_map_HT_REMOVE"]}, {"name": "rep_hist_free_all", "calls": ["smartlist_free", "bw_array_free", "predicted_ports_free", "tor_assertion_failed_", "hs_stats_free", "rep_hist_desc_stats_term", "bidi_map_free"]}, {"name": "write_secret_key", "calls": ["write_encrypted_secret_key", "ed25519_seckey_write_to_file"]}, {"name": "get_frac_paths_needed_for_circs", "calls": ["networkstatus_get_param"]}, {"name": "router_pick_published_address", "calls": ["router_guess_address_from_dir_headers", "get_last_resolved_addr", "fmt_addr32", "resolve_my_address", "log_fn_"]}, {"name": "tor_process_monitor_free", "calls": ["tor_event_free"]}, {"name": "routerset_get_all_nodes", "calls": ["routerset_contains_node", "smartlist_add", "tor_assertion_failed_", "nodelist_get_list", "node_get_by_nickname", "routerset_is_list"]}, {"name": "dirreq_map_get_", "calls": ["dirreqmap_HT_FIND"]}, {"name": "digest256map_iter_done", "calls": []}, {"name": "control_event_general_error", "calls": ["queued_events_flush_all", "control_event_status"]}, {"name": "node_get_mutable_by_id", "calls": ["nodelist_map_HT_FIND"]}, {"name": "crypto_get_rsa_padding", "calls": ["tor_assertion_failed_"]}, {"name": "circuit_purpose_to_string", "calls": ["tor_snprintf"]}, {"name": "circuitmux_num_cells_for_circuit", "calls": ["circuitmux_find_map_entry", "tor_assertion_failed_"]}, {"name": "rend_consider_descriptor_republication", "calls": ["get_options", "upload_service_descriptor"]}, {"name": "secs_to_uptime", "calls": ["tor_asprintf"]}, {"name": "node_get_all_orports", "calls": ["tor_addr_copy", "tor_addr_is_null", "smartlist_new", "tor_malloc_", "tor_addr_from_ipv4n", "smartlist_add"]}, {"name": "circuit_build_times_reset", "calls": []}, {"name": "strmap_impl_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "compare_digests256_", "calls": ["tor_memcmp"]}, {"name": "networkstatus_get_voter_by_id", "calls": []}, {"name": "rend_cache_entry_free_", "calls": ["rend_cache_entry_free"]}, {"name": "chanid_circid_muxinfo_map_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "dirreqmap_HT_FIND", "calls": ["dirreqmap_HT_FIND_P_", "dirreq_map_ent_hash"]}, {"name": "format_rfc1123_time", "calls": ["tor_assertion_failed_", "tor_gmtime_r"]}, {"name": "compute_weighted_bandwidths", "calls": ["node_is_dir", "guard_get_guardfraction_bandwidth", "kb_to_bytes", "tor_assertion_failed_", "bridge_get_advertised_bandwidth_bounded", "bandwidth_weight_rule_to_string", "tor_calloc_", "networkstatus_get_bw_weight", "networkstatus_get_weight_scale_param", "log_fn_"]}, {"name": "routerinfo_is_a_configured_bridge", "calls": ["get_configured_bridge_by_routerinfo"]}, {"name": "update_expected_bandwidth", "calls": ["get_accounting_bytes", "get_options"]}, {"name": "circuit_count_pending_on_channel", "calls": ["smartlist_free", "tor_assertion_failed_", "circuit_get_all_pending_on_channel", "smartlist_new", "log_fn_"]}, {"name": "circuit_max_queued_data_age", "calls": ["CONST_TO_ORIGIN_CIRCUIT", "circuit_get_streams_max_data_age", "CONST_TO_OR_CIRCUIT"]}, {"name": "signed_descriptor_get_body_impl", "calls": ["router_get_routerlist", "tor_assertion_failed_", "escaped", "tor_strndup_", "desc_get_store", "log_fn_"]}, {"name": "mark_transport_list", "calls": ["smartlist_new"]}, {"name": "policy_eq", "calls": ["cmp_single_addr_policy"]}, {"name": "configure_libevent_logging", "calls": []}, {"name": "connection_write_to_buf_impl_", "calls": ["TO_OR_CONN", "connection_start_writing", "enable_control_logging", "write_to_buf_zlib", "write_to_buf", "tor_assertion_failed_", "TO_DIR_CONN", "log_fn_", "buf_datalen", "circuit_get_by_edge_conn", "connection_mark_for_close_", "TO_EDGE_CONN", "disable_control_logging", "circuit_mark_for_close_", "connection_or_close_for_error"]}, {"name": "fp_pair_map_entry_hash", "calls": []}, {"name": "channel_timestamp_drained", "calls": ["tor_assertion_failed_"]}, {"name": "node_is_a_configured_bridge", "calls": ["get_configured_bridge_by_orports_digest", "smartlist_free", "node_get_all_orports"]}, {"name": "connection_or_report_broken_states", "calls": ["strmap_iter_get", "smartlist_free", "tor_log", "smartlist_add", "smartlist_sort", "strmap_iter_init", "tor_malloc_", "strmap_iter_done", "smartlist_new", "strmap_iter_next"]}, {"name": "digestmap_impl_HT_NEXT", "calls": ["tor_assertion_failed_"]}, {"name": "send_control_event_string", "calls": ["tor_assertion_failed_", "tor_strdup_", "queue_control_event_string"]}, {"name": "dirserv_get_flag_thresholds_line", "calls": ["get_options", "tor_asprintf"]}, {"name": "channel_set_cmux_policy_everywhere", "calls": []}, {"name": "rend_authorized_client_strmap_item_free", "calls": ["rend_authorized_client_free"]}, {"name": "relay_command_to_string", "calls": ["tor_snprintf"]}, {"name": "write_http_status_line", "calls": ["connection_write_to_buf", "tor_snprintf", "log_fn_"]}, {"name": "socks5_reason_to_string", "calls": []}, {"name": "any_bridge_supports_microdescriptors", "calls": ["get_options", "node_is_a_configured_bridge", "node_get_by_id", "node_get_purpose"]}, {"name": "channel_unlink_all_circuits", "calls": ["tor_assertion_failed_"]}, {"name": "fmt_addrport", "calls": ["tor_snprintf", "fmt_addr_impl"]}, {"name": "channel_timestamp_active", "calls": ["tor_assertion_failed_"]}, {"name": "close_closeable_connections", "calls": ["conn_close_if_marked", "connection_unlink"]}, {"name": "networkstatus_get_flavor_name", "calls": []}, {"name": "download_status_increment_failure", "calls": ["get_options", "download_status_log_helper", "find_dl_schedule", "tor_assertion_failed_", "download_status_schedule_get_delay"]}, {"name": "edmap_HT_INIT", "calls": []}, {"name": "router_has_bandwidth_to_be_dirserver", "calls": []}, {"name": "configure_proxy", "calls": ["smartlist_free", "tor_get_lines_from_handle", "stream_status_to_string", "proxy_configuration_finished", "tor_assertion_failed_", "handle_proxy_line", "launch_managed_proxy", "tor_process_get_stdout_pipe", "handle_finished_proxy", "log_fn_"]}, {"name": "circuit_build_times_init", "calls": ["circuit_build_times_get_initial_timeout", "circuit_build_times_disabled", "cbt_control_event_buildtimeout_set", "tor_calloc_", "circuit_build_times_recent_circuit_count"]}, {"name": "pending_log_message_free", "calls": []}, {"name": "connection_ap_handshake_rewrite_and_attach", "calls": ["get_options", "rend_client_refetch_v2_renddesc", "router_find_exact_exit_enclave", "tor_addr_family", "connection_ap_handshake_attach_chosen_circuit", "escaped", "consider_plaintext_ports", "rate_limit_log", "safe_str_client", "control_event_client_status", "connection_ap_handshake_socks_resolved_addr", "routerset_contains_node", "tor_strdup_", "connection_ap_handshake_socks_resolved", "rend_data_client_create", "tor_addr_hostname_is_local", "approx_time", "connection_ap_handshake_rewrite", "node_describe", "hex_str", "connection_ap_mark_as_non_pending_circuit", "address_is_invalid_destination", "tor_assertion_failed_", "tor_addr_is_internal_", "parse_extended_hostname", "rep_hist_note_used_internal", "strlcpy", "rend_cache_lookup_entry", "connection_mark_unattached_ap_", "rep_hist_note_used_resolve", "rep_hist_note_used_port", "connection_ap_mark_as_pending_circuit_", "tor_addr_parse", "node_get_address_string", "rend_client_lookup_service_authorization", "node_get_by_nickname", "rend_client_any_intro_points_usable", "log_fn_"]}, {"name": "control_event_circuit_cannibalized", "calls": ["control_event_circuit_status_minor"]}, {"name": "channel_run_cleanup", "calls": ["smartlist_del", "channel_unregister"]}, {"name": "dirreq_map_ent_hash", "calls": []}, {"name": "router_have_minimum_dir_info", "calls": ["get_options", "should_delay_dir_fetches", "strlcpy", "update_router_have_minimum_dir_info", "log_fn_"]}, {"name": "check_location_for_unix_socket", "calls": ["unix_socket_purpose_to_string", "tor_strdup_", "tor_assertion_failed_", "get_parent_directory", "esc_for_log", "check_private_dir", "is_valid_unix_socket_purpose", "log_fn_"]}, {"name": "hs_stats_free", "calls": []}, {"name": "tor_parse_ulong", "calls": []}, {"name": "or_state_mark_dirty", "calls": []}, {"name": "get_tlsclient_identity_key", "calls": ["assert_identity_keys_ok", "tor_assertion_failed_"]}, {"name": "cmp_int_strings_", "calls": ["tor_parse_long"]}, {"name": "exit_policy_remove_redundancies", "calls": ["policy_write_item", "addr_policy_free", "smartlist_del_keeporder", "addr_policy_covers", "tor_assertion_failed_", "tor_addr_family", "addr_policy_intersects", "log_fn_"]}, {"name": "channel_find_by_remote_digest", "calls": ["channel_idmap_HT_FIND", "tor_assertion_failed_"]}, {"name": "chanid_circid_muxinfo_map_HT_FIND_P_", "calls": ["chanid_circid_entries_eq"]}, {"name": "policy_map_HT_FIND_P_", "calls": ["policy_eq"]}, {"name": "relay_crypt", "calls": ["get_options", "relay_digest_matches", "TO_OR_CIRCUIT", "relay_header_unpack", "relay_crypt_one_payload", "TO_ORIGIN_CIRCUIT", "tor_assertion_failed_", "log_fn_"]}, {"name": "list_torrc_options", "calls": ["smartlist_free", "smartlist_new"]}, {"name": "connection_edge_finished_flushing", "calls": ["tor_assertion_failed_", "connection_edge_consider_sending_sendme", "log_fn_"]}, {"name": "directory_fetches_dir_info_early", "calls": ["directory_fetches_from_authorities"]}, {"name": "is_local_addr", "calls": ["get_options", "tor_addr_is_internal_", "tor_addr_to_ipv4h", "tor_addr_family"]}, {"name": "enable_control_logging", "calls": ["tor_assertion_failed_"]}, {"name": "tor_tls_allocate_tor_tls_object_ex_data_index", "calls": ["tor_assertion_failed_"]}, {"name": "geoip_free_all", "calls": ["clientmap_HT_CLEAR", "clientmap_entry_free", "clientmap_HT_START", "clientmap_HT_NEXT_RMV", "clear_geoip_db", "dirreqmap_HT_NEXT_RMV", "dirreqmap_HT_CLEAR", "dirreqmap_HT_START"]}, {"name": "fp_pair_map_set_by_digests", "calls": ["fp_pair_map_set", "tor_assertion_failed_"]}, {"name": "dirserv_thinks_router_is_unreliable", "calls": ["dirserv_get_credible_bandwidth_kb", "real_uptime", "rep_hist_get_stability"]}, {"name": "rep_hist_note_or_conn_bytes", "calls": ["bidimap_HT_FIND", "bidimap_HT_START", "bidimap_HT_NEXT_RMV", "bidimap_HT_INSERT", "tor_malloc_zero_", "log_fn_"]}, {"name": "router_get_verbose_nickname", "calls": ["networkstatus_get_router_digest_by_nickname", "strlcpy", "tor_memeq", "base16_encode"]}, {"name": "connection_or_update_token_buckets", "calls": ["TO_OR_CONN", "connection_or_update_token_buckets_helper"]}, {"name": "router_get_trusted_dir_servers", "calls": ["smartlist_new"]}, {"name": "init_key_from_file", "calls": ["get_options", "crypto_pk_free", "log_new_relay_greeting", "crypto_pk_check_key", "tor_assertion_failed_", "tor_log", "crypto_pk_write_private_key_to_filename", "crypto_pk_generate_key_with_bits", "file_status", "crypto_pk_read_private_key_from_filename", "crypto_pk_new", "try_locking", "have_lockfile", "log_fn_"]}, {"name": "crypto_digest_alloc_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "peek_connection_has_control0_command", "calls": ["peek_buf_has_control0_command"]}, {"name": "add_cell_ewma", "calls": ["scale_single_cell_ewma", "tor_assertion_failed_"]}, {"name": "directories_have_accepted_server_descriptor", "calls": ["get_options", "router_get_trusted_dir_servers"]}, {"name": "string_is_valid_ipv4_address", "calls": ["tor_inet_pton"]}, {"name": "channel_closed", "calls": ["circuit_unlink_all_from_channel", "circuit_n_chan_done", "channel_is_in_state", "tor_assertion_failed_", "channel_change_state"]}, {"name": "handle_finished_proxy", "calls": ["tor_assertion_failed_", "register_proxy", "managed_proxy_destroy", "log_fn_"]}, {"name": "tor_cert_checksig", "calls": ["tor_cert_get_checkable_sig"]}, {"name": "addressmap_clear_excluded_trackexithosts", "calls": ["strmap_iter_get", "tor_strndup_", "routerset_contains_node", "addressmap_ent_remove", "strmap_iter_init", "strmap_iter_next_rmv", "strmap_iter_done", "node_get_by_nickname", "strcmpend", "routerset_is_empty", "hostname_in_track_host_exits", "strmap_iter_next"]}, {"name": "digestmap_impl_HT_REMOVE", "calls": ["digestmap_entry_hash", "digestmap_impl_HT_FIND_P_"]}, {"name": "parse_smethod_line", "calls": ["smartlist_free", "smartlist_split_string", "tor_addr_parse", "smartlist_add", "tor_assertion_failed_", "transport_new", "tor_addr_port_split", "strcmpstart", "string_is_C_identifier", "smartlist_new", "log_fn_"]}, {"name": "init_cache_map", "calls": ["cache_map_HT_INIT"]}, {"name": "channel_tls_common_init", "calls": ["tor_assertion_failed_", "cell_ewma_enabled", "channel_init", "circuitmux_alloc"]}, {"name": "rep_hist_update_state", "calls": ["get_options", "or_state_mark_dirty", "rep_hist_update_bwhist_state_section", "server_mode"]}, {"name": "policy_hash", "calls": ["tor_addr_copy_tight"]}, {"name": "eventfd_drain", "calls": ["read_ni"]}, {"name": "queue_control_event_string", "calls": ["tor_mutex_acquire", "in_main_thread", "get_block_event_queue", "tor_assertion_failed_", "tor_mutex_release", "tor_malloc_", "smartlist_add"]}, {"name": "hs_stats_new", "calls": ["tor_malloc_zero_", "digestmap_new"]}, {"name": "finish_writing_to_file_impl", "calls": ["tor_assertion_failed_", "replace_file", "log_fn_"]}, {"name": "generate_ed_link_cert", "calls": ["tor_x509_cert_get_cert_digests", "tor_cert_create", "tor_cert_free", "tor_tls_get_my_certs", "get_master_signing_keypair", "log_fn_"]}, {"name": "channel_tls_free_method", "calls": ["channel_tls_from_base", "tor_assertion_failed_"]}, {"name": "entry_guards_update_state", "calls": ["get_options", "base16_encode", "or_state_mark_dirty", "tor_strdup_", "pathbias_get_close_success_count", "format_iso_time", "config_free_lines", "tor_malloc_zero_", "get_or_state", "pathbias_get_use_success_count", "tor_asprintf", "tor_malloc_", "smartlist_new"]}, {"name": "keypin_open_journal", "calls": ["write_all", "tor_snprintf", "tor_open_cloexec", "format_iso_time", "tor_fd_seekend", "approx_time"]}, {"name": "find_by_keyword_", "calls": ["find_opt_by_keyword", "tor_assertion_failed_", "log_fn_"]}, {"name": "control_event_server_status", "calls": ["control_event_status"]}, {"name": "tor_tls_setup_session_secret_cb", "calls": []}, {"name": "crypto_pk_private_sign", "calls": ["crypto_log_errors", "crypto_pk_keysize", "tor_assertion_failed_"]}, {"name": "handle_control_loadconf", "calls": ["connection_printf_to_buf", "send_control_done", "options_init_from_string", "log_fn_"]}, {"name": "eimap_iter_done", "calls": ["digestmap_iter_done"]}, {"name": "router_parse_addr_policy", "calls": ["router_parse_addr_policy_private", "tor_addr_parse_mask_ports", "tor_assertion_failed_", "escaped", "addr_policy_get_canonical_entry", "strcmpstart", "log_fn_"]}, {"name": "cell_queue_clear", "calls": ["packed_cell_free_unchecked"]}, {"name": "cell_queue_entry_free", "calls": ["var_cell_free", "packed_cell_free"]}, {"name": "correct_tm", "calls": ["log_fn_"]}, {"name": "getinfo_helper_onions", "calls": ["smartlist_join_strings"]}, {"name": "dirserv_compute_performance_thresholds", "calls": ["get_options", "real_uptime", "router_counts_toward_thresholds", "nodelist_assert_ok", "find_nth_long", "rep_hist_get_weighted_fractional_uptime", "nodelist_get_list", "median_uint32", "tor_calloc_", "router_exit_policy_rejects_all", "dirserv_get_credible_bandwidth_kb", "exit_policy_is_general_exit", "tor_assertion_failed_", "median_double", "rep_hist_have_measured_enough_stability", "rep_hist_get_stability", "find_nth_uint32", "rep_hist_get_weighted_time_known", "networkstatus_get_param", "third_quartile_uint32", "log_fn_"]}, {"name": "pathbias_mark_use_success", "calls": ["pathbias_should_count", "pathbias_state_to_string", "pathbias_count_use_attempt", "circuit_state_to_string", "circuit_purpose_to_string", "log_fn_"]}, {"name": "tor_socketpair", "calls": ["socket_accounting_lock", "socket_accounting_unlock"]}, {"name": "rend_cache_intro_failure_note", "calls": ["cache_failure_intro_add", "cache_failure_intro_lookup"]}, {"name": "assign_onionskin_to_cpuworker", "calls": ["threadpool_queue_work", "tor_assertion_failed_", "onion_pending_add", "connection_or_digest_is_known_relay", "tor_gettimeofday", "memwipe", "tor_malloc_zero_", "rep_hist_note_circuit_handshake_assigned", "should_time_request", "log_fn_"]}, {"name": "rep_hist_init", "calls": ["bw_arrays_init", "digestmap_new", "predicted_ports_init"]}, {"name": "create_cell_parse", "calls": ["create_cell_init", "parse_create2_payload", "check_create_cell", "tor_memeq"]}, {"name": "tor_set_openssl_thread_id", "calls": ["tor_get_thread_id"]}, {"name": "node_is_dir", "calls": []}, {"name": "dirserv_set_node_flags_from_authoritative_status", "calls": []}, {"name": "channel_is_incoming", "calls": ["tor_assertion_failed_"]}, {"name": "routerstatus_list_update_named_server_map", "calls": ["get_options", "we_use_microdescriptors_for_circuits", "strmap_new", "tor_memdup_", "strmap_set_lc"]}, {"name": "tor_log_get_logfile_names", "calls": ["tor_mutex_acquire", "smartlist_add", "tor_assertion_failed_", "tor_mutex_release", "tor_strdup_"]}, {"name": "connection_control_finished_flushing", "calls": ["tor_assertion_failed_"]}, {"name": "log_cert_lifetime", "calls": ["tor_log", "tor_strndup_", "tor_gmtime_r", "tls_log_errors", "log_fn_"]}, {"name": "circuit_get_ready_rend_circ_by_rend_data", "calls": ["TO_ORIGIN_CIRCUIT", "rend_cmp_service_ids", "tor_memeq", "circuit_get_global_list"]}, {"name": "double_digest_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "connection_ap_process_natd", "calls": ["strlcpy", "tor_assertion_failed_", "log_fn_", "connection_fetch_from_buf_line", "escaped", "strcmpstart", "connection_ap_rewrite_and_attach_if_allowed", "control_event_stream_status", "tor_parse_long", "connection_mark_unattached_ap_"]}, {"name": "is_valid_initial_command", "calls": []}, {"name": "base64_decode_nopad", "calls": ["tor_malloc_", "base64_decode"]}, {"name": "onion_populate_cpath", "calls": ["onion_extend_cpath", "circuits_can_use_ntor", "log_fn_", "circuit_cpath_supports_ntor", "circuit_clear_cpath"]}, {"name": "rend_service_free_intro", "calls": ["memwipe", "extend_info_free", "log_fn_"]}, {"name": "microdesc_cache_clean", "calls": ["networkstatus_get_reasonably_live_consensus", "microdesc_free_", "networkstatus_get_latest_consensus", "microdesc_map_HT_NEXT", "microdesc_map_HT_REP_IS_BAD_", "nodelist_find_nodes_with_microdesc", "smartlist_free", "microdesc_map_HT_START", "microdesc_map_HT_NEXT_RMV", "hex_str", "tor_memeq", "log_fn_"]}, {"name": "circuit_build_times_enough_to_compute", "calls": ["circuit_build_times_min_circs_to_observe"]}, {"name": "options_transition_allowed", "calls": ["opt_streq", "tor_strdup_", "config_lines_eq", "server_mode", "sandbox_is_active", "tor_asprintf"]}, {"name": "addressmap_clean", "calls": ["addressmap_get_mappings"]}, {"name": "keypin_check_lone_rsa", "calls": ["rsamap_HT_FIND"]}, {"name": "node_free", "calls": ["tor_assertion_failed_"]}, {"name": "microdesc_cache_clear", "calls": ["tor_munmap_file", "microdesc_free_", "microdesc_map_HT_CLEAR", "microdesc_map_HT_START", "microdesc_map_HT_NEXT_RMV", "log_fn_"]}, {"name": "download_status_increment_attempt", "calls": ["get_options", "download_status_log_helper", "find_dl_schedule", "tor_assertion_failed_", "download_status_schedule_get_delay", "log_fn_"]}, {"name": "router_parse_entry_from_string", "calls": ["tor_memstr", "smartlist_free", "router_get_router_hash", "find_by_keyword_", "ed25519_public_from_base64", "escaped", "tor_parse_long", "ed25519_pubkey_eq", "short_policy_is_reject_star", "router_add_exit_policy", "ed25519_signature_from_base64", "tor_strstrip", "policy_expand_private", "router_purpose_from_string", "check_signature_token", "policy_is_reject_star", "parse_iso_time", "tor_strdup_", "tor_memdup_", "find_all_by_keyword", "crypto_digest256_new", "router_get_hash_impl_helper", "tor_cert_parse", "tor_cert_free", "curve25519_public_from_base64", "strcmpstart", "find_single_ipv6_orport", "smartlist_new", "tor_cert_get_checkable_sig", "tor_inet_aton", "dump_desc", "tor_assertion_failed_", "smartlist_add", "crypto_pk_public_exponent_ok", "crypto_digest_free", "check_tap_onion_key_crosscert", "note_crypto_pk_op", "parse_short_policy", "tor_malloc_", "routerinfo_free", "is_legal_nickname", "crypto_digest_add_bytes", "tor_memeq", "memarea_drop_all", "find_opt_by_keyword", "smartlist_pos", "find_all_exitpolicy", "tor_malloc_zero_", "crypto_pk_get_digest", "memarea_new", "tokenize_string", "token_clear", "base16_decode", "is_legal_nickname_or_hexdigest", "digest256_from_base64", "crypto_digest_get_digest", "log_fn_"]}, {"name": "router_build_fresh_descriptor", "calls": ["get_options", "crypto_digest256", "is_legal_hexdigest", "router_get_router_hash", "rep_hist_bandwidth_assess", "extrainfo_dump_to_string", "router_should_be_directory_server", "tor_strdup_", "policies_exit_policy_append_reject_star", "smartlist_free", "escaped", "smartlist_string_remove", "crypto_pk_dup_key", "router_digest_is_me", "strlcpy", "policy_is_reject_star", "get_configured_ports", "smartlist_sort_strings", "tor_cert_dup", "smartlist_contains_string", "routerinfo_incompatible_with_extrainfo", "policies_parse_exit_policy_from_options", "log_fn_", "tor_assertion_failed_", "smartlist_new", "tor_memdup_", "dir_server_mode", "smartlist_split_string", "extrainfo_free", "get_onion_key", "router_get_extrainfo_hash", "smartlist_add", "we_are_hibernating", "policy_summarize", "router_get_advertised_or_port", "tor_addr_is_internal_", "parse_short_policy", "tor_malloc_", "get_effective_bwburst", "router_pick_published_address", "get_current_curve25519_keypair", "smartlist_uniq_strings", "dns_seems_to_be_broken", "get_effective_bwrate", "base16_encode", "get_server_identity_key", "has_dns_init_failed", "tor_malloc_zero_", "crypto_pk_get_digest", "router_dump_router_to_string", "tor_addr_copy", "tor_addr_to_str", "routerinfo_free", "router_get_advertised_dir_port", "node_get_by_nickname", "tor_addr_family", "is_legal_nickname_or_hexdigest", "get_master_signing_key_cert", "get_platform_str", "get_master_signing_keypair"]}, {"name": "connection_edge_end_errno", "calls": ["tor_assertion_failed_", "connection_edge_end", "errno_to_stream_end_reason"]}, {"name": "add_default_fallback_dir_servers", "calls": ["parse_dir_fallback_line", "log_fn_"]}, {"name": "strmap_assign_tmp_key", "calls": []}, {"name": "routerlist_find_elt_", "calls": ["tor_assertion_failed_"]}, {"name": "connection_fetch_from_buf", "calls": ["fetch_from_buf"]}, {"name": "tor_lockfile_lock", "calls": ["tor_open_cloexec", "tor_strdup_", "tor_malloc_", "log_fn_"]}, {"name": "cell_queue_init", "calls": []}, {"name": "load_ed_keys", "calls": ["get_options", "log_fn_ratelim_", "ed25519_pubkey_eq", "ed_key_init_from_file", "check_private_dir", "ed_key_new", "memwipe", "tor_strdup_", "options_get_datadir_fname2_suffix", "tor_cert_free", "ed25519_keypair_free", "tor_assertion_failed_", "tor_malloc_zero_", "server_mode", "ed25519_pubkey_write_to_file", "tor_cert_checksig", "get_server_identity_key", "tor_make_rsa_ed25519_crosscert", "tor_mem_is_zero", "log_fn_"]}, {"name": "router_get_descriptor_gen_reason", "calls": []}, {"name": "tor_strisprint", "calls": ["TOR_ISPRINT"]}, {"name": "connection_or_get_state_description", "calls": ["tor_tls_get_state_description", "tor_assertion_failed_", "tor_snprintf", "conn_state_to_string"]}, {"name": "ed25519_init", "calls": ["pick_ed25519_impl"]}, {"name": "tor_fd_getpos", "calls": []}, {"name": "crypto_dh_free", "calls": ["tor_assertion_failed_"]}, {"name": "is_keyval_pair", "calls": []}, {"name": "have_enough_mem_for_dircache", "calls": ["get_total_system_memory"]}, {"name": "download_status_is_ready_by_sk_in_cl", "calls": ["dsmap_get", "tor_assertion_failed_", "tor_malloc_zero_", "download_status_reset", "download_status_is_ready", "dsmap_new", "dsmap_set"]}, {"name": "get_platform_str", "calls": ["tor_snprintf", "get_short_version", "get_uname"]}, {"name": "router_get_mutable_consensus_status_by_id", "calls": ["get_options", "smartlist_bsearch", "we_use_microdescriptors_for_circuits"]}, {"name": "tor_log_err_sigsafe_write", "calls": []}, {"name": "buf_slack", "calls": ["CHUNK_REMAINING_CAPACITY"]}, {"name": "smartlist_ensure_capacity", "calls": ["tor_reallocarray_"]}, {"name": "router_get_dir_hash", "calls": ["router_get_hash_impl"]}, {"name": "channel_remove_from_digest_map", "calls": ["tor_digest_is_zero", "hex_str", "channel_idmap_HT_REMOVE", "channel_idmap_HT_FIND", "tor_assertion_failed_", "channel_state_to_string", "log_fn_"]}, {"name": "do_hash_password", "calls": ["crypto_rand", "get_options", "base16_encode", "secret_to_key_rfc2440"]}, {"name": "get_stored_bindaddr_for_server_transport", "calls": ["get_transport_bindaddr", "get_transport_bindaddr_from_config", "tor_strdup_", "get_transport_in_state_by_name", "tor_asprintf", "fmt_addr32"]}, {"name": "rend_service_add_ephemeral", "calls": ["rend_service_free", "rend_service_get_by_service_id", "rend_service_derive_key_digests", "rend_add_service", "tor_malloc_zero_", "tor_strdup_", "rend_service_get_by_pk_digest", "log_fn_"]}, {"name": "crypto_dh_get_bytes", "calls": ["tor_assertion_failed_"]}, {"name": "strmap_entry_hash", "calls": []}, {"name": "digestmap_assign_key", "calls": []}, {"name": "token_check_object", "calls": ["memarea_strdup", "crypto_pk_key_is_private", "crypto_pk_num_bits", "tor_snprintf", "memarea_alloc_zero", "token_clear"]}, {"name": "tor_libevent_get_method", "calls": []}, {"name": "TO_OR_CONN", "calls": ["tor_assertion_failed_"]}, {"name": "edmap_HT_FIND", "calls": ["keypin_ent_hash_ed", "edmap_HT_FIND_P_"]}, {"name": "get_bytes_written", "calls": []}, {"name": "handle_fw_helper_output", "calls": ["handle_fw_helper_line", "smartlist_free", "tor_get_lines_from_handle", "tor_process_get_stdout_pipe"]}, {"name": "channel_is_in_state", "calls": []}, {"name": "geoip_bridge_stats_term", "calls": ["client_history_clear"]}, {"name": "connection_flushed_some", "calls": ["TO_OR_CONN", "connection_dirserv_flushed_some", "TO_DIR_CONN", "tor_assertion_failed_", "connection_edge_flushed_some", "connection_or_flushed_some", "TO_EDGE_CONN"]}, {"name": "dirserv_compute_bridge_flag_thresholds", "calls": ["dirserv_compute_performance_thresholds", "digestmap_new"]}, {"name": "process_signal", "calls": ["get_options", "log_heartbeat", "switch_logs_debug", "dumpstats", "notify_pending_waitpid_callbacks", "control_event_signal", "server_mode", "signewnym_impl", "hibernate_begin_shutdown", "do_hup", "get_min_log_level", "addressmap_clear_transient", "tor_cleanup", "log_fn_"]}, {"name": "usage", "calls": []}, {"name": "origin_circuit_init", "calls": ["tor_malloc_zero_", "origin_circuit_new", "circuit_set_state"]}, {"name": "is_valid_unix_socket_purpose", "calls": []}, {"name": "WRA_WAS_OUTDATED", "calls": []}, {"name": "authority_cert_dup", "calls": ["tor_strndup_", "crypto_pk_dup_key", "tor_assertion_failed_", "tor_malloc_"]}, {"name": "tor_munmap_file", "calls": ["log_fn_"]}, {"name": "log_new_relay_greeting", "calls": ["tor_log"]}, {"name": "memarea_owns_ptr", "calls": []}, {"name": "pathbias_get_scale_use_threshold", "calls": ["networkstatus_get_param"]}, {"name": "dirvote_clear_votes", "calls": ["smartlist_clear", "networkstatus_vote_free", "cached_dir_decref", "smartlist_add_all", "dirvote_clear_pending_consensuses", "smartlist_new"]}, {"name": "connection_reached_eof", "calls": ["TO_OR_CONN", "connection_or_reached_eof", "connection_dir_reached_eof", "TO_DIR_CONN", "connection_edge_reached_eof", "TO_EDGE_CONN", "connection_control_reached_eof", "TO_CONTROL_CONN", "log_fn_"]}, {"name": "crypto_pk_get_all_digests", "calls": ["crypto_digest_all"]}, {"name": "clear_transport_list", "calls": ["transport_free", "smartlist_clear", "smartlist_new"]}, {"name": "channel_mark_local", "calls": ["tor_assertion_failed_"]}, {"name": "make_consensus_method_list", "calls": ["smartlist_free", "tor_assertion_failed_", "smartlist_add_asprintf", "smartlist_join_strings", "consensus_method_is_supported", "smartlist_new"]}, {"name": "geoip_dirreq_stats_write", "calls": ["check_or_create_data_subdir", "geoip_reset_dirreq_stats", "write_to_data_subdir", "geoip_remove_old_clients", "geoip_format_dirreq_stats"]}, {"name": "count_loading_descriptors_progress", "calls": ["get_options", "networkstatus_get_reasonably_live_consensus", "compute_frac_paths_available", "get_frac_paths_needed_for_circs", "usable_consensus_flavor"]}, {"name": "try_locking", "calls": ["tor_lockfile_lock", "options_get_datadir_fname2_suffix", "try_locking", "log_fn_"]}, {"name": "onion_extend_cpath", "calls": ["get_options", "onion_append_hop", "choose_good_entry_server", "extend_info_dup", "tor_assertion_failed_", "extend_info_free", "choose_good_middle_server", "extend_info_describe", "server_mode", "circuit_get_cpath_len", "extend_info_from_node", "build_state_get_exit_nickname", "log_fn_"]}, {"name": "directory_post_to_dirservers", "calls": ["get_options", "fascist_firewall_allows_address_or", "dir_conn_purpose_to_string", "router_digest_is_me", "fascist_firewall_allows_address_dir", "routerset_contains_routerstatus", "router_get_trusted_dir_servers", "directory_initiate_command_routerstatus", "purpose_needs_anonymity", "authdir_type_to_string", "tor_addr_from_ipv4n", "tor_assertion_failed_", "router_supports_extrainfo", "log_fn_"]}, {"name": "get_short_version", "calls": ["tor_strdup_"]}, {"name": "control_event_or_conn_status", "calls": ["channel_tls_to_base", "send_control_event", "connection_or_get_num_circuits", "orconn_target_get_name", "tor_snprintf", "circuit_count_pending_on_channel", "orconn_end_reason_to_control_string", "log_fn_"]}, {"name": "tor_dup_addr", "calls": ["tor_addr_to_str", "tor_strdup_"]}, {"name": "base16_encode", "calls": ["tor_assertion_failed_"]}, {"name": "fascist_firewall_allows_or", "calls": ["fascist_firewall_allows_address_or", "tor_addr_from_ipv4n"]}, {"name": "guardfraction_line_apply", "calls": ["smartlist_bsearch", "tor_assertion_failed_"]}, {"name": "write_str_to_file", "calls": ["write_bytes_to_file"]}, {"name": "tor_close_socket_simple", "calls": ["log_fn_"]}, {"name": "truncate_logs", "calls": ["tor_ftruncate"]}, {"name": "channel_listener_run_cleanup", "calls": ["smartlist_del", "channel_listener_unregister"]}, {"name": "TOR_ISXDIGIT", "calls": []}, {"name": "tor_process_get_stdout_pipe", "calls": []}, {"name": "add_entropy_callback", "calls": ["crypto_seed_rng", "log_fn_"]}, {"name": "disable_control_logging", "calls": []}, {"name": "launch_descriptor_fetches_callback", "calls": ["router_have_minimum_dir_info", "should_delay_dir_fetches", "update_all_descriptor_downloads", "update_extrainfo_downloads"]}, {"name": "bidimap_HT_NEXT_RMV", "calls": []}, {"name": "conn_type_to_string", "calls": ["tor_snprintf", "log_fn_"]}, {"name": "relay_digest_matches", "calls": ["crypto_digest_free", "relay_header_unpack", "relay_header_pack", "crypto_digest_assign", "crypto_digest_add_bytes", "crypto_digest_dup", "crypto_digest_get_digest"]}, {"name": "choose_good_exit_server", "calls": ["get_options", "node_describe", "safe_str_client", "router_choose_random_node", "choose_good_exit_server_general", "pick_rendezvous_node", "log_fn_"]}, {"name": "v3_authority_check_key_expiry", "calls": ["get_options", "tor_log", "authdir_mode_v3"]}, {"name": "digestmap_assign_tmp_key", "calls": []}, {"name": "managed_proxy_has_argv", "calls": ["tor_assertion_failed_"]}, {"name": "rep_hist_load_mtbf_data", "calls": ["get_options", "find_next_with", "correct_time", "parse_iso_time", "smartlist_split_string", "parse_possibly_bad_iso_time", "strcmpstart", "smartlist_free", "read_file_to_str", "escaped", "get_or_history", "tor_sscanf", "options_get_datadir_fname2_suffix", "strlcpy", "base16_decode", "smartlist_new", "tor_parse_long", "log_fn_"]}, {"name": "pipe_alert", "calls": ["write_ni"]}, {"name": "curve25519_handshake", "calls": ["curve25519_impl"]}, {"name": "routerstatus_has_changed", "calls": ["tor_assertion_failed_", "tor_memeq"]}, {"name": "config_maybe_load_geoip_files_", "calls": ["opt_streq", "config_load_geoip_file_", "geoip_is_loaded"]}, {"name": "channel_listener_state_is_valid", "calls": []}, {"name": "crypto_cipher_decrypt_with_iv", "calls": ["tor_assertion_failed_", "crypto_cipher_free", "crypto_cipher_encrypt", "crypto_cipher_new_with_iv"]}, {"name": "buf_pos_inc", "calls": []}, {"name": "sb_rename", "calls": ["log_fn_"]}, {"name": "or_options_free", "calls": ["config_free", "routerset_free", "smartlist_free"]}, {"name": "edmap_HT_GROW", "calls": ["tor_free_", "tor_reallocarray_"]}, {"name": "get_block_event_queue", "calls": ["tor_threadlocal_set", "tor_malloc_zero_", "tor_threadlocal_get"]}, {"name": "add_default_trusted_dir_authorities", "calls": ["parse_dir_authority_line", "log_fn_"]}, {"name": "control_event_server_error", "calls": ["queued_events_flush_all", "control_event_status"]}, {"name": "sum_up_cell_stats_by_command", "calls": ["smartlist_free", "tor_assertion_failed_"]}, {"name": "get_current_process_environment_variables", "calls": ["tor_strdup_", "smartlist_add", "get_environment", "smartlist_new"]}, {"name": "circuit_n_chan_done", "calls": ["tor_digest_is_zero", "smartlist_free", "extend_info_free", "circuit_send_next_onion_skin", "circuit_get_all_pending_on_channel", "smartlist_new", "TO_ORIGIN_CIRCUIT", "circuit_deliver_create_cell", "log_fn_", "tor_assertion_failed_", "circuit_mark_for_close_", "tor_memeq", "circuit_set_state"]}, {"name": "add_onion_helper_keyarg", "calls": ["crypto_pk_base64_encode", "smartlist_free", "crypto_pk_free", "crypto_pk_base64_decode", "tor_strdup_", "memwipe", "crypto_pk_generate_key_with_bits", "crypto_pk_new", "tor_assertion_failed_", "smartlist_split_string", "tor_asprintf", "crypto_pk_num_bits", "smartlist_new"]}, {"name": "channel_listener_close_from_lower_layer", "calls": ["channel_listener_change_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "crypto_pk_public_checksig", "calls": ["crypto_log_errors", "tor_assertion_failed_", "crypto_pk_keysize"]}, {"name": "crypto_pk_public_hybrid_encrypt", "calls": ["crypto_pk_keysize", "crypto_cipher_new", "crypto_get_rsa_padding_overhead", "crypto_cipher_free", "crypto_cipher_encrypt", "memwipe", "tor_malloc_", "crypto_get_rsa_padding", "crypto_pk_public_encrypt", "tor_assertion_failed_"]}, {"name": "tor_read_all_from_process_stderr", "calls": ["tor_read_all_handle"]}, {"name": "routerset_subtract_nodes", "calls": ["smartlist_del", "routerset_contains_node", "tor_assertion_failed_"]}, {"name": "fetch_from_buf_socks", "calls": ["parse_socks", "buf_pullup", "tor_assertion_failed_", "buf_clear", "buf_remove_from_front"]}, {"name": "channel_listener_dumpstats", "calls": ["channel_listener_dump_statistics", "tor_log"]}, {"name": "scheduler_set_watermarks", "calls": ["tor_assertion_failed_"]}, {"name": "measured_bw_line_apply", "calls": ["smartlist_bsearch", "log_fn_"]}, {"name": "dir_signing_key_is_trusted", "calls": ["log_fn_", "router_digest_is_trusted_dir_type", "crypto_pk_get_digest"]}, {"name": "control_event_conn_bandwidth_used", "calls": ["get_options", "get_connection_array", "control_event_conn_bandwidth"]}, {"name": "channel_tls_process_authenticate_cell", "calls": ["channel_tls_to_base", "crypto_digest256", "crypto_pk_keysize", "connection_or_init_conn_from_address", "get_uint16", "tor_assertion_failed_", "get_options", "safe_str", "connection_or_compute_authenticate_cell_body", "tor_x509_cert_get_id_digests", "tor_tls_cert_get_key", "tor_malloc_", "channel_set_circid_type", "crypto_pk_public_checksig", "crypto_pk_free", "log_fn_", "tor_memeq", "connection_or_close_for_error"]}, {"name": "policy_summarize", "calls": ["smartlist_free", "policy_summary_add_item", "tor_strdup_", "tor_snprintf", "smartlist_add", "smartlist_join_strings", "tor_assertion_failed_", "tor_addr_family", "policy_summary_create", "tor_asprintf", "smartlist_new", "log_fn_"]}, {"name": "or_state_save_broken", "calls": ["file_status", "tor_rename", "tor_asprintf", "log_fn_"]}, {"name": "control_event_hs_descriptor_requested", "calls": ["rend_auth_type_to_string", "send_control_event", "node_describe_longname_by_id", "rend_hsaddress_str_or_unknown", "log_fn_"]}, {"name": "get_user_homedir", "calls": ["tor_getpwnam", "tor_strdup_", "tor_assertion_failed_", "log_fn_"]}, {"name": "load_passphrase", "calls": ["tor_strndup_", "read_all", "memwipe", "log_fn_"]}, {"name": "circuit_get_all_pending_on_channel", "calls": ["tor_digest_is_zero", "smartlist_add", "tor_assertion_failed_", "tor_memeq"]}, {"name": "circuit_build_times_parse_state", "calls": ["smartlist_free", "smartlist_split_string", "circuit_build_times_reset", "circuit_build_times_disabled", "tor_parse_ulong", "tor_calloc_", "circuit_build_times_shuffle_and_store_array", "circuit_build_times_init", "circuit_build_times_set_timeout", "circuit_build_times_filter_timeouts", "smartlist_new", "log_fn_"]}, {"name": "dirvote_format_microdesc_vote_line", "calls": ["tor_snprintf", "tor_assertion_failed_", "digest256_to_base64", "make_consensus_method_list"]}, {"name": "signewnym_impl", "calls": ["get_options", "circuit_mark_all_dirty_circs_as_unusable", "proxy_mode", "rend_client_purge_state", "control_event_signal", "addressmap_clear_transient", "log_fn_"]}, {"name": "crypto_pk_eq_keys", "calls": ["crypto_pk_cmp_keys"]}, {"name": "router_reset_descriptor_download_failures", "calls": ["download_status_reset", "networkstatus_reset_download_failures"]}, {"name": "config_parse_msec_interval", "calls": ["config_parse_units", "log_fn_"]}, {"name": "log_entry_guards", "calls": ["smartlist_free", "hex_str", "smartlist_add_asprintf", "entry_is_live", "smartlist_join_strings", "smartlist_new", "log_fn_"]}, {"name": "connection_or_reached_eof", "calls": ["connection_or_close_normally", "tor_assertion_failed_", "log_fn_"]}, {"name": "signed_desc_append_to_journal", "calls": ["get_options", "signed_descriptor_get_body_impl", "options_get_datadir_fname2_suffix", "append_bytes_to_file", "log_fn_"]}, {"name": "connection_edge_is_rendezvous_stream", "calls": ["tor_assertion_failed_"]}, {"name": "launch_managed_proxy", "calls": ["tor_process_get_pid", "tor_spawn_background", "create_managed_proxy_environment", "process_environment_free", "log_fn_"]}, {"name": "connection_dir_count_by_purpose_and_resource", "calls": ["connection_dir_list_by_purpose_and_resource", "smartlist_free"]}, {"name": "cell_unpack", "calls": ["get_uint16", "get_uint32"]}, {"name": "already_have_cert", "calls": ["get_cert_list", "tor_memeq"]}, {"name": "init_cookie_authentication", "calls": ["crypto_rand", "escaped", "memwipe", "tor_malloc_", "write_bytes_to_file", "log_fn_"]}, {"name": "detached_get_digests", "calls": ["strmap_set", "tor_malloc_zero_", "strmap_get"]}, {"name": "microdesc_free_all", "calls": ["microdesc_cache_clear"]}, {"name": "get_microdesc_cache", "calls": ["get_microdesc_cache_noload", "microdesc_cache_reload"]}, {"name": "edge_reason_is_retriable", "calls": []}, {"name": "control_event_hs_descriptor_failed", "calls": ["control_event_hs_descriptor_receive_end", "log_fn_"]}, {"name": "hex_decode_digit", "calls": ["hex_decode_digit_"]}, {"name": "channel_notify_flushed", "calls": ["tor_assertion_failed_", "geoip_change_dirreq_state"]}, {"name": "connection_handle_read", "calls": ["tor_gettimeofday_cache_clear", "connection_handle_read_impl"]}, {"name": "circuit_build_times_free_timeouts", "calls": []}, {"name": "decide_next_handshake_type", "calls": ["num_ntors_per_tap"]}, {"name": "mark_my_descriptor_dirty", "calls": ["get_options", "server_mode", "log_fn_"]}, {"name": "geoip_entry_stats_write", "calls": ["check_or_create_data_subdir", "geoip_reset_entry_stats", "geoip_format_entry_stats", "write_to_data_subdir", "geoip_remove_old_clients"]}, {"name": "aes_cipher_free", "calls": []}, {"name": "dirvote_perform_vote", "calls": ["networkstatus_vote_free", "get_my_v3_authority_signing_key", "dirvote_add_vote", "format_networkstatus_vote", "get_my_v3_authority_cert", "dirserv_generate_networkstatus_vote_obj", "directory_post_to_dirservers", "log_fn_"]}, {"name": "get_circuit_build_close_time_ms", "calls": []}, {"name": "crypto_seed_weak_rng", "calls": ["crypto_rand", "tor_init_weak_random"]}, {"name": "fp_pair_map_impl_HT_FIND", "calls": ["fp_pair_map_impl_HT_FIND_P_", "fp_pair_map_entry_hash"]}, {"name": "directory_get_consensus_url", "calls": ["smartlist_free", "base16_encode", "smartlist_add", "smartlist_sort", "router_get_trusted_dir_servers", "tor_malloc_", "smartlist_join_strings", "tor_asprintf", "smartlist_new"]}, {"name": "keypin_journal_append_entry", "calls": ["write_all", "digest_to_base64", "digest256_to_base64", "keypin_close_journal", "log_fn_"]}, {"name": "get_interface_addresses_raw", "calls": ["get_interface_addresses_ioctl", "get_interface_addresses_ifaddrs"]}, {"name": "curve25519_keypair_write_to_file", "calls": ["memwipe", "crypto_write_tagged_contents_to_file"]}, {"name": "networkstatus_verify_bw_weights", "calls": ["networkstatus_get_bw_weight", "routerstatus_describe", "networkstatus_get_weight_scale_param", "log_fn_"]}, {"name": "eat_whitespace_no_nl", "calls": []}, {"name": "safe_timer_diff", "calls": ["tor_assertion_failed_"]}, {"name": "tor_cert_opt_eq", "calls": ["tor_cert_eq"]}, {"name": "digest256map_size", "calls": []}, {"name": "replyqueue_get_socket", "calls": []}, {"name": "channel_get_cell_handler", "calls": ["channel_is_in_state", "tor_assertion_failed_"]}, {"name": "write_to_buf", "calls": ["tor_assertion_failed_", "buf_add_chunk_with_capacity", "CHUNK_WRITE_PTR", "CHUNK_REMAINING_CAPACITY"]}, {"name": "smartlist_del_keeporder", "calls": ["tor_assertion_failed_"]}, {"name": "chanid_circid_muxinfo_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "directory_initiate_command", "calls": ["directory_initiate_command_rend"]}, {"name": "rep_hist_hs_stats_write", "calls": ["write_to_data_subdir", "rep_hist_format_hs_stats", "check_or_create_data_subdir", "rep_hist_reset_hs_stats"]}, {"name": "WRA_MORE_SEVERE", "calls": []}, {"name": "dns_reset", "calls": ["get_options", "configure_nameservers", "tor_libevent_get_base", "server_mode", "log_fn_"]}, {"name": "control_event_conn_bandwidth", "calls": ["get_options", "send_control_event"]}, {"name": "parse_short_policy", "calls": ["get_options", "TOR_ISDIGIT", "tor_assertion_failed_", "escaped", "tor_malloc_zero_", "tor_sscanf", "strcmpstart", "log_fn_"]}, {"name": "tor_malloc_zero_", "calls": ["tor_malloc_"]}, {"name": "decide_num_guards", "calls": ["networkstatus_get_param"]}, {"name": "router_have_consensus_path", "calls": []}, {"name": "channel_idmap_hash", "calls": []}, {"name": "connection_free", "calls": ["TO_OR_CONN", "tor_digest_is_zero", "connection_ap_warn_and_unmark_if_pending_circ", "connection_control_closed", "connection_or_remove_from_identity_map", "connection_in_array", "tor_assertion_failed_", "TO_ENTRY_CONN", "connection_is_on_closeable_list", "connection_unregister_events", "connection_start_reading", "connection_free_", "TO_CONTROL_CONN", "log_fn_"]}, {"name": "set_options", "calls": ["options_act", "control_event_conf_changed", "smartlist_free", "tor_strdup_", "config_free", "tor_assertion_failed_", "smartlist_add", "config_is_same", "smartlist_new", "config_get_assigned_option", "options_act_reversible", "log_fn_"]}, {"name": "rep_hist_format_desc_stats", "calls": ["tor_asprintf", "digestmap_iter_next", "digestmap_iter_get", "digestmap_iter_done", "format_iso_time", "digestmap_size", "tor_calloc_", "digestmap_iter_init", "find_nth_int"]}, {"name": "strmap_impl_HT_FIND_P_", "calls": ["strmap_entries_eq"]}, {"name": "router_choose_random_node", "calls": ["get_options", "routerlist_add_node_and_family", "smartlist_free", "smartlist_subtract", "router_choose_random_node", "smartlist_add", "tor_assertion_failed_", "routerlist_find_my_routerinfo", "node_allows_single_hop_exits", "nodelist_get_list", "node_sl_choose_by_bandwidth", "router_add_running_nodes_to_smartlist", "smartlist_new", "routerset_subtract_nodes", "log_fn_"]}, {"name": "find_next_with", "calls": ["strcmpstart"]}, {"name": "tor_x509_cert_free", "calls": ["memwipe"]}, {"name": "connection_process_inbuf", "calls": ["TO_OR_CONN", "connection_dir_process_inbuf", "connection_edge_process_inbuf", "TO_DIR_CONN", "tor_assertion_failed_", "connection_or_process_inbuf", "connection_control_process_inbuf", "TO_EDGE_CONN", "connection_ext_or_process_inbuf", "TO_CONTROL_CONN", "log_fn_"]}, {"name": "sb_poll", "calls": []}, {"name": "cache_map_HT_REMOVE", "calls": ["cached_resolve_hash", "cache_map_HT_FIND_P_"]}, {"name": "channel_write_packed_cell", "calls": ["packed_cell_free", "channel_is_in_state", "tor_assertion_failed_", "log_fn_"]}, {"name": "connection_or_close_for_error", "calls": ["channel_tls_to_base", "connection_mark_for_close_internal_", "tor_assertion_failed_", "channel_is_in_state", "channel_close_for_error"]}, {"name": "method_bits", "calls": []}, {"name": "init_curve25519_keypair_from_file", "calls": ["get_options", "curve25519_keypair_read_from_file", "tor_log", "tor_assertion_failed_", "escaped", "memwipe", "file_status", "curve25519_keypair_generate", "curve25519_keypair_write_to_file", "try_locking", "have_lockfile", "log_fn_"]}, {"name": "tor_cond_uninit", "calls": ["log_fn_"]}, {"name": "compare_tor_addr_to_node_policy", "calls": ["compare_tor_addr_to_short_policy", "compare_tor_addr_to_addr_policy", "tor_addr_family"]}, {"name": "tor_zlib_get_version_str", "calls": []}, {"name": "tor_cert_eq", "calls": ["tor_assertion_failed_", "tor_memeq"]}, {"name": "evdns_server_callback", "calls": ["socks_policy_permits_address", "entry_connection_new", "tor_dup_addr", "connection_ap_mark_as_non_pending_circuit", "tor_addr_copy", "tor_assertion_failed_", "tor_strdup_", "log_fn_", "connection_add_impl", "connection_free", "strlcpy", "tor_addr_from_sockaddr", "connection_ap_rewrite_and_attach_if_allowed", "control_event_stream_status", "escaped_safe_str_client", "get_signewnym_epoch"]}, {"name": "do_resolve", "calls": ["socks5_reason_to_string", "get_uint32", "write_all", "tor_addr_make_unspec", "tor_close_socket", "tor_addr_from_ipv4n", "tor_addr_from_ipv6_bytes", "strcasecmpend", "parse_socks4a_resolve_response", "tor_assertion_failed_", "tor_malloc_", "onion_warning", "read_all", "tor_open_socket", "build_socks_resolve_request", "log_fn_"]}, {"name": "config_assign_line", "calls": ["tor_asprintf", "bitarray_set", "config_find_option", "tor_strdup_", "config_reset", "tor_assertion_failed_", "config_line_append", "bitarray_is_set", "log_fn_", "config_assign_value"]}, {"name": "tor_tls_cert_get_key", "calls": ["crypto_new_pk_from_rsa_"]}, {"name": "circuit_close_all_marked", "calls": ["circuit_free", "circuit_about_to_free", "tor_assertion_failed_", "smartlist_clear", "circuit_get_global_list", "smartlist_del"]}, {"name": "circuit_try_clearing_isolation_state", "calls": ["circuit_clear_isolation"]}, {"name": "directory_dump_request_log", "calls": ["tor_strdup_"]}, {"name": "nodelist_map_HT_START", "calls": ["tor_assertion_failed_"]}, {"name": "router_get_router_hash", "calls": ["router_get_hash_impl"]}, {"name": "parse_log_severity_config", "calls": ["parse_log_level", "smartlist_split_string", "tor_strdup_", "parse_log_domain", "strcasecmpstart", "smartlist_free", "tor_strndup_", "eat_whitespace", "smartlist_new", "log_fn_"]}, {"name": "router_get_consensus_status_by_descriptor_digest", "calls": ["router_get_mutable_consensus_status_by_descriptor_digest"]}, {"name": "rep_hist_note_disconnect", "calls": ["mark_or_down", "get_or_history"]}, {"name": "entry_is_time_to_retry", "calls": []}, {"name": "addrs_in_same_network_family", "calls": ["tor_addr_compare_masked"]}, {"name": "get_token_arguments", "calls": ["find_whitespace", "memarea_strndup", "eat_whitespace", "memarea_memdup"]}, {"name": "tor_decode_libevent_version", "calls": ["TOR_ISALPHA", "tor_sscanf"]}, {"name": "optimistic_data_enabled", "calls": ["get_options", "networkstatus_get_param"]}, {"name": "tor_tls_classify_client_ciphers", "calls": ["smartlist_add", "smartlist_free", "prune_v2_cipher_list", "smartlist_join_strings", "tor_tls_get_by_ssl", "smartlist_new", "log_fn_"]}, {"name": "getaddrinfo_cache_HT_CLEAR", "calls": ["tor_free_", "getaddrinfo_cache_HT_INIT"]}, {"name": "circuit_expire_old_circuits_clientside", "calls": ["get_options", "tv_mdiff", "circuit_build_times_needs_circuits", "get_circuit_build_times", "circuit_build_times_disabled", "tor_gettimeofday", "circuit_get_global_list", "circuit_purpose_to_string", "TO_ORIGIN_CIRCUIT", "circuit_mark_for_close_", "log_fn_"]}, {"name": "crypto_pk_write_private_key_to_string", "calls": ["crypto_pk_write_key_to_string_impl"]}, {"name": "tv_to_msec", "calls": []}, {"name": "compare_strs_", "calls": []}, {"name": "double_digest_map_HT_INIT", "calls": []}, {"name": "routerset_contains_routerstatus", "calls": ["routerset_contains", "tor_addr_from_ipv4n"]}, {"name": "compare_known_tor_addr_to_addr_policy", "calls": ["tor_addr_compare_masked", "log_fn_"]}, {"name": "fascist_firewall_allows_address_or", "calls": ["addr_policy_permits_tor_addr"]}, {"name": "address_is_invalid_destination", "calls": ["TOR_ISALNUM", "get_options", "tor_addr_parse"]}, {"name": "client_identity_key_is_set", "calls": []}, {"name": "tor_event_free", "calls": []}, {"name": "get_detached_signatures_from_pending_consensuses", "calls": ["networkstatus_get_detached_signatures", "smartlist_add", "smartlist_free", "smartlist_new"]}, {"name": "keypin_close_journal", "calls": []}, {"name": "CHUNK_REMAINING_CAPACITY", "calls": []}, {"name": "router_get_fallback_dir_servers", "calls": ["smartlist_new"]}, {"name": "client_dns_set_addressmap", "calls": ["client_dns_set_addressmap_impl", "tor_addr_parse", "tor_assertion_failed_", "tor_addr_family", "tor_addr_to_str"]}, {"name": "handle_control_signal", "calls": ["activate_signal", "TOR_ISSPACE", "send_control_done", "connection_flush", "tor_strndup_", "connection_printf_to_buf"]}, {"name": "do_dump_config", "calls": ["get_options", "options_dump"]}, {"name": "ed25519_signature_to_base64", "calls": ["base64_encode_nopad", "tor_assertion_failed_"]}, {"name": "dirreq_map_ent_eq", "calls": []}, {"name": "config_free", "calls": ["config_clear", "config_free_lines", "tor_assertion_failed_"]}, {"name": "circuit_build_times_network_timeout", "calls": []}, {"name": "clientmap_HT_REP_IS_BAD_", "calls": ["clientmap_entry_hash"]}, {"name": "connection_ext_or_finished_flushing", "calls": ["connection_ext_or_transition", "connection_start_reading"]}, {"name": "digest256_to_base64", "calls": ["base64_encode"]}, {"name": "channel_when_last_drained", "calls": ["tor_assertion_failed_"]}, {"name": "channel_register", "calls": ["tor_digest_is_zero", "hex_str", "smartlist_add", "channel_is_in_state", "tor_assertion_failed_", "channel_state_to_string", "channel_add_to_digest_map", "smartlist_new", "log_fn_"]}, {"name": "download_status_schedule_get_delay", "calls": ["tor_assertion_failed_"]}, {"name": "geoip_ipv6_compare_key_to_entry_", "calls": []}, {"name": "compare_votes_by_authority_id_", "calls": ["get_voter"]}, {"name": "tor_accept_socket_with_extensions", "calls": ["set_socket_nonblocking", "socket_accounting_lock", "tor_close_socket_simple", "get_n_open_sockets", "socket_accounting_unlock", "log_fn_"]}, {"name": "rend_client_desc_trynow", "calls": ["safe_str_client", "rend_client_note_connection_attempt_ended", "connection_ap_mark_as_pending_circuit_", "get_connection_array", "TO_ENTRY_CONN", "assert_connection_ok", "rend_cmp_service_ids", "rend_client_any_intro_points_usable", "connection_mark_unattached_ap_", "rend_cache_lookup_entry", "log_fn_"]}, {"name": "channel_next_with_digest", "calls": ["tor_assertion_failed_"]}, {"name": "connection_mark_unattached_ap_", "calls": ["TO_OR_CONN", "connection_mark_for_close_internal_", "rend_client_note_connection_attempt_ended", "connection_edge_is_rendezvous_stream", "tor_assertion_failed_", "connection_ap_handshake_socks_resolved", "connection_mark_for_close_", "log_fn_", "connection_ap_handshake_socks_reply", "connection_or_close_for_error"]}, {"name": "curve25519_init", "calls": ["pick_curve25519_basepoint_impl"]}, {"name": "dirserv_read_guardfraction_file_from_str", "calls": ["parse_iso_time", "guardfraction_file_parse_inputs_line", "smartlist_sort", "guardfraction_file_parse_guard_line", "config_get_lines", "config_free_lines", "tor_parse_long", "log_fn_"]}, {"name": "tor_zlib_state_size", "calls": []}, {"name": "server_identity_key_is_set", "calls": ["get_options", "server_mode"]}, {"name": "microdesc_hash_", "calls": []}, {"name": "cell_ewma_to_circuit", "calls": ["tor_assertion_failed_"]}, {"name": "pathbias_count_circs_in_states", "calls": ["pathbias_should_count", "pathbias_state_to_string", "circuit_get_global_list", "TO_ORIGIN_CIRCUIT", "log_fn_"]}, {"name": "tor_tls_handshake", "calls": ["tor_tls_unblock_renegotiation", "tls_log_errors", "tor_assertion_failed_", "check_no_tls_errors_", "tor_tls_get_error", "tor_tls_finish_handshake", "log_fn_"]}, {"name": "tor_addr_to_PTR_name", "calls": ["tor_snprintf", "tor_addr_to_ipv4h", "tor_assertion_failed_", "tor_addr_to_in6"]}, {"name": "handle_fw_helper_line", "calls": ["smartlist_free", "smartlist_split_string", "log_portfw_spawn_error_message", "tor_assertion_failed_", "smartlist_add", "smartlist_join_strings", "strcmpstart", "tor_asprintf", "smartlist_new", "log_fn_"]}, {"name": "get_master_signing_keypair", "calls": []}, {"name": "rend_cache_failure_remove", "calls": ["strmap_remove_lc", "strmap_get_lc", "rend_cache_failure_entry_free", "rend_get_service_id"]}]